SEED: 0
DATA:
  BATCH_SIZE: 16
  NUM_WORKERS: 4
  SIZE: 224
  NORMALIZATION: imagenet
  ATTENTION_DIR: NONE
  SEPARATE_CLASSES: false
  REMOVE_BACKGROUND: false
  ROOT: /home/ryreu/guided_cnn/Food101/data
  USE_CLASS_WEIGHTS: false
  USE_GROUP_WEIGHTS: false
  DATASET: food_subset
  NUM_CLASSES: 5
  CLASSES:
  - prime_rib
  - pork_chop
  - steak
  - baby_back_ribs
  - filet_mignon
  SPLIT: split
  FOOD_SUBSET_DIR: food-101-redmeat
  SEGMENTATION_DIR: /home/ryreu/guided_cnn/Food101/LearningToLook/code/WeCLIPPlus/results_redmeat_openai_dinovit/val/prediction_cmap/
  SEG_TRAIN_ONLY: true
  SUBDIR: food-101-redmeat
EXP:
  NUM_TRIALS: 1
  LOSSES:
    CLASSIFICATION:
      WEIGHT: 1
    GRADIENT_OUTSIDE:
      COMPUTE: true
      LOG: false
      WEIGHT: 10
      CRITERION: L1
      GT: segmentation
      COMBINE_ATT_MODE: average_nonzero
    GRADIENT_INSIDE:
      COMPUTE: false
      LOG: false
      WEIGHT: 1
      CRITERION: L1
      GT: segmentation
      COMBINE_ATT_MODE: average_nonzero
    GRADCAM:
      COMPUTE: false
      LOG: false
      WEIGHT: 1
      CRITERION: L1
      GT: segmentation
      MODE: match
      COMBINE_ATT_MODE: average_nonzero
  APPROACH: generic
  MODEL: resnet50
  PRETRAINED: true
  NUM_EPOCHS: 1
  OPTIMIZER: SGD
  WEIGHT_DECAY: 1.0e-05
  MOMENTUM: 0.9
  SCHEDULER: NONE
  BASE:
    LR: 0.0001
  CLASSIFIER:
    LR: 0.001
  AUX_LOSSES_ON_VAL: false
LOGGING:
  SAVE_EVERY: 0
  SAVE_BEST: false
  SAVE_LAST: false
  LOG_ATTENTION: false
  LOG_ATTENTION_STEP: 10
  SAVE_STATS_PATH: null
yaml: RedMeat_Runs/configs/redmeat_gals_ourmasks.yaml
name: smoke_gals_ourmasks
test_checkpoint: null

NUM TRAIN: 2500

NUM VAL:   1250

Number classifier outputs: 5
Using pretrained model: True
USING SGD OPTIMIZER
class weights: None
group weights: None
WANDB DISABLED: skipping wandb.init()
EPOCH: 0

>>> TRAINING 

  0%|          | 0/157 [00:00<?, ?it/s]  0%|          | 0/157 [00:02<?, ?it/s]
Traceback (most recent call last):
  File "main.py", line 205, in <module>
    main(args)
  File "main.py", line 147, in main
    approach.train()
  File "/home/ryreu/guided_cnn/waterbirds/Waterbird_Runs/GALS/approaches/base.py", line 338, in train
    metrics = self.train_batch(data, metrics)
  File "/home/ryreu/guided_cnn/waterbirds/Waterbird_Runs/GALS/approaches/base.py", line 225, in train_batch
    loss, metrics = self.calc_loss(
  File "/home/ryreu/guided_cnn/waterbirds/Waterbird_Runs/GALS/approaches/base.py", line 180, in calc_loss
    loss, metrics = lu.calc_loss(
  File "/home/ryreu/guided_cnn/waterbirds/Waterbird_Runs/GALS/utils/loss_utils.py", line 58, in calc_loss
    grad_loss = input_gradient_loss(
  File "/home/ryreu/guided_cnn/waterbirds/Waterbird_Runs/GALS/utils/loss_utils.py", line 252, in input_gradient_loss
    loss   = criterion(dy_dx, dy_dx*gt_attentions)
RuntimeError: The size of tensor a (224) must match the size of tensor b (16) at non-singleton dimension 2
