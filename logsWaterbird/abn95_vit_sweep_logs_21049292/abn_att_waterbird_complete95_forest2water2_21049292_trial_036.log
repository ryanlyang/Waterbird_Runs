[CMD] /home/ryreu/miniconda3/envs/gals_a100/bin/python -u main.py --config configs/waterbirds_95_abn_vit.yaml --name abn_att_waterbird_complete95_forest2water2_21049292_trial_036 DATA.ROOT=/home/ryreu/guided_cnn/waterbirds DATA.WATERBIRDS_DIR=waterbird_complete95_forest2water2 SEED=0 EXP.BASE.LR=4.177213926541687e-05 EXP.CLASSIFIER.LR=2.7613588739646235e-05 EXP.WEIGHT_DECAY=7.509515922144549e-05 EXP.AUX_LOSSES_ON_VAL=False EXP.LOSSES.ABN_SUPERVISION.WEIGHT=0.337056301326932
SEED: 0
DATA:
  BATCH_SIZE: 96
  NUM_WORKERS: 4
  SIZE: 224
  NORMALIZATION: imagenet
  ATTENTION_DIR: clip_vit_attention
  SEPARATE_CLASSES: false
  REMOVE_BACKGROUND: false
  ROOT: /home/ryreu/guided_cnn/waterbirds
  USE_CLASS_WEIGHTS: false
  USE_GROUP_WEIGHTS: false
  DATASET: waterbirds
  NUM_CLASSES: 2
  CONFOUNDING_FACTOR: 0.95
  WATERBIRDS_DIR: waterbird_complete95_forest2water2
EXP:
  NUM_TRIALS: 1
  LOSSES:
    CLASSIFICATION:
      WEIGHT: 1
    GRADIENT_OUTSIDE:
      COMPUTE: false
      LOG: false
      WEIGHT: 0.01
      CRITERION: L1
      GT: segmentation
      COMBINE_ATT_MODE: average_nonzero
    GRADIENT_INSIDE:
      COMPUTE: false
      LOG: false
      WEIGHT: 1
      CRITERION: L1
      GT: segmentation
      COMBINE_ATT_MODE: average_nonzero
    GRADCAM:
      COMPUTE: false
      LOG: false
      WEIGHT: 1
      CRITERION: L1
      GT: segmentation
      MODE: match
      COMBINE_ATT_MODE: average_nonzero
    ABN_CLASSIFICATION:
      COMPUTE: true
      LOG: false
      WEIGHT: 1
    ABN_SUPERVISION:
      COMPUTE: true
      LOG: false
      WEIGHT: 0.337056301326932
      CRITERION: L1
      GT: clip_vit
      MODE: suppress_outside
      COMBINE_ATT_MODE: average_nonzero
  APPROACH: abn
  MODEL: resnet50_abn
  PRETRAINED: true
  PROVIDED_ATT: NONE
  PROVIDED_ATT_SHAPE:
  - 14
  - 14
  ABN_ADD_AFTER_ATTENTION: true
  NUM_EPOCHS: 200
  OPTIMIZER: SGD
  WEIGHT_DECAY: 7.509515922144549e-05
  MOMENTUM: 0.9
  SCHEDULER: NONE
  BASE:
    LR: 4.177213926541687e-05
  CLASSIFIER:
    LR: 2.7613588739646235e-05
  AUX_LOSSES_ON_VAL: false
LOGGING:
  SAVE_EVERY: 0
  SAVE_BEST: true
  SAVE_LAST: false
  LOG_ATTENTION: false
  LOG_ATTENTION_STEP: 10
  SAVE_STATS_PATH: null
yaml: configs/waterbirds_95_abn_vit.yaml
name: abn_att_waterbird_complete95_forest2water2_21049292_trial_036
test_checkpoint: null

WATERBIRDS DIR: /home/ryreu/guided_cnn/waterbirds/waterbird_complete95_forest2water2
NUMBER OF SAMPLES WITH LABEL Landbird: 3682
NUMBER OF SAMPLES WITH LABEL Waterbird: 1113
NUMBER OF SAMPLES WITH GROUP Land_on_Land: 3498
NUMBER OF SAMPLES WITH GROUP Land_on_Water: 184
NUMBER OF SAMPLES WITH GROUP Water_on_Land: 56
NUMBER OF SAMPLES WITH GROUP Water_on_Water: 1057
WATERBIRDS DIR: /home/ryreu/guided_cnn/waterbirds/waterbird_complete95_forest2water2
NUMBER OF SAMPLES WITH LABEL Landbird: 933
NUMBER OF SAMPLES WITH LABEL Waterbird: 266
NUMBER OF SAMPLES WITH GROUP Land_on_Land: 467
NUMBER OF SAMPLES WITH GROUP Land_on_Water: 466
NUMBER OF SAMPLES WITH GROUP Water_on_Land: 133
NUMBER OF SAMPLES WITH GROUP Water_on_Water: 133
NUM TRAIN: 4795

NUM VAL:   1199

Number classifier outputs: 1
Using pretrained model: True
Removing att_conv.weight from pretained weights, with weight shape torch.Size([1000, 2048, 1, 1])
Removing bn_att2.weight from pretained weights, with weight shape torch.Size([1000])
Removing bn_att2.bias from pretained weights, with weight shape torch.Size([1000])
Removing bn_att2.running_mean from pretained weights, with weight shape torch.Size([1000])
Removing bn_att2.running_var from pretained weights, with weight shape torch.Size([1000])
Removing att_conv2.weight from pretained weights, with weight shape torch.Size([1000, 1000, 1, 1])
Removing att_conv3.weight from pretained weights, with weight shape torch.Size([1, 1000, 3, 3])
Removing fc.weight from pretained weights, with weight shape torch.Size([1000, 2048])
Removing fc.bias from pretained weights, with weight shape torch.Size([1000])
Keys missing in state dict:    ['att_conv.weight', 'bn_att2.weight', 'bn_att2.bias', 'bn_att2.running_mean', 'bn_att2.running_var', 'att_conv2.weight', 'att_conv3.weight', 'fc.weight', 'fc.bias']
Unexpected keys in state dict: []
USING SGD OPTIMIZER
class weights: None
group weights: None
WANDB DISABLED: skipping wandb.init()
EPOCH: 0

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:03<03:12,  3.94s/it]
  4%|▍         | 2/50 [00:04<01:24,  1.77s/it]
  6%|▌         | 3/50 [00:04<00:50,  1.07s/it]
  8%|▊         | 4/50 [00:04<00:34,  1.34it/s]
 10%|█         | 5/50 [00:04<00:25,  1.76it/s]
 12%|█▏        | 6/50 [00:05<00:20,  2.18it/s]
 14%|█▍        | 7/50 [00:05<00:16,  2.58it/s]
 16%|█▌        | 8/50 [00:05<00:14,  2.91it/s]
 18%|█▊        | 9/50 [00:05<00:12,  3.19it/s]
 20%|██        | 10/50 [00:06<00:11,  3.40it/s]
 22%|██▏       | 11/50 [00:06<00:10,  3.60it/s]
 24%|██▍       | 12/50 [00:06<00:10,  3.74it/s]
 26%|██▌       | 13/50 [00:06<00:09,  3.85it/s]
 28%|██▊       | 14/50 [00:07<00:09,  3.90it/s]
 30%|███       | 15/50 [00:07<00:08,  3.98it/s]
 32%|███▏      | 16/50 [00:07<00:08,  4.02it/s]
 34%|███▍      | 17/50 [00:07<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:08<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:08<00:07,  4.06it/s]
 40%|████      | 20/50 [00:08<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:08<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:09<00:06,  4.04it/s]
 46%|████▌     | 23/50 [00:09<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:09<00:06,  4.06it/s]
 50%|█████     | 25/50 [00:09<00:06,  4.06it/s]
 52%|█████▏    | 26/50 [00:10<00:05,  4.03it/s]
 54%|█████▍    | 27/50 [00:10<00:05,  4.02it/s]
 56%|█████▌    | 28/50 [00:10<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:10<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:11<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:11<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:11<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:11<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:12<00:03,  4.06it/s]
 70%|███████   | 35/50 [00:12<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:12<00:03,  4.07it/s]
 74%|███████▍  | 37/50 [00:12<00:03,  4.04it/s]
 76%|███████▌  | 38/50 [00:13<00:02,  4.04it/s]
 78%|███████▊  | 39/50 [00:13<00:02,  4.02it/s]
 80%|████████  | 40/50 [00:13<00:02,  4.02it/s]
 82%|████████▏ | 41/50 [00:13<00:02,  4.05it/s]
 84%|████████▍ | 42/50 [00:14<00:01,  4.04it/s]
 86%|████████▌ | 43/50 [00:14<00:01,  4.05it/s]
 88%|████████▊ | 44/50 [00:14<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:14<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:15<00:00,  4.05it/s]
 94%|█████████▍| 47/50 [00:15<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:15<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:15<00:00,  4.07it/s]
100%|██████████| 50/50 [00:15<00:00,  4.11it/s]
100%|██████████| 50/50 [00:16<00:00,  3.12it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.11it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.44it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.99it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.34it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.6779979144942648
val_acc: 0.7781484570475397
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.6242643453654706
val_cls_loss: 0.5665960575114497
train_total_loss: 1.61823367160105
val_total_loss: 0.5665960575114497
test_abn_acc: 0
balanced_train_acc: 0.5135633491505506
balanced_val_acc: 0.5
Land_on_Land_train_acc: 0.8207547169811321
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 0.8152173913043478
Land_on_Water_val_acc: 1.0
Water_on_Land_train_acc: 0.16071428571428573
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.20908230842005676
Water_on_Water_val_acc: 0.0
train_abn_cls_loss: 0.9266779350165406
train_abn_att_clip_vit_loss: 0.06729139485498414
train_acc_Landbird: 0.8204780010863661
train_acc_Waterbird: 0.20664869721473494
val_acc_Landbird: 1.0
val_acc_Waterbird: 0.0
TRAIN ACC:        0.6779979144942648
VAL ACC:          0.7781484570475397
BALANCED VAL ACC: 0.5
prev best list: []
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.5_epoch_0.ckpt
EPOCH: 1

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.93it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.93it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.93it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.95it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.79it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.25it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.76it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.92it/s]
100%|██████████| 13/13 [00:03<00:00,  5.99it/s]
100%|██████████| 13/13 [00:03<00:00,  3.96it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.7678832116788321
val_acc: 0.7781484570475397
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.5195706780560944
val_cls_loss: 0.5391447807571309
train_total_loss: 1.487517273214736
val_total_loss: 0.5391447807571309
test_abn_acc: 0
balanced_train_acc: 0.5
balanced_val_acc: 0.5
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 1.0
Water_on_Land_train_acc: 0.0
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.0
Water_on_Water_val_acc: 0.0
train_abn_cls_loss: 0.900690581042774
train_abn_att_clip_vit_loss: 0.06725600521246261
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.0
val_acc_Landbird: 1.0
val_acc_Waterbird: 0.0
TRAIN ACC:        0.7678832116788321
VAL ACC:          0.7781484570475397
BALANCED VAL ACC: 0.5
prev best list: ['best_balanced_valacc_0.5_epoch_0.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.5_epoch_1.ckpt
EPOCH: 2

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.82it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.90it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  4.01it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.02it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.06it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.07it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.05it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.12it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.13it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.06it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.05it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.05it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.02it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.02it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.06it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.78it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.43it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.01it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.49it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.93it/s]
100%|██████████| 13/13 [00:03<00:00,  4.22it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.7678832116788321
val_acc: 0.7773144286905754
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.47806019575429287
val_cls_loss: 0.5363232687028673
train_total_loss: 1.417354526982193
val_total_loss: 0.5363232687028673
test_abn_acc: 0
balanced_train_acc: 0.5
balanced_val_acc: 0.4994640943193998
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.9978540772532188
Water_on_Land_train_acc: 0.0
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.0
Water_on_Water_val_acc: 0.0
train_abn_cls_loss: 0.87204223528147
train_abn_att_clip_vit_loss: 0.06725208608587044
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.0
val_acc_Landbird: 0.9989281886387996
val_acc_Waterbird: 0.0
TRAIN ACC:        0.7678832116788321
VAL ACC:          0.7773144286905754
BALANCED VAL ACC: 0.4994640943193998
EPOCH: 3

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.22it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.62it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.73it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.92it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.99it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.00it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.03it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.02it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.01it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.77it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.39it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.36it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.7710114702815433
val_acc: 0.76814011676397
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.4456931821621247
val_cls_loss: 0.5369505768174226
train_total_loss: 1.3563652471904337
val_total_loss: 0.5369505768174226
test_abn_acc: 0
balanced_train_acc: 0.5073654255446349
balanced_val_acc: 0.49625671896783763
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.9699570815450643
Water_on_Land_train_acc: 0.0
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.01608325449385052
Water_on_Water_val_acc: 0.015037593984962405
train_abn_cls_loss: 0.8435431981608815
train_abn_att_clip_vit_loss: 0.06712885111166364
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.015274034141958671
val_acc_Landbird: 0.984994640943194
val_acc_Waterbird: 0.007518796992481203
TRAIN ACC:        0.7710114702815433
VAL ACC:          0.76814011676397
BALANCED VAL ACC: 0.49625671896783763
EPOCH: 4

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.44s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.34it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.92it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.43it/s]
 10%|█         | 5/50 [00:02<00:15,  2.83it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.13it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.35it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.54it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.02it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.02it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.01it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.64it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.25it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.54it/s]
100%|██████████| 13/13 [00:03<00:00,  3.98it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.7787278415015642
val_acc: 0.762301918265221
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.41779661453926276
val_cls_loss: 0.5388447624678607
train_total_loss: 1.2998248483639936
val_total_loss: 0.5388447624678607
test_abn_acc: 0
balanced_train_acc: 0.5258678117921967
balanced_val_acc: 0.5005681406087565
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 0.9565217391304348
Land_on_Water_val_acc: 0.9420600858369099
Water_on_Land_train_acc: 0.0
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.05676442762535478
Water_on_Water_val_acc: 0.06015037593984962
train_abn_cls_loss: 0.8152256988758091
train_abn_att_clip_vit_loss: 0.06680252118671276
train_acc_Landbird: 0.997827267789245
train_acc_Waterbird: 0.05390835579514825
val_acc_Landbird: 0.9710610932475884
val_acc_Waterbird: 0.03007518796992481
TRAIN ACC:        0.7787278415015642
VAL ACC:          0.762301918265221
BALANCED VAL ACC: 0.5005681406087565
prev best list: ['best_balanced_valacc_0.5_epoch_1.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.5_epoch_4.ckpt
EPOCH: 5

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.99it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  4.01it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.02it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.01it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.97it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.01it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.02it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.02it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.03it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.06it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.06it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.04it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.06it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.87it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.21it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.03it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.7947862356621481
val_acc: 0.7481234361968306
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.39509063857812454
val_cls_loss: 0.5448845080577701
train_total_loss: 1.248362584929521
val_total_loss: 0.5448845080577701
test_abn_acc: 0
balanced_train_acc: 0.5635934121119572
balanced_val_acc: 0.5048956797137538
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 0.9021739130434783
Land_on_Water_val_acc: 0.8841201716738197
Water_on_Land_train_acc: 0.0
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.1390728476821192
Water_on_Water_val_acc: 0.13533834586466165
train_abn_cls_loss: 0.7872709897934334
train_abn_att_clip_vit_loss: 0.06600093635671206
train_acc_Landbird: 0.9951113525258012
train_acc_Waterbird: 0.1320754716981132
val_acc_Landbird: 0.9421221864951769
val_acc_Waterbird: 0.06766917293233082
TRAIN ACC:        0.7947862356621481
VAL ACC:          0.7481234361968306
BALANCED VAL ACC: 0.5048956797137538
prev best list: ['best_balanced_valacc_0.5_epoch_4.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.5_epoch_5.ckpt
EPOCH: 6

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.87it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.92it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.99it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.99it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.01it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.01it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.01it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.11it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.64it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.81it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.65it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.84it/s]
100%|██████████| 13/13 [00:03<00:00,  5.95it/s]
100%|██████████| 13/13 [00:03<00:00,  3.86it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8152241918665276
val_acc: 0.7206005004170142
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.3727306044760536
val_cls_loss: 0.5530944494429582
train_total_loss: 1.1957485809067616
val_total_loss: 0.5530944494429582
test_abn_acc: 0
balanced_train_acc: 0.6123201773714723
balanced_val_acc: 0.5087114893342681
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 0.8260869565217391
Land_on_Water_val_acc: 0.778969957081545
Water_on_Land_train_acc: 0.0
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.24597918637653737
Water_on_Water_val_acc: 0.2556390977443609
train_abn_cls_loss: 0.7584318188606636
train_abn_att_clip_vit_loss: 0.06458615742087737
train_acc_Landbird: 0.9910374796306355
train_acc_Waterbird: 0.23360287511230907
val_acc_Landbird: 0.8896034297963559
val_acc_Waterbird: 0.12781954887218044
TRAIN ACC:        0.8152241918665276
VAL ACC:          0.7206005004170142
BALANCED VAL ACC: 0.5087114893342681
prev best list: ['best_balanced_valacc_0.5_epoch_5.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.51_epoch_6.ckpt
EPOCH: 7

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.24it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.91it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.99it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.09it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.13it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.79it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.99it/s]
100%|██████████| 13/13 [00:03<00:00,  6.08it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8325338894681961
val_acc: 0.7089241034195163
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.35433475376418533
val_cls_loss: 0.5587679280451281
train_total_loss: 1.1500810470272775
val_total_loss: 0.5587679280451281
test_abn_acc: 0
balanced_train_acc: 0.6539949576214732
balanced_val_acc: 0.5133029519135459
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 0.7554347826086957
Land_on_Water_val_acc: 0.7296137339055794
Water_on_Land_train_acc: 0.0
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.33774834437086093
Water_on_Water_val_acc: 0.3233082706766917
train_abn_cls_loss: 0.7325217411341582
train_abn_att_clip_vit_loss: 0.06322455026434659
train_acc_Landbird: 0.9872351982618143
train_acc_Waterbird: 0.32075471698113206
val_acc_Landbird: 0.864951768488746
val_acc_Waterbird: 0.16165413533834586
TRAIN ACC:        0.8325338894681961
VAL ACC:          0.7089241034195163
BALANCED VAL ACC: 0.5133029519135459
prev best list: ['best_balanced_valacc_0.51_epoch_6.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.51_epoch_7.ckpt
EPOCH: 8

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.97it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.92it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  4.00it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.99it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.03it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.02it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.03it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.02it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.02it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.04it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.02it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.03it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.05it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.04it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.01it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.12it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.46it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.01it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.15it/s]
100%|██████████| 13/13 [00:02<00:00,  6.44it/s]
100%|██████████| 13/13 [00:03<00:00,  4.23it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8592283628779979
val_acc: 0.6855713094245204
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.33646209633387664
val_cls_loss: 0.5715027491036209
train_total_loss: 1.113649545944023
val_total_loss: 0.5715027491036209
test_abn_acc: 0
balanced_train_acc: 0.7149450496892924
balanced_val_acc: 0.5103917349644207
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 1.0
Land_on_Water_train_acc: 0.7010869565217391
Land_on_Water_val_acc: 0.6502145922746781
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.46830652790917693
Water_on_Water_val_acc: 0.39097744360902253
train_abn_cls_loss: 0.7148081627329647
train_abn_att_clip_vit_loss: 0.06237928021516616
train_acc_Landbird: 0.9842476914720261
train_acc_Waterbird: 0.44564240790655885
val_acc_Landbird: 0.8252947481243301
val_acc_Waterbird: 0.19548872180451127
TRAIN ACC:        0.8592283628779979
VAL ACC:          0.6855713094245204
BALANCED VAL ACC: 0.5103917349644207
EPOCH: 9

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.92it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.97it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.92it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.94it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.68it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.01it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.43it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.03it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8732012513034411
val_acc: 0.6738949124270225
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.322782550321754
val_cls_loss: 0.5795581934102084
train_total_loss: 1.0914960859465772
val_total_loss: 0.5795581934102084
test_abn_acc: 0
balanced_train_acc: 0.7494320491666069
balanced_val_acc: 0.5122956104086583
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9978586723768736
Land_on_Water_train_acc: 0.6358695652173914
Land_on_Water_val_acc: 0.6072961373390557
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.5449385052034059
Water_on_Water_val_acc: 0.44360902255639095
train_abn_cls_loss: 0.7067744131008701
train_abn_att_clip_vit_loss: 0.061939121604866976
train_acc_Landbird: 0.9804454101032047
train_acc_Waterbird: 0.518418688230009
val_acc_Landbird: 0.8027867095391211
val_acc_Waterbird: 0.22180451127819548
TRAIN ACC:        0.8732012513034411
VAL ACC:          0.6738949124270225
BALANCED VAL ACC: 0.5122956104086583
EPOCH: 10

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  3.98it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.12it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.13it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.02it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.01it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.02it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.03it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.06it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.01it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.39it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.03it/s]
100%|██████████| 13/13 [00:03<00:00,  6.29it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8815432742440041
val_acc: 0.6580483736447039
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.30927716742839756
val_cls_loss: 0.5992276675259699
train_total_loss: 1.0701074854549453
val_total_loss: 0.5992276675259699
test_abn_acc: 0
balanced_train_acc: 0.7711627875197715
balanced_val_acc: 0.5236140995575757
Land_on_Land_train_acc: 0.9982847341337907
Land_on_Land_val_acc: 0.9957173447537473
Land_on_Water_train_acc: 0.5760869565217391
Land_on_Water_val_acc: 0.5343347639484979
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.5941343424787133
Water_on_Water_val_acc: 0.5639097744360902
train_abn_cls_loss: 0.6991436611126809
train_abn_att_clip_vit_loss: 0.061686666739465545
train_acc_Landbird: 0.9771863117870723
train_acc_Waterbird: 0.5651392632524708
val_acc_Landbird: 0.7652733118971061
val_acc_Waterbird: 0.2819548872180451
TRAIN ACC:        0.8815432742440041
VAL ACC:          0.6580483736447039
BALANCED VAL ACC: 0.5236140995575757
prev best list: ['best_balanced_valacc_0.51_epoch_7.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.52_epoch_10.ckpt
EPOCH: 11

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.92it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.04it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.03it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.03it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.02it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.87it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.19it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.98it/s]
100%|██████████| 13/13 [00:03<00:00,  5.91it/s]
100%|██████████| 13/13 [00:03<00:00,  3.96it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8861313868613139
val_acc: 0.6613844870725605
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.29764902127423054
val_cls_loss: 0.5981678913989795
train_total_loss: 1.0539528890372067
val_total_loss: 0.5981678913989795
test_abn_acc: 0
balanced_train_acc: 0.7848072725036639
balanced_val_acc: 0.5217263415774163
Land_on_Land_train_acc: 0.9971412235563178
Land_on_Land_val_acc: 0.9957173447537473
Land_on_Water_train_acc: 0.532608695652174
Land_on_Water_val_acc: 0.5493562231759657
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.6263008514664143
Water_on_Water_val_acc: 0.5413533834586466
train_abn_cls_loss: 0.6947900657484752
train_abn_att_clip_vit_loss: 0.06151380727419142
train_acc_Landbird: 0.9739272134709397
train_acc_Waterbird: 0.5956873315363881
val_acc_Landbird: 0.7727759914255091
val_acc_Waterbird: 0.2706766917293233
TRAIN ACC:        0.8861313868613139
VAL ACC:          0.6613844870725605
BALANCED VAL ACC: 0.5217263415774163
EPOCH: 12

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.92it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.92it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.91it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.90it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.90it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.89it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.88it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.88it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.88it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.87it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.89it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.90it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.90it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.88it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.88it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.90it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.90it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.90it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.90it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.91it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.90it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.89it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.89it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.91it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.91it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.91it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.91it/s]
 94%|█████████▍| 47/50 [00:13<00:00,  3.92it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.92it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.92it/s]
100%|██████████| 50/50 [00:13<00:00,  3.96it/s]
100%|██████████| 50/50 [00:13<00:00,  3.60it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.91it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.23it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.80it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.96it/s]
100%|██████████| 13/13 [00:03<00:00,  6.11it/s]
100%|██████████| 13/13 [00:03<00:00,  3.98it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8900938477580813
val_acc: 0.6522101751459549
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.2882006126225803
val_cls_loss: 0.6153995767297896
train_total_loss: 1.0419645784047895
val_total_loss: 0.6153995767297896
test_abn_acc: 0
balanced_train_acc: 0.7945965243117119
balanced_val_acc: 0.5292693147660147
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.5
Land_on_Water_val_acc: 0.5064377682403434
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.6480605487228004
Water_on_Water_val_acc: 0.6165413533834586
train_abn_cls_loss: 0.6923739586184743
train_abn_att_clip_vit_loss: 0.06139000366996426
train_acc_Landbird: 0.9728408473655622
train_acc_Waterbird: 0.6163522012578616
val_acc_Landbird: 0.7502679528403001
val_acc_Waterbird: 0.3082706766917293
TRAIN ACC:        0.8900938477580813
VAL ACC:          0.6522101751459549
BALANCED VAL ACC: 0.5292693147660147
prev best list: ['best_balanced_valacc_0.52_epoch_10.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.53_epoch_12.ckpt
EPOCH: 13

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.07it/s]
  8%|▊         | 4/50 [00:02<00:17,  2.57it/s]
 10%|█         | 5/50 [00:02<00:15,  2.96it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.28it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.52it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.70it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.80it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.97it/s]
 24%|██▍       | 12/50 [00:03<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.06it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.11it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:05<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.09it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.03it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.93it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  3.92it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.92it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.94it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.95it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  3.94it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.93it/s]
100%|██████████| 50/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.26it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.8932221063607925
val_acc: 0.6430358632193495
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.27935798437304493
val_cls_loss: 0.6251971973937387
train_total_loss: 1.0302378666910563
val_total_loss: 0.6251971973937387
test_abn_acc: 0
balanced_train_acc: 0.8076038794885196
balanced_val_acc: 0.5274057329819726
Land_on_Land_train_acc: 0.9951400800457404
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.44021739130434784
Land_on_Water_val_acc: 0.47854077253218885
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.6811731315042573
Water_on_Water_val_acc: 0.6390977443609023
train_abn_cls_loss: 0.689557242144882
train_abn_att_clip_vit_loss: 0.06132263128526268
train_acc_Landbird: 0.9674090168386746
train_acc_Waterbird: 0.6477987421383647
val_acc_Landbird: 0.7352625937834941
val_acc_Waterbird: 0.31954887218045114
TRAIN ACC:        0.8932221063607925
VAL ACC:          0.6430358632193495
BALANCED VAL ACC: 0.5274057329819726
EPOCH: 14

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.92it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.07it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:05<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.11it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.13it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.13it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.74it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.38it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  6.15it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9007299270072993
val_acc: 0.6338615512927439
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.27217498717827643
val_cls_loss: 0.6359706731067288
train_total_loss: 1.021901214184925
val_total_loss: 0.6359706731067288
test_abn_acc: 0
balanced_train_acc: 0.8237763862270642
balanced_val_acc: 0.5268859447654506
Land_on_Land_train_acc: 0.994568324757004
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.45108695652173914
Land_on_Water_val_acc: 0.44635193133047213
Water_on_Land_train_acc: 0.03571428571428571
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.7142857142857143
Water_on_Water_val_acc: 0.6691729323308271
train_abn_cls_loss: 0.6885159265758845
train_abn_att_clip_vit_loss: 0.06121029801690044
train_acc_Landbird: 0.9674090168386746
train_acc_Waterbird: 0.6801437556154537
val_acc_Landbird: 0.7191854233654876
val_acc_Waterbird: 0.33458646616541354
TRAIN ACC:        0.9007299270072993
VAL ACC:          0.6338615512927439
BALANCED VAL ACC: 0.5268859447654506
EPOCH: 15

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:17,  2.57it/s]
 10%|█         | 5/50 [00:02<00:15,  2.98it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.30it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.52it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.70it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.83it/s]
 20%|██        | 10/50 [00:03<00:10,  3.90it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.97it/s]
 24%|██▍       | 12/50 [00:03<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.05it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.11it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.12it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.11it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.12it/s]
 40%|████      | 20/50 [00:05<00:07,  4.13it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.11it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.11it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.13it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.13it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.13it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.12it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.13it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.14it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.14it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.15it/s]
 98%|█████████▊| 49/50 [00:12<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.76it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.95it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.25it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9059436913451512
val_acc: 0.6363636363636364
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.26210743038758744
val_cls_loss: 0.6411601359691095
train_total_loss: 1.0081814603835375
val_total_loss: 0.6411601359691095
test_abn_acc: 0
balanced_train_acc: 0.8350072936843868
balanced_val_acc: 0.5311812489422915
Land_on_Land_train_acc: 0.9962835906232133
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.41847826086956524
Land_on_Water_val_acc: 0.44849785407725323
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.0
Water_on_Water_train_acc: 0.738883632923368
Water_on_Water_val_acc: 0.6842105263157895
train_abn_cls_loss: 0.6849420850915879
train_abn_att_clip_vit_loss: 0.06113193837986002
train_acc_Landbird: 0.9674090168386746
train_acc_Waterbird: 0.7026055705300989
val_acc_Landbird: 0.7202572347266881
val_acc_Waterbird: 0.34210526315789475
TRAIN ACC:        0.9059436913451512
VAL ACC:          0.6363636363636364
BALANCED VAL ACC: 0.5311812489422915
prev best list: ['best_balanced_valacc_0.53_epoch_12.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.53_epoch_15.ckpt
EPOCH: 16

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:11,  1.45s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.33it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.92it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.40it/s]
 10%|█         | 5/50 [00:02<00:16,  2.81it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.10it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.32it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.50it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.62it/s]
 20%|██        | 10/50 [00:03<00:10,  3.68it/s]
 22%|██▏       | 11/50 [00:04<00:10,  3.75it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.81it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.83it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.85it/s]
 30%|███       | 15/50 [00:05<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.04it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.06it/s]
 40%|████      | 20/50 [00:06<00:07,  4.08it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.13it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.12it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.12it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.13it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.14it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.13it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.14it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.13it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.13it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.14it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.16it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.908029197080292
val_acc: 0.6346955796497081
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.2574621977286493
val_cls_loss: 0.6500210817701325
train_total_loss: 1.0016389119364049
val_total_loss: 0.6500210817701325
test_abn_acc: 0
balanced_train_acc: 0.8404399782726779
balanced_val_acc: 0.5381721989862115
Land_on_Land_train_acc: 0.9957118353344768
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.41304347826086957
Land_on_Water_val_acc: 0.4313304721030043
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.007518796992481203
Water_on_Water_train_acc: 0.7511825922421949
Water_on_Water_val_acc: 0.7218045112781954
train_abn_cls_loss: 0.6830881557449683
train_abn_att_clip_vit_loss: 0.061088550533629306
train_acc_Landbird: 0.9665942422596415
train_acc_Waterbird: 0.7142857142857143
val_acc_Landbird: 0.7116827438370846
val_acc_Waterbird: 0.36466165413533835
TRAIN ACC:        0.908029197080292
VAL ACC:          0.6346955796497081
BALANCED VAL ACC: 0.5381721989862115
prev best list: ['best_balanced_valacc_0.53_epoch_15.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.54_epoch_16.ckpt
EPOCH: 17

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.95it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.42it/s]
 10%|█         | 5/50 [00:02<00:16,  2.79it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.10it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.32it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.49it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.60it/s]
 20%|██        | 10/50 [00:03<00:10,  3.69it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.72it/s]
 24%|██▍       | 12/50 [00:04<00:10,  3.80it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.82it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.85it/s]
 30%|███       | 15/50 [00:05<00:09,  3.87it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.89it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.92it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:06<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.12it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.11it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.60it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.25it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.30it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.70it/s]
100%|██████████| 13/13 [00:03<00:00,  4.00it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9090719499478623
val_acc: 0.6363636363636364
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.2515207136727722
val_cls_loss: 0.6575187377078618
train_total_loss: 0.9941660597500885
val_total_loss: 0.6575187377078618
test_abn_acc: 0
balanced_train_acc: 0.8445668029748666
balanced_val_acc: 0.5432753910499721
Land_on_Land_train_acc: 0.9939965694682675
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.41304347826086957
Land_on_Water_val_acc: 0.4291845493562232
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.007518796992481203
Water_on_Water_train_acc: 0.7615894039735099
Water_on_Water_val_acc: 0.7443609022556391
train_abn_cls_loss: 0.6816069609803129
train_abn_att_clip_vit_loss: 0.0610383808853666
train_acc_Landbird: 0.9649646931015752
train_acc_Waterbird: 0.7241689128481581
val_acc_Landbird: 0.7106109324758842
val_acc_Waterbird: 0.37593984962406013
TRAIN ACC:        0.9090719499478623
VAL ACC:          0.6363636363636364
BALANCED VAL ACC: 0.5432753910499721
prev best list: ['best_balanced_valacc_0.54_epoch_16.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.54_epoch_17.ckpt
EPOCH: 18

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.95it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.43it/s]
 10%|█         | 5/50 [00:02<00:16,  2.79it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.10it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.32it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.49it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.56it/s]
 20%|██        | 10/50 [00:03<00:10,  3.66it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.74it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.83it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.98it/s]
 30%|███       | 15/50 [00:04<00:08,  4.03it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:06<00:07,  4.08it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.05it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.13it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.13it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.14it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.14it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.14it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.14it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.15it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.14it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.11it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.13it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9117831074035454
val_acc: 0.6238532110091743
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.24475195588421647
val_cls_loss: 0.6754589584144182
train_total_loss: 0.9860748266278765
val_total_loss: 0.6754589584144182
test_abn_acc: 0
balanced_train_acc: 0.8516606369931572
balanced_val_acc: 0.5419557736785694
Land_on_Land_train_acc: 0.9951400800457404
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3695652173913043
Land_on_Water_val_acc: 0.38626609442060084
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.022556390977443608
Water_on_Water_train_acc: 0.7776726584673604
Water_on_Water_val_acc: 0.7669172932330827
train_abn_cls_loss: 0.6803370168982258
train_abn_att_clip_vit_loss: 0.06098584403148906
train_acc_Landbird: 0.9638783269961977
train_acc_Waterbird: 0.7394429469901168
val_acc_Landbird: 0.6891747052518756
val_acc_Waterbird: 0.39473684210526316
TRAIN ACC:        0.9117831074035454
VAL ACC:          0.6238532110091743
BALANCED VAL ACC: 0.5419557736785694
EPOCH: 19

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.99it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.42it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.30it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9155370177267987
val_acc: 0.6313594662218516
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.24075139381216762
val_cls_loss: 0.6726578823271346
train_total_loss: 0.9802320025387348
val_total_loss: 0.6726578823271346
test_abn_acc: 0
balanced_train_acc: 0.8569259255463431
balanced_val_acc: 0.5440913376689311
Land_on_Land_train_acc: 0.9948542024013722
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.42391304347826086
Land_on_Water_val_acc: 0.40987124463519314
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.022556390977443608
Water_on_Water_train_acc: 0.7861873226111636
Water_on_Water_val_acc: 0.7518796992481203
train_abn_cls_loss: 0.6785295937680352
train_abn_att_clip_vit_loss: 0.06095101687439539
train_acc_Landbird: 0.9663226507332972
train_acc_Waterbird: 0.7475292003593891
val_acc_Landbird: 0.7009646302250804
val_acc_Waterbird: 0.38721804511278196
TRAIN ACC:        0.9155370177267987
VAL ACC:          0.6313594662218516
BALANCED VAL ACC: 0.5440913376689311
prev best list: ['best_balanced_valacc_0.54_epoch_17.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.54_epoch_19.ckpt
EPOCH: 20

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.43s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.95it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.14it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.36it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.52it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.63it/s]
 20%|██        | 10/50 [00:03<00:10,  3.69it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.75it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.80it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.82it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.85it/s]
 30%|███       | 15/50 [00:04<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.90it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.92it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.91it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.90it/s]
 46%|████▌     | 23/50 [00:07<00:06,  3.90it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.90it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.90it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.89it/s]
 54%|█████▍    | 27/50 [00:08<00:05,  3.89it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.88it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.87it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.88it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  3.89it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.90it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.89it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.90it/s]
 70%|███████   | 35/50 [00:10<00:03,  3.89it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.89it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.88it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.89it/s]
 78%|███████▊  | 39/50 [00:11<00:02,  3.90it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.88it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.88it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  4.02it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.05it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:13<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.18it/s]
100%|██████████| 50/50 [00:13<00:00,  3.59it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.68it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.23it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9147028154327425
val_acc: 0.6230191826522101
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.23646756390088294
val_cls_loss: 0.6864668014051518
train_total_loss: 0.9761892577033098
val_total_loss: 0.6864668014051518
test_abn_acc: 0
balanced_train_acc: 0.8579499451692578
balanced_val_acc: 0.5481388358355697
Land_on_Land_train_acc: 0.9942824471126358
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3858695652173913
Land_on_Water_val_acc: 0.37339055793991416
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.7909176915799432
Water_on_Water_val_acc: 0.7969924812030075
train_abn_cls_loss: 0.6787968470978165
train_abn_att_clip_vit_loss: 0.06092484116989331
train_acc_Landbird: 0.9638783269961977
train_acc_Waterbird: 0.7520215633423181
val_acc_Landbird: 0.6827438370846731
val_acc_Waterbird: 0.41353383458646614
TRAIN ACC:        0.9147028154327425
VAL ACC:          0.6230191826522101
BALANCED VAL ACC: 0.5481388358355697
prev best list: ['best_balanced_valacc_0.54_epoch_19.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.55_epoch_20.ckpt
EPOCH: 21

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.47it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.78it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.94it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.04it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.11it/s]
 40%|████      | 20/50 [00:06<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.12it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.12it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.10it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.73it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.64it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.33it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.26it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9165797705943691
val_acc: 0.6255212677231026
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.2316658046652055
val_cls_loss: 0.6866835727107038
train_total_loss: 0.9692346305121222
val_total_loss: 0.6866835727107038
test_abn_acc: 0
balanced_train_acc: 0.8623065123890148
balanced_val_acc: 0.5524341400124104
Land_on_Land_train_acc: 0.994568324757004
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.375
Land_on_Water_val_acc: 0.37553648068669526
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.022556390977443608
Water_on_Water_train_acc: 0.8003784295175024
Water_on_Water_val_acc: 0.8195488721804511
train_abn_cls_loss: 0.6766813828997368
train_abn_att_clip_vit_loss: 0.06088744543562716
train_acc_Landbird: 0.9636067354698533
train_acc_Waterbird: 0.7610062893081762
val_acc_Landbird: 0.6838156484458735
val_acc_Waterbird: 0.42105263157894735
TRAIN ACC:        0.9165797705943691
VAL ACC:          0.6255212677231026
BALANCED VAL ACC: 0.5524341400124104
prev best list: ['best_balanced_valacc_0.55_epoch_20.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.55_epoch_21.ckpt
EPOCH: 22

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.94it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.27it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.50it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.69it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.81it/s]
 20%|██        | 10/50 [00:03<00:10,  3.90it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.96it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.08it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.11it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:05<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.13it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.12it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.12it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.14it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.13it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.18it/s]
100%|██████████| 50/50 [00:13<00:00,  3.73it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.24s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.55it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.09it/s]
100%|██████████| 13/13 [00:03<00:00,  6.28it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9174139728884254
val_acc: 0.6288573811509591
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.22758995333416493
val_cls_loss: 0.6871231691950654
train_total_loss: 0.9642996555324391
val_total_loss: 0.6871231691950654
test_abn_acc: 0
balanced_train_acc: 0.8647303386524278
balanced_val_acc: 0.5532339691672912
Land_on_Land_train_acc: 0.9937106918238994
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3804347826086957
Land_on_Water_val_acc: 0.38626609442060084
Water_on_Land_train_acc: 0.03571428571428571
Water_on_Land_val_acc: 0.022556390977443608
Water_on_Water_train_acc: 0.8051087984862819
Water_on_Water_val_acc: 0.8120300751879699
train_abn_cls_loss: 0.675851494142236
train_abn_att_clip_vit_loss: 0.06085819204777821
train_acc_Landbird: 0.9630635524171646
train_acc_Waterbird: 0.766397124887691
val_acc_Landbird: 0.6891747052518756
val_acc_Waterbird: 0.41729323308270677
TRAIN ACC:        0.9174139728884254
VAL ACC:          0.6288573811509591
BALANCED VAL ACC: 0.5532339691672912
prev best list: ['best_balanced_valacc_0.55_epoch_21.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.55_epoch_22.ckpt
EPOCH: 23

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:14,  1.53s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.30it/s]
  6%|▌         | 3/50 [00:02<00:24,  1.90it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.41it/s]
 10%|█         | 5/50 [00:02<00:15,  2.81it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.11it/s]
 14%|█▍        | 7/50 [00:03<00:12,  3.36it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.64it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.95it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.04it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.13it/s]
 34%|███▍      | 17/50 [00:05<00:07,  4.14it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.12it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.15it/s]
 40%|████      | 20/50 [00:06<00:07,  4.16it/s]
 42%|████▏     | 21/50 [00:06<00:06,  4.17it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.15it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.16it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.17it/s]
 50%|█████     | 25/50 [00:07<00:05,  4.17it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.15it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.14it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.15it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.16it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.15it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.14it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.13it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.14it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.16it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.16it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.16it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.14it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.15it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.14it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.15it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.14it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.15it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.14it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.15it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.15it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  4.20it/s]
100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:15,  1.30s/it]
 23%|██▎       | 3/13 [00:01<00:04,  2.48it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.88it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.20it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.76it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.92it/s]
100%|██████████| 13/13 [00:03<00:00,  6.14it/s]
100%|██████████| 13/13 [00:03<00:00,  3.93it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9232533889468196
val_acc: 0.6305254378648875
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.22249206444083464
val_cls_loss: 0.6927703979663594
train_total_loss: 0.9589463476592731
val_total_loss: 0.6927703979663594
test_abn_acc: 0
balanced_train_acc: 0.8782492766099912
balanced_val_acc: 0.5583371612310519
Land_on_Land_train_acc: 0.9951400800457404
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.33695652173913043
Land_on_Water_val_acc: 0.38412017167381973
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.022556390977443608
Water_on_Water_train_acc: 0.8353831598864712
Water_on_Water_val_acc: 0.8345864661654135
train_abn_cls_loss: 0.6756066378388589
train_abn_att_clip_vit_loss: 0.06084763872533322
train_acc_Landbird: 0.9622487778381315
train_acc_Waterbird: 0.7942497753818508
val_acc_Landbird: 0.6881028938906752
val_acc_Waterbird: 0.42857142857142855
TRAIN ACC:        0.9232533889468196
VAL ACC:          0.6305254378648875
BALANCED VAL ACC: 0.5583371612310519
prev best list: ['best_balanced_valacc_0.55_epoch_22.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.56_epoch_23.ckpt
EPOCH: 24

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.95it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.27it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.50it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.69it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.82it/s]
 20%|██        | 10/50 [00:03<00:10,  3.92it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.98it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.04it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.06it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.10it/s]
 30%|███       | 15/50 [00:04<00:08,  4.12it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.12it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.12it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.14it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.13it/s]
 40%|████      | 20/50 [00:05<00:07,  4.13it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.12it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.13it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.12it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.01it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.94it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.93it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.91it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  3.89it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.88it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.90it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.92it/s]
 80%|████████  | 40/50 [00:10<00:02,  3.91it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.91it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.91it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.93it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  3.92it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.90it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.91it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.92it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.92it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.89it/s]
100%|██████████| 50/50 [00:13<00:00,  3.95it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.75it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.95it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.15it/s]
100%|██████████| 13/13 [00:03<00:00,  6.30it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9220020855057351
val_acc: 0.6255212677231026
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.21911459851066065
val_cls_loss: 0.7017168635075245
train_total_loss: 0.9536919565220695
val_total_loss: 0.7017168635075245
test_abn_acc: 0
balanced_train_acc: 0.8746135372148716
balanced_val_acc: 0.5578093142824907
Land_on_Land_train_acc: 0.9939965694682675
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.375
Land_on_Water_val_acc: 0.3669527896995708
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.826868495742668
Water_on_Water_val_acc: 0.8421052631578947
train_abn_cls_loss: 0.6737499349930239
train_abn_att_clip_vit_loss: 0.06082740938902771
train_acc_Landbird: 0.9630635524171646
train_acc_Waterbird: 0.7861635220125787
val_acc_Landbird: 0.6795284030010718
val_acc_Waterbird: 0.43609022556390975
TRAIN ACC:        0.9220020855057351
VAL ACC:          0.6255212677231026
BALANCED VAL ACC: 0.5578093142824907
EPOCH: 25

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.07it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.44it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.78it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.94it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.02it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.04it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.06it/s]
 30%|███       | 15/50 [00:04<00:08,  4.07it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.05it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.07it/s]
 40%|████      | 20/50 [00:05<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.04it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.05it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.05it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.05it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.05it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.05it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.05it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.06it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.07it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.03it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.01it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.01it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.04it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.33it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.95it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.29it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9228362877997914
val_acc: 0.6355296080066722
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.2175148648191418
val_cls_loss: 0.6898616696269041
train_total_loss: 0.9510461371807659
val_total_loss: 0.6898616696269041
test_abn_acc: 0
balanced_train_acc: 0.8776642445485261
balanced_val_acc: 0.5588650081796129
Land_on_Land_train_acc: 0.9937106918238994
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.358695652173913
Land_on_Water_val_acc: 0.4012875536480687
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.022556390977443608
Water_on_Water_train_acc: 0.8325449385052034
Water_on_Water_val_acc: 0.8195488721804511
train_abn_cls_loss: 0.6727130709897738
train_abn_att_clip_vit_loss: 0.0608181984786321
train_acc_Landbird: 0.9619771863117871
train_acc_Waterbird: 0.793351302785265
val_acc_Landbird: 0.6966773847802786
val_acc_Waterbird: 0.42105263157894735
TRAIN ACC:        0.9228362877997914
VAL ACC:          0.6355296080066722
BALANCED VAL ACC: 0.5588650081796129
prev best list: ['best_balanced_valacc_0.56_epoch_23.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.56_epoch_25.ckpt
EPOCH: 26

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.94it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.81it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.03it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.06it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:05<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.13it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  3.97it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.97it/s]
100%|██████████| 50/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.27it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.63it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9263816475495308
val_acc: 0.6263552960800667
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.2098743989022606
val_cls_loss: 0.7075721158694982
train_total_loss: 0.9422647179602582
val_total_loss: 0.7075721158694982
test_abn_acc: 0
balanced_train_acc: 0.8821668562682983
balanced_val_acc: 0.5596890135306111
Land_on_Land_train_acc: 0.9939965694682675
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.4076086956521739
Land_on_Water_val_acc: 0.3669527896995708
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.8410596026490066
Water_on_Water_val_acc: 0.849624060150376
train_abn_cls_loss: 0.6715920618104985
train_abn_att_clip_vit_loss: 0.06079825396194075
train_acc_Landbird: 0.9646931015752308
train_acc_Waterbird: 0.7996406109613656
val_acc_Landbird: 0.6795284030010718
val_acc_Waterbird: 0.4398496240601504
TRAIN ACC:        0.9263816475495308
VAL ACC:          0.6263552960800667
BALANCED VAL ACC: 0.5596890135306111
prev best list: ['best_balanced_valacc_0.56_epoch_25.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.56_epoch_26.ckpt
EPOCH: 27

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.43s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.95it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.13it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.63it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.76it/s]
 20%|██        | 10/50 [00:03<00:10,  3.87it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.02it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.04it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.08it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.04it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.02it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.01it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.01it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.03it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.06it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.02it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.02it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.66it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.83it/s]
100%|██████████| 13/13 [00:03<00:00,  5.92it/s]
100%|██████████| 13/13 [00:03<00:00,  4.01it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9249217935349322
val_acc: 0.6263552960800667
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.20914057928280239
val_cls_loss: 0.7071933547241475
train_total_loss: 0.9417014904141551
val_total_loss: 0.7071933547241475
test_abn_acc: 0
balanced_train_acc: 0.8812162859260929
balanced_val_acc: 0.5596890135306111
Land_on_Land_train_acc: 0.994568324757004
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.358695652173913
Land_on_Water_val_acc: 0.3669527896995708
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.8410596026490066
Water_on_Water_val_acc: 0.849624060150376
train_abn_cls_loss: 0.6717854330885273
train_abn_att_clip_vit_loss: 0.06077547423129783
train_acc_Landbird: 0.9627919608908202
train_acc_Waterbird: 0.7996406109613656
val_acc_Landbird: 0.6795284030010718
val_acc_Waterbird: 0.4398496240601504
TRAIN ACC:        0.9249217935349322
VAL ACC:          0.6263552960800667
BALANCED VAL ACC: 0.5596890135306111
prev best list: ['best_balanced_valacc_0.56_epoch_26.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.56_epoch_27.ckpt
EPOCH: 28

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.97it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.54it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.96it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.07it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  4.02it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.13it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.13it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.03it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.03it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.04it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.03it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.01it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.05it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.03it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.06it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.79it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.80it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.96it/s]
100%|██████████| 13/13 [00:03<00:00,  6.12it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9255474452554745
val_acc: 0.6271893244370309
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.2061719437927101
val_cls_loss: 0.7095898100989774
train_total_loss: 0.9380249396976514
val_total_loss: 0.7095898100989774
test_abn_acc: 0
balanced_train_acc: 0.883190875891213
balanced_val_acc: 0.5629125063462515
Land_on_Land_train_acc: 0.9942824471126358
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3532608695652174
Land_on_Water_val_acc: 0.3648068669527897
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.8457899716177862
Water_on_Water_val_acc: 0.8646616541353384
train_abn_cls_loss: 0.671053049934793
train_abn_att_clip_vit_loss: 0.060799936404038024
train_acc_Landbird: 0.9622487778381315
train_acc_Waterbird: 0.8041329739442947
val_acc_Landbird: 0.6784565916398714
val_acc_Waterbird: 0.4473684210526316
TRAIN ACC:        0.9255474452554745
VAL ACC:          0.6271893244370309
BALANCED VAL ACC: 0.5629125063462515
prev best list: ['best_balanced_valacc_0.56_epoch_27.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.56_epoch_28.ckpt
EPOCH: 29

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.61it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.93it/s]
 40%|████      | 20/50 [00:06<00:07,  3.94it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.95it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.93it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.00it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.11it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9288842544316996
val_acc: 0.628023352793995
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.20245037950552044
val_cls_loss: 0.7079803925986285
train_total_loss: 0.932552798945414
val_total_loss: 0.7079803925986285
test_abn_acc: 0
balanced_train_acc: 0.8903786566638995
balanced_val_acc: 0.5621046184593316
Land_on_Land_train_acc: 0.9942824471126358
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3532608695652174
Land_on_Water_val_acc: 0.36909871244635195
Water_on_Land_train_acc: 0.03571428571428571
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.8599810785241249
Water_on_Water_val_acc: 0.8571428571428571
train_abn_cls_loss: 0.6692907968452502
train_abn_att_clip_vit_loss: 0.06081161133641993
train_acc_Landbird: 0.9622487778381315
train_acc_Waterbird: 0.8185085354896675
val_acc_Landbird: 0.6806002143622722
val_acc_Waterbird: 0.44360902255639095
TRAIN ACC:        0.9288842544316996
VAL ACC:          0.628023352793995
BALANCED VAL ACC: 0.5621046184593316
EPOCH: 30

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.80it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.06it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.04it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.04it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.02it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.03it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.08it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.13it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.14it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.19it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.14it/s]
100%|██████████| 13/13 [00:03<00:00,  6.29it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9301355578727841
val_acc: 0.6246872393661385
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.19951585181935363
val_cls_loss: 0.7153218648799565
train_total_loss: 0.9297044341208663
val_total_loss: 0.7153218648799565
test_abn_acc: 0
balanced_train_acc: 0.891820312313174
balanced_val_acc: 0.5613047893044508
Land_on_Land_train_acc: 0.9954259576901087
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3532608695652174
Land_on_Water_val_acc: 0.3583690987124464
Water_on_Land_train_acc: 0.03571428571428571
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.8618732261116367
Water_on_Water_val_acc: 0.8646616541353384
train_abn_cls_loss: 0.6693876414776345
train_abn_att_clip_vit_loss: 0.06080093643510553
train_acc_Landbird: 0.9633351439435089
train_acc_Waterbird: 0.8203054806828391
val_acc_Landbird: 0.6752411575562701
val_acc_Waterbird: 0.4473684210526316
TRAIN ACC:        0.9301355578727841
VAL ACC:          0.6246872393661385
BALANCED VAL ACC: 0.5613047893044508
EPOCH: 31

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  4.00it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.01it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.99it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.10s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.86it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.16it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.53it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.06it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.53it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.89it/s]
100%|██████████| 13/13 [00:03<00:00,  4.23it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9322210636079249
val_acc: 0.6305254378648875
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.19406888656186114
val_cls_loss: 0.7084107511584414
train_total_loss: 0.9229725562743026
val_total_loss: 0.7084107511584414
test_abn_acc: 0
balanced_train_acc: 0.8941185915502581
balanced_val_acc: 0.5637123355011322
Land_on_Land_train_acc: 0.9954259576901087
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.391304347826087
Land_on_Water_val_acc: 0.37553648068669526
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.03007518796992481
Water_on_Water_train_acc: 0.8637653736991485
Water_on_Water_val_acc: 0.8571428571428571
train_abn_cls_loss: 0.6681206545441939
train_abn_att_clip_vit_loss: 0.060783009652953454
train_acc_Landbird: 0.9652362846279197
train_acc_Waterbird: 0.8230008984725966
val_acc_Landbird: 0.6838156484458735
val_acc_Waterbird: 0.44360902255639095
TRAIN ACC:        0.9322210636079249
VAL ACC:          0.6305254378648875
BALANCED VAL ACC: 0.5637123355011322
prev best list: ['best_balanced_valacc_0.56_epoch_28.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.56_epoch_31.ckpt
EPOCH: 32

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.06it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.02it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.02it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.03it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  4.00it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.99it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.14it/s]
100%|██████████| 13/13 [00:03<00:00,  6.40it/s]
100%|██████████| 13/13 [00:03<00:00,  4.18it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9293013555787278
val_acc: 0.6271893244370309
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1930849834266619
val_cls_loss: 0.7134829381538292
train_total_loss: 0.9210375607200161
val_total_loss: 0.7134829381538292
test_abn_acc: 0
balanced_train_acc: 0.8909636887253646
balanced_val_acc: 0.5642562999137716
Land_on_Land_train_acc: 0.9948542024013722
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.34782608695652173
Land_on_Water_val_acc: 0.3626609442060086
Water_on_Land_train_acc: 0.03571428571428571
Water_on_Land_val_acc: 0.03759398496240601
Water_on_Water_train_acc: 0.8609271523178808
Water_on_Water_val_acc: 0.8646616541353384
train_abn_cls_loss: 0.6671298497660441
train_abn_att_clip_vit_loss: 0.060822712053565216
train_acc_Landbird: 0.9625203693644758
train_acc_Waterbird: 0.8194070080862533
val_acc_Landbird: 0.677384780278671
val_acc_Waterbird: 0.45112781954887216
TRAIN ACC:        0.9293013555787278
VAL ACC:          0.6271893244370309
BALANCED VAL ACC: 0.5642562999137716
prev best list: ['best_balanced_valacc_0.56_epoch_31.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.56_epoch_32.ckpt
EPOCH: 33

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:03,  1.29s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.47it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.08it/s]
  8%|▊         | 4/50 [00:02<00:17,  2.57it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.63it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.73it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.93it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.93it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.94it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.00it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.77it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.06it/s]
100%|██████████| 13/13 [00:03<00:00,  6.36it/s]
100%|██████████| 13/13 [00:03<00:00,  4.14it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9311783107403545
val_acc: 0.6263552960800667
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1886024020573394
val_cls_loss: 0.7194397181794482
train_total_loss: 0.9150935137856119
val_total_loss: 0.7194397181794482
test_abn_acc: 0
balanced_train_acc: 0.8956336964802422
balanced_val_acc: 0.5664079813682115
Land_on_Land_train_acc: 0.994568324757004
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3423913043478261
Land_on_Water_val_acc: 0.3562231759656652
Water_on_Land_train_acc: 0.017857142857142856
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.8722800378429517
Water_on_Water_val_acc: 0.8721804511278195
train_abn_cls_loss: 0.6656940854254555
train_abn_att_clip_vit_loss: 0.06079702051715757
train_acc_Landbird: 0.9619771863117871
train_acc_Waterbird: 0.8292902066486972
val_acc_Landbird: 0.6741693461950696
val_acc_Waterbird: 0.45864661654135336
TRAIN ACC:        0.9311783107403545
VAL ACC:          0.6263552960800667
BALANCED VAL ACC: 0.5664079813682115
prev best list: ['best_balanced_valacc_0.56_epoch_32.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.57_epoch_33.ckpt
EPOCH: 34

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.90it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.07it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.12it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.14it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.14it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.14it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.16it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.16it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.15it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.13it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.07it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.05it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.10it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.13it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.14it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.95it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.27it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9347236704900939
val_acc: 0.6288573811509591
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.18494736793702538
val_cls_loss: 0.7175953507522825
train_total_loss: 0.9105102206171491
val_total_loss: 0.7175953507522825
test_abn_acc: 0
balanced_train_acc: 0.9004497487351351
balanced_val_acc: 0.5666719048424921
Land_on_Land_train_acc: 0.9962835906232133
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.358695652173913
Land_on_Water_val_acc: 0.3648068669527897
Water_on_Land_train_acc: 0.03571428571428571
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.8789025543992431
Water_on_Water_val_acc: 0.8646616541353384
train_abn_cls_loss: 0.6646723060215104
train_abn_att_clip_vit_loss: 0.06089054913152246
train_acc_Landbird: 0.9644215100488864
train_acc_Waterbird: 0.8364779874213837
val_acc_Landbird: 0.6784565916398714
val_acc_Waterbird: 0.4548872180451128
TRAIN ACC:        0.9347236704900939
VAL ACC:          0.6288573811509591
BALANCED VAL ACC: 0.5666719048424921
prev best list: ['best_balanced_valacc_0.57_epoch_33.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.57_epoch_34.ckpt
EPOCH: 35

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.82it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.90it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.96it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.98it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.98it/s]
 30%|███       | 15/50 [00:04<00:08,  4.02it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.03it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.03it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.03it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.00it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.02it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.04it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.12it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.11it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.14it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.32it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.22it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.935349322210636
val_acc: 0.6355296080066722
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.182142071713372
val_cls_loss: 0.7073649964400189
train_total_loss: 0.9064803389239983
val_total_loss: 0.7073649964400189
test_abn_acc: 0
balanced_train_acc: 0.9017974576300137
balanced_val_acc: 0.5696153567197737
Land_on_Land_train_acc: 0.9948542024013722
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3858695652173913
Land_on_Water_val_acc: 0.38412017167381973
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.8807947019867549
Water_on_Water_val_acc: 0.8571428571428571
train_abn_cls_loss: 0.6634500591299954
train_abn_att_clip_vit_loss: 0.06088820639317923
train_acc_Landbird: 0.9644215100488864
train_acc_Waterbird: 0.839173405211141
val_acc_Landbird: 0.6881028938906752
val_acc_Waterbird: 0.45112781954887216
TRAIN ACC:        0.935349322210636
VAL ACC:          0.6355296080066722
BALANCED VAL ACC: 0.5696153567197737
prev best list: ['best_balanced_valacc_0.57_epoch_34.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.57_epoch_35.ckpt
EPOCH: 36

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.41s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.97it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.93it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.93it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.93it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.94it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.03it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.04it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.93it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.94it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.94it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.93it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.92it/s]
100%|██████████| 50/50 [00:13<00:00,  3.96it/s]
100%|██████████| 50/50 [00:13<00:00,  3.61it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.23s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.59it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.80it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.92it/s]
100%|██████████| 13/13 [00:03<00:00,  6.17it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9359749739311783
val_acc: 0.6380316930775647
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1802193914762503
val_cls_loss: 0.7098005636221573
train_total_loss: 0.905327032480051
val_total_loss: 0.7098005636221573
test_abn_acc: 0
balanced_train_acc: 0.902518285454651
balanced_val_acc: 0.5725668673290945
Land_on_Land_train_acc: 0.9951400800457404
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.391304347826087
Land_on_Water_val_acc: 0.388412017167382
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.8817407757805109
Water_on_Water_val_acc: 0.8646616541353384
train_abn_cls_loss: 0.6641832563998925
train_abn_att_clip_vit_loss: 0.06092438549114094
train_acc_Landbird: 0.9649646931015752
train_acc_Waterbird: 0.8400718778077269
val_acc_Landbird: 0.6902465166130761
val_acc_Waterbird: 0.4548872180451128
TRAIN ACC:        0.9359749739311783
VAL ACC:          0.6380316930775647
BALANCED VAL ACC: 0.5725668673290945
prev best list: ['best_balanced_valacc_0.57_epoch_35.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.57_epoch_36.ckpt
EPOCH: 37

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.49it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.78it/s]
 20%|██        | 10/50 [00:03<00:10,  3.90it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.98it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.09it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.10it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:05<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.13it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.12it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.08it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.06it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.11s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.80it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.43it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.01it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.15it/s]
100%|██████████| 13/13 [00:02<00:00,  6.38it/s]
100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9361835245046923
val_acc: 0.6388657214345288
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.17704529209107128
val_cls_loss: 0.7053037741663458
train_total_loss: 0.900395059535849
val_total_loss: 0.7053037741663458
test_abn_acc: 0
balanced_train_acc: 0.9035944028231854
balanced_val_acc: 0.5744465665772147
Land_on_Land_train_acc: 0.9951400800457404
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3804347826086957
Land_on_Water_val_acc: 0.388412017167382
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.8845789971617786
Water_on_Water_val_acc: 0.8721804511278195
train_abn_cls_loss: 0.6623839590049759
train_abn_att_clip_vit_loss: 0.060965810260882096
train_acc_Landbird: 0.9644215100488864
train_acc_Waterbird: 0.8427672955974843
val_acc_Landbird: 0.6902465166130761
val_acc_Waterbird: 0.45864661654135336
TRAIN ACC:        0.9361835245046923
VAL ACC:          0.6388657214345288
BALANCED VAL ACC: 0.5744465665772147
prev best list: ['best_balanced_valacc_0.57_epoch_36.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.57_epoch_37.ckpt
EPOCH: 38

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.49it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.91it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.01it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.06it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.12it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.13it/s]
 40%|████      | 20/50 [00:06<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.12it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.05it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.94it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.93it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.92it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.05it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.14it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.22it/s]
100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9372262773722628
val_acc: 0.6455379482902419
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1759133859489956
val_cls_loss: 0.6960606913053562
train_total_loss: 0.8980376773631361
val_total_loss: 0.6960606913053562
test_abn_acc: 0
balanced_train_acc: 0.9030196194985635
balanced_val_acc: 0.5760462248869762
Land_on_Land_train_acc: 0.9954259576901087
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.42391304347826086
Land_on_Water_val_acc: 0.40987124463519314
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.03759398496240601
Water_on_Water_train_acc: 0.8807947019867549
Water_on_Water_val_acc: 0.8646616541353384
train_abn_cls_loss: 0.661150457873956
train_abn_att_clip_vit_loss: 0.060973835773804885
train_acc_Landbird: 0.9668658337859859
train_acc_Waterbird: 0.839173405211141
val_acc_Landbird: 0.7009646302250804
val_acc_Waterbird: 0.45112781954887216
TRAIN ACC:        0.9372262773722628
VAL ACC:          0.6455379482902419
BALANCED VAL ACC: 0.5760462248869762
prev best list: ['best_balanced_valacc_0.57_epoch_37.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.58_epoch_38.ckpt
EPOCH: 39

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.41s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.94it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.44it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.14it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.34it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.92it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.95it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.96it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.09it/s]
100%|██████████| 13/13 [00:03<00:00,  6.32it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.940354535974974
val_acc: 0.640533778148457
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.17125705918442843
val_cls_loss: 0.7121183029107991
train_total_loss: 0.8913676996797913
val_total_loss: 0.7121183029107991
test_abn_acc: 0
balanced_train_acc: 0.9097581639729571
balanced_val_acc: 0.5822373457760156
Land_on_Land_train_acc: 0.9968553459119497
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.3967391304347826
Land_on_Water_val_acc: 0.38197424892703863
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.06015037593984962
Water_on_Water_train_acc: 0.8949858088930936
Water_on_Water_val_acc: 0.8947368421052632
train_abn_cls_loss: 0.6590855961547032
train_abn_att_clip_vit_loss: 0.06102503581017225
train_acc_Landbird: 0.9668658337859859
train_acc_Waterbird: 0.8526504941599281
val_acc_Landbird: 0.6870310825294748
val_acc_Waterbird: 0.4774436090225564
TRAIN ACC:        0.940354535974974
VAL ACC:          0.640533778148457
BALANCED VAL ACC: 0.5822373457760156
prev best list: ['best_balanced_valacc_0.58_epoch_38.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.58_epoch_39.ckpt
EPOCH: 40

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.61it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.02it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.94it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.94it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.94it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.61it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.23it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.73it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.95it/s]
100%|██████████| 13/13 [00:03<00:00,  6.01it/s]
100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9413972888425444
val_acc: 0.6396997497914929
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.16909961380662708
val_cls_loss: 0.7036690854151314
train_total_loss: 0.8887837983271626
val_total_loss: 0.7036690854151314
test_abn_acc: 0
balanced_train_acc: 0.9094968211834558
balanced_val_acc: 0.5763262658253351
Land_on_Land_train_acc: 0.9965694682675815
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.44565217391304346
Land_on_Water_val_acc: 0.388412017167382
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.8921475875118259
Water_on_Water_val_acc: 0.8796992481203008
train_abn_cls_loss: 0.658662861927458
train_abn_att_clip_vit_loss: 0.06102131666990465
train_acc_Landbird: 0.9690385659967409
train_acc_Waterbird: 0.8499550763701708
val_acc_Landbird: 0.6902465166130761
val_acc_Waterbird: 0.462406015037594
TRAIN ACC:        0.9413972888425444
VAL ACC:          0.6396997497914929
BALANCED VAL ACC: 0.5763262658253351
EPOCH: 41

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.44it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.87it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.89it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.03it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.06it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.04it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.02it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.05it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.04it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.01it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.01it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.02it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.04it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.03it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.78it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.12it/s]
 46%|████▌     | 6/13 [00:01<00:01,  3.82it/s]
 62%|██████▏   | 8/13 [00:02<00:00,  5.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.48it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.99it/s]
100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9426485922836287
val_acc: 0.6522101751459549
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1681053753565449
val_cls_loss: 0.6889016682202862
train_total_loss: 0.8863952642934041
val_total_loss: 0.6889016682202862
test_abn_acc: 0
balanced_train_acc: 0.913446001113696
balanced_val_acc: 0.5843648510343382
Land_on_Land_train_acc: 0.9971412235563178
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.41304347826086957
Land_on_Water_val_acc: 0.4206008583690987
Water_on_Land_train_acc: 0.07142857142857142
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.9006622516556292
Water_on_Water_val_acc: 0.8796992481203008
train_abn_cls_loss: 0.6572464309842544
train_abn_att_clip_vit_loss: 0.06104345156173139
train_acc_Landbird: 0.9679521998913634
train_acc_Waterbird: 0.8589398023360287
val_acc_Landbird: 0.7063236870310825
val_acc_Waterbird: 0.462406015037594
TRAIN ACC:        0.9426485922836287
VAL ACC:          0.6522101751459549
BALANCED VAL ACC: 0.5843648510343382
prev best list: ['best_balanced_valacc_0.58_epoch_39.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.58_epoch_41.ckpt
EPOCH: 42

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.80it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.95it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.94it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.95it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.94it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.94it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.94it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.97it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.88it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.19it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.67it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.80it/s]
100%|██████████| 13/13 [00:03<00:00,  5.96it/s]
100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9451511991657977
val_acc: 0.6538782318598833
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.16388213821260475
val_cls_loss: 0.6881862506456828
train_total_loss: 0.8818446826014952
val_total_loss: 0.6881862506456828
test_abn_acc: 0
balanced_train_acc: 0.9178965150878488
balanced_val_acc: 0.5854366623955387
Land_on_Land_train_acc: 0.9968553459119497
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.43478260869565216
Land_on_Water_val_acc: 0.4248927038626609
Water_on_Land_train_acc: 0.08928571428571429
Water_on_Land_val_acc: 0.045112781954887216
Water_on_Water_train_acc: 0.9082308420056765
Water_on_Water_val_acc: 0.8796992481203008
train_abn_cls_loss: 0.656834527262806
train_abn_att_clip_vit_loss: 0.06112800889004632
train_acc_Landbird: 0.9687669744703965
train_acc_Waterbird: 0.867026055705301
val_acc_Landbird: 0.7084673097534834
val_acc_Waterbird: 0.462406015037594
TRAIN ACC:        0.9451511991657977
VAL ACC:          0.6538782318598833
BALANCED VAL ACC: 0.5854366623955387
prev best list: ['best_balanced_valacc_0.58_epoch_41.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.59_epoch_42.ckpt
EPOCH: 43

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.49it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.88it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.94it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.98it/s]
 30%|███       | 15/50 [00:04<00:08,  4.00it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.02it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.03it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.06it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.07it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.09it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.05it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.06it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.07it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.06it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.06it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.06it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.08it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.07it/s]
100%|██████████| 13/13 [00:03<00:00,  3.99it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9424400417101148
val_acc: 0.6563803169307757
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.16213549806564517
val_cls_loss: 0.6844982084032891
train_total_loss: 0.8791414370004775
val_total_loss: 0.6844982084032891
test_abn_acc: 0
balanced_train_acc: 0.9136236458856446
balanced_val_acc: 0.5924195537074197
Land_on_Land_train_acc: 0.9962835906232133
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.41847826086956524
Land_on_Water_val_acc: 0.4227467811158798
Water_on_Land_train_acc: 0.05357142857142857
Water_on_Land_val_acc: 0.06015037593984962
Water_on_Water_train_acc: 0.902554399243141
Water_on_Water_val_acc: 0.8947368421052632
train_abn_cls_loss: 0.6557999641480112
train_abn_att_clip_vit_loss: 0.06120596971125871
train_acc_Landbird: 0.9674090168386746
train_acc_Waterbird: 0.8598382749326146
val_acc_Landbird: 0.707395498392283
val_acc_Waterbird: 0.4774436090225564
TRAIN ACC:        0.9424400417101148
VAL ACC:          0.6563803169307757
BALANCED VAL ACC: 0.5924195537074197
prev best list: ['best_balanced_valacc_0.59_epoch_42.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.59_epoch_43.ckpt
EPOCH: 44

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.80it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.88it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.92it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.93it/s]
 40%|████      | 20/50 [00:06<00:07,  3.93it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.94it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.94it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.93it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.92it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.92it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.92it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.92it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.92it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.92it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.94it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.94it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.93it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.78it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.38it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.39it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.73it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9447340980187695
val_acc: 0.6597164303586321
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.15757772416591148
val_cls_loss: 0.6795408441634652
train_total_loss: 0.872753195991357
val_total_loss: 0.6795408441634652
test_abn_acc: 0
balanced_train_acc: 0.91574428035078
balanced_val_acc: 0.5972507635648607
Land_on_Land_train_acc: 0.9971412235563178
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.45108695652173914
Land_on_Water_val_acc: 0.4270386266094421
Water_on_Land_train_acc: 0.08928571428571429
Water_on_Land_val_acc: 0.06015037593984962
Water_on_Water_train_acc: 0.902554399243141
Water_on_Water_val_acc: 0.9097744360902256
train_abn_cls_loss: 0.653960846847737
train_abn_att_clip_vit_loss: 0.061214624581483655
train_acc_Landbird: 0.969853340575774
train_acc_Waterbird: 0.8616352201257862
val_acc_Landbird: 0.7095391211146839
val_acc_Waterbird: 0.4849624060150376
TRAIN ACC:        0.9447340980187695
VAL ACC:          0.6597164303586321
BALANCED VAL ACC: 0.5972507635648607
prev best list: ['best_balanced_valacc_0.59_epoch_43.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.6_epoch_44.ckpt
EPOCH: 45

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.95it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.95it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.93it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.42it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.27it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9453597497393118
val_acc: 0.6530442035029191
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.15457217786247465
val_cls_loss: 0.68729340552886
train_total_loss: 0.8682388861435422
val_total_loss: 0.68729340552886
test_abn_acc: 0
balanced_train_acc: 0.916778548710538
balanced_val_acc: 0.592963518120059
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.44021739130434784
Land_on_Water_val_acc: 0.40987124463519314
Water_on_Land_train_acc: 0.07142857142857142
Water_on_Land_val_acc: 0.06015037593984962
Water_on_Water_train_acc: 0.9053926206244087
Water_on_Water_val_acc: 0.9097744360902256
train_abn_cls_loss: 0.6523760916791445
train_abn_att_clip_vit_loss: 0.0612906155422159
train_acc_Landbird: 0.9701249321021184
train_acc_Waterbird: 0.8634321653189577
val_acc_Landbird: 0.7009646302250804
val_acc_Waterbird: 0.4849624060150376
TRAIN ACC:        0.9453597497393118
VAL ACC:          0.6530442035029191
BALANCED VAL ACC: 0.592963518120059
EPOCH: 46

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.14it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.94it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.27it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.945985401459854
val_acc: 0.6613844870725605
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.15329392986513898
val_cls_loss: 0.6765570300782692
train_total_loss: 0.8668486148895884
val_total_loss: 0.6765570300782692
test_abn_acc: 0
balanced_train_acc: 0.9196934602810203
balanced_val_acc: 0.5983225749260611
Land_on_Land_train_acc: 0.9965694682675815
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.44021739130434784
Land_on_Water_val_acc: 0.4313304721030043
Water_on_Land_train_acc: 0.07142857142857142
Water_on_Land_val_acc: 0.06015037593984962
Water_on_Water_train_acc: 0.912961210974456
Water_on_Water_val_acc: 0.9097744360902256
train_abn_cls_loss: 0.6522103420885064
train_abn_att_clip_vit_loss: 0.061344340149161715
train_acc_Landbird: 0.9687669744703965
train_acc_Waterbird: 0.8706199460916442
val_acc_Landbird: 0.7116827438370846
val_acc_Waterbird: 0.4849624060150376
TRAIN ACC:        0.945985401459854
VAL ACC:          0.6613844870725605
BALANCED VAL ACC: 0.5983225749260611
prev best list: ['best_balanced_valacc_0.6_epoch_44.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.6_epoch_46.ckpt
EPOCH: 47

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.04it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.04it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.03it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.06it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.03it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.02it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.00it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.01it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.19it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.01it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.94it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.44it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.76it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.945985401459854
val_acc: 0.6630525437864887
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.15178723009584844
val_cls_loss: 0.674498876027011
train_total_loss: 0.8649335948717358
val_total_loss: 0.674498876027011
test_abn_acc: 0
balanced_train_acc: 0.9165590549298133
balanced_val_acc: 0.6020819734223017
Land_on_Land_train_acc: 0.9974271012006861
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.4782608695652174
Land_on_Water_val_acc: 0.4313304721030043
Water_on_Land_train_acc: 0.10714285714285714
Water_on_Land_val_acc: 0.06766917293233082
Water_on_Water_train_acc: 0.9016083254493851
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6517479863852977
train_abn_att_clip_vit_loss: 0.06139837236874916
train_acc_Landbird: 0.9714828897338403
train_acc_Waterbird: 0.8616352201257862
val_acc_Landbird: 0.7116827438370846
val_acc_Waterbird: 0.4924812030075188
TRAIN ACC:        0.945985401459854
VAL ACC:          0.6630525437864887
BALANCED VAL ACC: 0.6020819734223017
prev best list: ['best_balanced_valacc_0.6_epoch_46.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.6_epoch_47.ckpt
EPOCH: 48

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.10s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.83it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.09it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.01it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.15it/s]
100%|██████████| 13/13 [00:02<00:00,  6.39it/s]
100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9493222106360792
val_acc: 0.6630525437864887
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.14943183037113472
val_cls_loss: 0.6773468587575504
train_total_loss: 0.8611169883058765
val_total_loss: 0.6773468587575504
test_abn_acc: 0
balanced_train_acc: 0.9237468357024996
balanced_val_acc: 0.6020819734223017
Land_on_Land_train_acc: 0.9962835906232133
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.5
Land_on_Water_val_acc: 0.4313304721030043
Water_on_Land_train_acc: 0.10714285714285714
Water_on_Land_val_acc: 0.07518796992481203
Water_on_Water_train_acc: 0.9167455061494797
Water_on_Water_val_acc: 0.9097744360902256
train_abn_cls_loss: 0.650225597377614
train_abn_att_clip_vit_loss: 0.06145956393746937
train_acc_Landbird: 0.9714828897338403
train_acc_Waterbird: 0.876010781671159
val_acc_Landbird: 0.7116827438370846
val_acc_Waterbird: 0.4924812030075188
TRAIN ACC:        0.9493222106360792
VAL ACC:          0.6630525437864887
BALANCED VAL ACC: 0.6020819734223017
prev best list: ['best_balanced_valacc_0.6_epoch_47.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.6_epoch_48.ckpt
EPOCH: 49

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.99it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.01it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  4.02it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.02it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.05it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.03it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.01it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.01it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.04it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.05it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.06it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.06it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.06it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.05it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  4.00it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.14it/s]
100%|██████████| 13/13 [00:03<00:00,  6.38it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9503649635036496
val_acc: 0.6738949124270225
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1448833561043048
val_cls_loss: 0.6647290710710902
train_total_loss: 0.8547815413867843
val_total_loss: 0.6647290710710902
test_abn_acc: 0
balanced_train_acc: 0.9259930171939642
balanced_val_acc: 0.6090487472701045
Land_on_Land_train_acc: 0.9974271012006861
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.4782608695652174
Land_on_Water_val_acc: 0.4592274678111588
Water_on_Land_train_acc: 0.10714285714285714
Water_on_Land_val_acc: 0.07518796992481203
Water_on_Water_train_acc: 0.9214758751182592
Water_on_Water_val_acc: 0.9097744360902256
train_abn_cls_loss: 0.6484215803638613
train_abn_att_clip_vit_loss: 0.06147660333294192
train_acc_Landbird: 0.9714828897338403
train_acc_Waterbird: 0.8805031446540881
val_acc_Landbird: 0.7256162915326902
val_acc_Waterbird: 0.4924812030075188
TRAIN ACC:        0.9503649635036496
VAL ACC:          0.6738949124270225
BALANCED VAL ACC: 0.6090487472701045
prev best list: ['best_balanced_valacc_0.6_epoch_48.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.61_epoch_49.ckpt
EPOCH: 50

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.41s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.54it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.91it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.02it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.01it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.04it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.04it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.97it/s]
100%|██████████| 50/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.42it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.01it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.15it/s]
100%|██████████| 13/13 [00:03<00:00,  6.42it/s]
100%|██████████| 13/13 [00:03<00:00,  4.17it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9505735140771637
val_acc: 0.6722268557130943
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.14386036417780132
val_cls_loss: 0.6607033925269225
train_total_loss: 0.8522887322154359
val_total_loss: 0.6607033925269225
test_abn_acc: 0
balanced_train_acc: 0.9245616102815328
balanced_val_acc: 0.6093207294764242
Land_on_Land_train_acc: 0.9968553459119497
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.5217391304347826
Land_on_Water_val_acc: 0.45278969957081544
Water_on_Land_train_acc: 0.10714285714285714
Water_on_Land_val_acc: 0.07518796992481203
Water_on_Water_train_acc: 0.9167455061494797
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6469336993502874
train_abn_att_clip_vit_loss: 0.061494668723085004
train_acc_Landbird: 0.9731124388919066
train_acc_Waterbird: 0.876010781671159
val_acc_Landbird: 0.722400857449089
val_acc_Waterbird: 0.49624060150375937
TRAIN ACC:        0.9505735140771637
VAL ACC:          0.6722268557130943
BALANCED VAL ACC: 0.6093207294764242
prev best list: ['best_balanced_valacc_0.61_epoch_49.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.61_epoch_50.ckpt
EPOCH: 51

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.00it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.01it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.01it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.33it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.01it/s]
100%|██████████| 13/13 [00:03<00:00,  6.31it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9526590198123045
val_acc: 0.6697247706422018
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.13952045682293282
val_cls_loss: 0.66522832086824
train_total_loss: 0.8464866110505351
val_total_loss: 0.66522832086824
test_abn_acc: 0
balanced_train_acc: 0.9293674137995825
balanced_val_acc: 0.6117443931371838
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.4945652173913043
Land_on_Water_val_acc: 0.43991416309012876
Water_on_Land_train_acc: 0.10714285714285714
Water_on_Land_val_acc: 0.08270676691729323
Water_on_Water_train_acc: 0.9271523178807947
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6453646678248337
train_abn_att_clip_vit_loss: 0.06160148334484528
train_acc_Landbird: 0.9728408473655622
train_acc_Waterbird: 0.8858939802336029
val_acc_Landbird: 0.7159699892818864
val_acc_Waterbird: 0.5075187969924813
TRAIN ACC:        0.9526590198123045
VAL ACC:          0.6697247706422018
BALANCED VAL ACC: 0.6117443931371838
prev best list: ['best_balanced_valacc_0.61_epoch_50.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.61_epoch_51.ckpt
EPOCH: 52

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.27it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.49it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.96it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.99it/s]
 30%|███       | 15/50 [00:04<00:08,  3.99it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.95it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.34it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.69it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9518248175182482
val_acc: 0.6680567139282736
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.13906502503827914
val_cls_loss: 0.6708637365358288
train_total_loss: 0.8448796125845566
val_total_loss: 0.6708637365358288
test_abn_acc: 0
balanced_train_acc: 0.9269435875361696
balanced_val_acc: 0.6160477560460638
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.5054347826086957
Land_on_Water_val_acc: 0.4291845493562232
Water_on_Land_train_acc: 0.10714285714285714
Water_on_Land_val_acc: 0.11278195488721804
Water_on_Water_train_acc: 0.9214758751182592
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6441612135506273
train_abn_att_clip_vit_loss: 0.06165337250398023
train_acc_Landbird: 0.973384030418251
train_acc_Waterbird: 0.8805031446540881
val_acc_Landbird: 0.7095391211146839
val_acc_Waterbird: 0.5225563909774437
TRAIN ACC:        0.9518248175182482
VAL ACC:          0.6680567139282736
BALANCED VAL ACC: 0.6160477560460638
prev best list: ['best_balanced_valacc_0.61_epoch_51.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.62_epoch_52.ckpt
EPOCH: 53

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.87it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.99it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.06it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.05it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.03it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.03it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.01it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.11it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.13it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.03it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.96it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.94it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.94it/s]
100%|██████████| 50/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.38it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.13it/s]
100%|██████████| 13/13 [00:03<00:00,  6.17it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.95140771637122
val_acc: 0.6797331109257715
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1361621609289778
val_cls_loss: 0.6454108592318534
train_total_loss: 0.8419947260487689
val_total_loss: 0.6454108592318534
test_abn_acc: 0
balanced_train_acc: 0.9260451149395836
balanced_val_acc: 0.6154876741693462
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.5108695652173914
Land_on_Water_val_acc: 0.4699570815450644
Water_on_Land_train_acc: 0.125
Water_on_Land_val_acc: 0.07518796992481203
Water_on_Water_train_acc: 0.9186376537369915
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6441801457260895
train_abn_att_clip_vit_loss: 0.06165242152554648
train_acc_Landbird: 0.973384030418251
train_acc_Waterbird: 0.8787061994609164
val_acc_Landbird: 0.7309753483386924
val_acc_Waterbird: 0.5
TRAIN ACC:        0.95140771637122
VAL ACC:          0.6797331109257715
BALANCED VAL ACC: 0.6154876741693462
EPOCH: 54

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.94it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.24it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.74it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.94it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.92it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.91it/s]
 40%|████      | 20/50 [00:06<00:07,  3.92it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.93it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.90it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.91it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.92it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.91it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.91it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.92it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.94it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.93it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.92it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.93it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.94it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.02it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.05it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.97it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.97it/s]
100%|██████████| 50/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.32it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9555787278415016
val_acc: 0.6889074228523769
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.13307455034151563
val_cls_loss: 0.6360489231681108
train_total_loss: 0.8368845458199756
val_total_loss: 0.6360489231681108
test_abn_acc: 0
balanced_train_acc: 0.9328357571595967
balanced_val_acc: 0.6200388430884285
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.5434782608695652
Land_on_Water_val_acc: 0.49356223175965663
Water_on_Land_train_acc: 0.10714285714285714
Water_on_Land_val_acc: 0.07518796992481203
Water_on_Water_train_acc: 0.9318826868495743
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6420812376597129
train_abn_att_clip_vit_loss: 0.06172875331965303
train_acc_Landbird: 0.9752851711026616
train_acc_Waterbird: 0.8903863432165319
val_acc_Landbird: 0.7438370846730975
val_acc_Waterbird: 0.49624060150375937
TRAIN ACC:        0.9555787278415016
VAL ACC:          0.6889074228523769
BALANCED VAL ACC: 0.6200388430884285
prev best list: ['best_balanced_valacc_0.62_epoch_52.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.62_epoch_54.ckpt
EPOCH: 55

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.93it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.43it/s]
 10%|█         | 5/50 [00:02<00:16,  2.81it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.11it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.32it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.49it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.61it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.94it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.98it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.01it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.11it/s]
 40%|████      | 20/50 [00:06<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.14it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.13it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.13it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.11it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.14it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.76it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.90it/s]
100%|██████████| 13/13 [00:03<00:00,  6.15it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9562043795620438
val_acc: 0.6780650542118432
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.13040290878264077
val_cls_loss: 0.6535691874438867
train_total_loss: 0.8328703415779177
val_total_loss: 0.6535691874438867
test_abn_acc: 0
balanced_train_acc: 0.9344969065895962
balanced_val_acc: 0.6224786242132663
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.5380434782608695
Land_on_Water_val_acc: 0.45493562231759654
Water_on_Land_train_acc: 0.125
Water_on_Land_val_acc: 0.11278195488721804
Water_on_Water_train_acc: 0.934720908230842
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6406544053890161
train_abn_att_clip_vit_loss: 0.06181302568695592
train_acc_Landbird: 0.9750135795763172
train_acc_Waterbird: 0.8939802336028752
val_acc_Landbird: 0.722400857449089
val_acc_Waterbird: 0.5225563909774437
TRAIN ACC:        0.9562043795620438
VAL ACC:          0.6780650542118432
BALANCED VAL ACC: 0.6224786242132663
prev best list: ['best_balanced_valacc_0.62_epoch_54.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.62_epoch_55.ckpt
EPOCH: 56

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.85it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.99it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.03it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.05it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.03it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.01it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.03it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.06it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.05it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.06it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.03it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.02it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.06it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.79it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.88it/s]
100%|██████████| 13/13 [00:03<00:00,  6.23it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9551616266944735
val_acc: 0.6889074228523769
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.12965428031149695
val_cls_loss: 0.6393124887951221
train_total_loss: 0.8311227316403911
val_total_loss: 0.6393124887951221
test_abn_acc: 0
balanced_train_acc: 0.9313104034927695
balanced_val_acc: 0.6267578109260289
Land_on_Land_train_acc: 0.9971412235563178
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.5706521739130435
Land_on_Water_val_acc: 0.48497854077253216
Water_on_Land_train_acc: 0.125
Water_on_Land_val_acc: 0.10526315789473684
Water_on_Water_train_acc: 0.9271523178807947
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6396686234737711
train_abn_att_clip_vit_loss: 0.06179982283472145
train_acc_Landbird: 0.9758283541553504
train_acc_Waterbird: 0.8867924528301887
val_acc_Landbird: 0.7384780278670954
val_acc_Waterbird: 0.5150375939849624
TRAIN ACC:        0.9551616266944735
VAL ACC:          0.6889074228523769
BALANCED VAL ACC: 0.6267578109260289
prev best list: ['best_balanced_valacc_0.62_epoch_55.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.63_epoch_56.ckpt
EPOCH: 57

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.73it/s]
 20%|██        | 10/50 [00:03<00:10,  3.83it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.88it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.93it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.99it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.94it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.01it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.97it/s]
100%|██████████| 50/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.39it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.99it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.34it/s]
100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9562043795620438
val_acc: 0.69557964970809
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.12527019542188417
val_cls_loss: 0.633565615896785
train_total_loss: 0.8249449429472246
val_total_loss: 0.633565615896785
test_abn_acc: 0
balanced_train_acc: 0.9338700255193547
balanced_val_acc: 0.6337326435058708
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.5489130434782609
Land_on_Water_val_acc: 0.4978540772532189
Water_on_Land_train_acc: 0.17857142857142858
Water_on_Land_val_acc: 0.11278195488721804
Water_on_Water_train_acc: 0.9299905392620624
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6377849127130041
train_abn_att_clip_vit_loss: 0.0618898378073299
train_acc_Landbird: 0.9755567626290059
train_acc_Waterbird: 0.8921832884097035
val_acc_Landbird: 0.744908896034298
val_acc_Waterbird: 0.5225563909774437
TRAIN ACC:        0.9562043795620438
VAL ACC:          0.69557964970809
BALANCED VAL ACC: 0.6337326435058708
prev best list: ['best_balanced_valacc_0.63_epoch_56.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.63_epoch_57.ckpt
EPOCH: 58

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.92it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.90it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.94it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.38it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.28it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9578727841501564
val_acc: 0.6872393661384487
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.12417377345380495
val_cls_loss: 0.6472299499646935
train_total_loss: 0.8237399833667266
val_total_loss: 0.6472299499646935
test_abn_acc: 0
balanced_train_acc: 0.9358967132300944
balanced_val_acc: 0.635092554537469
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.5815217391304348
Land_on_Water_val_acc: 0.4678111587982833
Water_on_Land_train_acc: 0.14285714285714285
Water_on_Land_val_acc: 0.15037593984962405
Water_on_Water_train_acc: 0.934720908230842
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.637652833431928
train_abn_att_clip_vit_loss: 0.0619133770069626
train_acc_Landbird: 0.9769147202607279
train_acc_Waterbird: 0.894878706199461
val_acc_Landbird: 0.7288317256162915
val_acc_Waterbird: 0.5413533834586466
TRAIN ACC:        0.9578727841501564
VAL ACC:          0.6872393661384487
BALANCED VAL ACC: 0.635092554537469
prev best list: ['best_balanced_valacc_0.63_epoch_57.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.64_epoch_58.ckpt
EPOCH: 59

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.83it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.14it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.64it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.94it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.94it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.94it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.61it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.96it/s]
100%|██████████| 13/13 [00:03<00:00,  6.18it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.959332638164755
val_acc: 0.6880733944954128
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1205615992823905
val_cls_loss: 0.6445396982748574
train_total_loss: 0.8176628419331142
val_total_loss: 0.6445396982748574
test_abn_acc: 0
balanced_train_acc: 0.9368472835722997
balanced_val_acc: 0.6383160473531095
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.6032608695652174
Land_on_Water_val_acc: 0.4656652360515021
Water_on_Land_train_acc: 0.16071428571428573
Water_on_Land_val_acc: 0.16541353383458646
Water_on_Water_train_acc: 0.9337748344370861
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6352178754100462
train_abn_att_clip_vit_loss: 0.061883367189401385
train_acc_Landbird: 0.9788158609451385
train_acc_Waterbird: 0.894878706199461
val_acc_Landbird: 0.7277599142550911
val_acc_Waterbird: 0.5488721804511278
TRAIN ACC:        0.959332638164755
VAL ACC:          0.6880733944954128
BALANCED VAL ACC: 0.6383160473531095
prev best list: ['best_balanced_valacc_0.64_epoch_58.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.64_epoch_59.ckpt
EPOCH: 60

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.86it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.86it/s]
 30%|███       | 15/50 [00:04<00:08,  3.90it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.91it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.88it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.92it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.94it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.93it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.13it/s]
100%|██████████| 13/13 [00:03<00:00,  6.35it/s]
100%|██████████| 13/13 [00:03<00:00,  4.17it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.959541188738269
val_acc: 0.7097581317764804
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.12197816631716907
val_cls_loss: 0.615720340865567
train_total_loss: 0.8194725138178955
val_total_loss: 0.615720340865567
test_abn_acc: 0
balanced_train_acc: 0.9344755550545063
balanced_val_acc: 0.6455306272111145
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.6630434782608695
Land_on_Water_val_acc: 0.5278969957081545
Water_on_Land_train_acc: 0.17857142857142858
Water_on_Land_val_acc: 0.13533834586466165
Water_on_Water_train_acc: 0.9252601702932829
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6356359877725587
train_abn_att_clip_vit_loss: 0.0618583683091545
train_acc_Landbird: 0.981260184682238
train_acc_Waterbird: 0.8876909254267745
val_acc_Landbird: 0.7609860664523044
val_acc_Waterbird: 0.5300751879699248
TRAIN ACC:        0.959541188738269
VAL ACC:          0.7097581317764804
BALANCED VAL ACC: 0.6455306272111145
prev best list: ['best_balanced_valacc_0.64_epoch_59.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.65_epoch_60.ckpt
EPOCH: 61

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.35it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.94it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.43it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.98it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.01it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.08it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.13it/s]
 40%|████      | 20/50 [00:06<00:07,  4.16it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.12it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.12it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.12it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.12it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.12it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.13it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.13it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.12it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.13it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.13it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.04it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.05it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.95it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.02it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.01it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9622523461939521
val_acc: 0.6947456213511259
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.11767730809460715
val_cls_loss: 0.6385955782708175
train_total_loss: 0.8136280623292774
val_total_loss: 0.6385955782708175
test_abn_acc: 0
balanced_train_acc: 0.9400021863971932
balanced_val_acc: 0.6426032927979112
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.6684782608695652
Land_on_Water_val_acc: 0.48283261802575106
Water_on_Land_train_acc: 0.17857142857142858
Water_on_Land_val_acc: 0.16541353383458646
Water_on_Water_train_acc: 0.9366130558183539
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6339926574227708
train_abn_att_clip_vit_loss: 0.06195809458993274
train_acc_Landbird: 0.9815317762085823
train_acc_Waterbird: 0.8984725965858041
val_acc_Landbird: 0.7363344051446945
val_acc_Waterbird: 0.5488721804511278
TRAIN ACC:        0.9622523461939521
VAL ACC:          0.6947456213511259
BALANCED VAL ACC: 0.6426032927979112
EPOCH: 62

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.93it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.90it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.93it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.84it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.81it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.01it/s]
100%|██████████| 13/13 [00:03<00:00,  6.13it/s]
100%|██████████| 13/13 [00:03<00:00,  3.96it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9582898852971846
val_acc: 0.7064220183486238
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.11549607403459837
val_cls_loss: 0.6251523508142689
train_total_loss: 0.8097158646807308
val_total_loss: 0.6251523508142689
test_abn_acc: 0
balanced_train_acc: 0.935854864221318
balanced_val_acc: 0.648762178758794
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.5978260869565217
Land_on_Water_val_acc: 0.5128755364806867
Water_on_Land_train_acc: 0.21428571428571427
Water_on_Land_val_acc: 0.16541353383458646
Water_on_Water_train_acc: 0.9299905392620624
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.632291817341905
train_abn_att_clip_vit_loss: 0.061927974120761356
train_acc_Landbird: 0.977729494839761
train_acc_Waterbird: 0.8939802336028752
val_acc_Landbird: 0.752411575562701
val_acc_Waterbird: 0.5451127819548872
TRAIN ACC:        0.9582898852971846
VAL ACC:          0.7064220183486238
BALANCED VAL ACC: 0.648762178758794
prev best list: ['best_balanced_valacc_0.65_epoch_60.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.65_epoch_62.ckpt
EPOCH: 63

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.44s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.95it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.95it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.97it/s]
 30%|███       | 15/50 [00:04<00:08,  3.99it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.02it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.13it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.05it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.03it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.92it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.94it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.95it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.96it/s]
100%|██████████| 50/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.78it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.43it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.53it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.96it/s]
100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9616266944734098
val_acc: 0.6989157631359466
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.11462495980222978
val_cls_loss: 0.633745544149639
train_total_loss: 0.8080004249300275
val_total_loss: 0.633745544149639
test_abn_acc: 0
balanced_train_acc: 0.9386544775023145
balanced_val_acc: 0.6439390276333922
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.6684782608695652
Land_on_Water_val_acc: 0.49356223175965663
Water_on_Land_train_acc: 0.16071428571428573
Water_on_Land_val_acc: 0.16541353383458646
Water_on_Water_train_acc: 0.934720908230842
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6314169207007096
train_abn_att_clip_vit_loss: 0.06195854077249672
train_acc_Landbird: 0.9815317762085823
train_acc_Waterbird: 0.8957771787960467
val_acc_Landbird: 0.7427652733118971
val_acc_Waterbird: 0.5451127819548872
TRAIN ACC:        0.9616266944734098
VAL ACC:          0.6989157631359466
BALANCED VAL ACC: 0.6439390276333922
EPOCH: 64

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.89it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.79it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.42it/s]
100%|██████████| 13/13 [00:03<00:00,  4.19it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9637122002085505
val_acc: 0.7080900750625522
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.11016790676974654
val_cls_loss: 0.6170417678366114
train_total_loss: 0.8023274277497133
val_total_loss: 0.6170417678366114
test_abn_acc: 0
balanced_train_acc: 0.9422065188798814
balanced_val_acc: 0.6484901965524744
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.6902173913043478
Land_on_Water_val_acc: 0.51931330472103
Water_on_Land_train_acc: 0.16071428571428573
Water_on_Land_val_acc: 0.16541353383458646
Water_on_Water_train_acc: 0.9413434247871334
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6302420700304948
train_abn_att_clip_vit_loss: 0.061917453626708766
train_acc_Landbird: 0.9823465507876155
train_acc_Waterbird: 0.9020664869721473
val_acc_Landbird: 0.7556270096463023
val_acc_Waterbird: 0.5413533834586466
TRAIN ACC:        0.9637122002085505
VAL ACC:          0.7080900750625522
BALANCED VAL ACC: 0.6484901965524744
EPOCH: 65

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.04it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.03it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.93it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.95it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.94it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.95it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.97it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.10s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.85it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.10it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.45it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.02it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.23it/s]
100%|██████████| 13/13 [00:02<00:00,  6.34it/s]
100%|██████████| 13/13 [00:03<00:00,  4.24it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9643378519290928
val_acc: 0.7147623019182652
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.10737906239763664
val_cls_loss: 0.6090025677096357
train_total_loss: 0.7985896580037782
val_total_loss: 0.6090025677096357
test_abn_acc: 0
balanced_train_acc: 0.9435542277747602
balanced_val_acc: 0.652777441997276
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.6847826086956522
Land_on_Water_val_acc: 0.5364806866952789
Water_on_Land_train_acc: 0.19642857142857142
Water_on_Land_val_acc: 0.16541353383458646
Water_on_Water_train_acc: 0.9422894985808893
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6292853139364185
train_abn_att_clip_vit_loss: 0.061925282148300544
train_acc_Landbird: 0.9823465507876155
train_acc_Waterbird: 0.9047619047619048
val_acc_Landbird: 0.7642015005359056
val_acc_Waterbird: 0.5413533834586466
TRAIN ACC:        0.9643378519290928
VAL ACC:          0.7147623019182652
BALANCED VAL ACC: 0.652777441997276
prev best list: ['best_balanced_valacc_0.65_epoch_62.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.65_epoch_65.ckpt
EPOCH: 66

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.88it/s]
 30%|███       | 15/50 [00:04<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.32it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.95it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.12it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9680917622523462
val_acc: 0.7064220183486238
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.10460541174670329
val_cls_loss: 0.6201010417749327
train_total_loss: 0.7939807017229894
val_total_loss: 0.6201010417749327
test_abn_acc: 0
balanced_train_acc: 0.9494463973981873
balanced_val_acc: 0.6514497658938343
Land_on_Land_train_acc: 0.9982847341337907
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.717391304347826
Land_on_Water_val_acc: 0.5107296137339056
Water_on_Land_train_acc: 0.2857142857142857
Water_on_Land_val_acc: 0.18045112781954886
Water_on_Water_train_acc: 0.9479659413434248
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6274389092691002
train_abn_att_clip_vit_loss: 0.06193638512315044
train_acc_Landbird: 0.9842476914720261
train_acc_Waterbird: 0.9146451033243486
val_acc_Landbird: 0.7502679528403001
val_acc_Waterbird: 0.5526315789473685
TRAIN ACC:        0.9680917622523462
VAL ACC:          0.7064220183486238
BALANCED VAL ACC: 0.6514497658938343
EPOCH: 67

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.03it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.08it/s]
 30%|███       | 15/50 [00:04<00:08,  4.09it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.13it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.11it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.10it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.10it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.95it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.32it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.11it/s]
100%|██████████| 13/13 [00:03<00:00,  6.03it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9662148070907195
val_acc: 0.7139282735613011
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.10403232630711277
val_cls_loss: 0.6080787484351549
train_total_loss: 0.7924759274851667
val_total_loss: 0.6080787484351549
test_abn_acc: 0
balanced_train_acc: 0.9460301517837926
balanced_val_acc: 0.654929123451716
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.717391304347826
Land_on_Water_val_acc: 0.5300429184549357
Water_on_Land_train_acc: 0.23214285714285715
Water_on_Land_val_acc: 0.17293233082706766
Water_on_Water_train_acc: 0.9441816461684012
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6265247192820369
train_abn_att_clip_vit_loss: 0.06191888076172631
train_acc_Landbird: 0.9837045084193373
train_acc_Waterbird: 0.9083557951482479
val_acc_Landbird: 0.7609860664523044
val_acc_Waterbird: 0.5488721804511278
TRAIN ACC:        0.9662148070907195
VAL ACC:          0.7139282735613011
BALANCED VAL ACC: 0.654929123451716
prev best list: ['best_balanced_valacc_0.65_epoch_65.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.65_epoch_67.ckpt
EPOCH: 68

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.64it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.74it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.80it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.85it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.87it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.99it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.01it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.05it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.05it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.02it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.03it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.03it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.04it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.06it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.07it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.06it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.07it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.07it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.03it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.06it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.08it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.32it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.02it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9660062565172054
val_acc: 0.7339449541284404
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.1028322539516609
val_cls_loss: 0.5857676747592914
train_total_loss: 0.790641256504934
val_total_loss: 0.5857676747592914
test_abn_acc: 0
balanced_train_acc: 0.9462077965557412
balanced_val_acc: 0.665103272651081
Land_on_Land_train_acc: 0.9974271012006861
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.7119565217391305
Land_on_Water_val_acc: 0.5836909871244635
Water_on_Land_train_acc: 0.25
Water_on_Land_val_acc: 0.16541353383458646
Water_on_Water_train_acc: 0.9441816461684012
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6259329704969842
train_abn_att_clip_vit_loss: 0.061876032959059954
train_acc_Landbird: 0.9831613253666486
train_acc_Waterbird: 0.9092542677448338
val_acc_Landbird: 0.7888531618435155
val_acc_Waterbird: 0.5413533834586466
TRAIN ACC:        0.9660062565172054
VAL ACC:          0.7339449541284404
BALANCED VAL ACC: 0.665103272651081
prev best list: ['best_balanced_valacc_0.65_epoch_67.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.67_epoch_68.ckpt
EPOCH: 69

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.88it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.94it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.96it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.99it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:08,  4.00it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.92it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.21it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.59it/s]
100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9630865484880083
val_acc: 0.7222685571309424
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.10374989082125852
val_cls_loss: 0.5941297616483372
train_total_loss: 0.7919994939355581
val_total_loss: 0.5941297616483372
test_abn_acc: 0
balanced_train_acc: 0.9386647262391576
balanced_val_acc: 0.6589443866901982
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.7228260869565217
Land_on_Water_val_acc: 0.555793991416309
Water_on_Land_train_acc: 0.19642857142857142
Water_on_Land_val_acc: 0.17293233082706766
Water_on_Water_train_acc: 0.9299905392620624
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6264230738591103
train_abn_att_clip_vit_loss: 0.0618265323760425
train_acc_Landbird: 0.9842476914720261
train_acc_Waterbird: 0.8930817610062893
val_acc_Landbird: 0.7727759914255091
val_acc_Waterbird: 0.5451127819548872
TRAIN ACC:        0.9630865484880083
VAL ACC:          0.7222685571309424
BALANCED VAL ACC: 0.6589443866901982
EPOCH: 70

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.47it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.87it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.92it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.03it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.08it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.08it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.06it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.12it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.02it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.04it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.05it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.06it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.05it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.18it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.28it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9672575599582899
val_acc: 0.7264386989157632
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.09831755358465522
val_cls_loss: 0.5925736606518759
train_total_loss: 0.7838412921918445
val_total_loss: 0.5925736606518759
test_abn_acc: 0
balanced_train_acc: 0.9467091305996536
balanced_val_acc: 0.6643115022282394
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.7445652173913043
Land_on_Water_val_acc: 0.5600858369098712
Water_on_Land_train_acc: 0.23214285714285715
Water_on_Land_val_acc: 0.18045112781954886
Water_on_Water_train_acc: 0.9441816461684012
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6237012319942709
train_abn_att_clip_vit_loss: 0.06182251034986239
train_acc_Landbird: 0.9850624660510592
train_acc_Waterbird: 0.9083557951482479
val_acc_Landbird: 0.7759914255091104
val_acc_Waterbird: 0.5526315789473685
TRAIN ACC:        0.9672575599582899
VAL ACC:          0.7264386989157632
BALANCED VAL ACC: 0.6643115022282394
EPOCH: 71

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  4.00it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.99it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.99it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.03it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.03it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.01it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.05it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.04it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.06it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.04it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.03it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.88it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.19it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.65it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.78it/s]
100%|██████████| 13/13 [00:03<00:00,  5.97it/s]
100%|██████████| 13/13 [00:03<00:00,  3.96it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9687174139728885
val_acc: 0.737281067556297
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.09712551200725487
val_cls_loss: 0.5840553837184412
train_total_loss: 0.7827613900550587
val_total_loss: 0.5840553837184412
test_abn_acc: 0
balanced_train_acc: 0.9479731414769796
balanced_val_acc: 0.668590688941002
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.7717391304347826
Land_on_Water_val_acc: 0.5901287553648069
Water_on_Land_train_acc: 0.25
Water_on_Land_val_acc: 0.17293233082706766
Water_on_Water_train_acc: 0.9441816461684012
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6238623732570812
train_abn_att_clip_vit_loss: 0.061773506215578325
train_acc_Landbird: 0.9866920152091255
train_acc_Waterbird: 0.9092542677448338
val_acc_Landbird: 0.7920685959271169
val_acc_Waterbird: 0.5451127819548872
TRAIN ACC:        0.9687174139728885
VAL ACC:          0.737281067556297
BALANCED VAL ACC: 0.668590688941002
prev best list: ['best_balanced_valacc_0.67_epoch_68.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.67_epoch_71.ckpt
EPOCH: 72

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:17,  2.53it/s]
 12%|█▏        | 6/50 [00:02<00:15,  2.89it/s]
 14%|█▍        | 7/50 [00:02<00:13,  3.18it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.41it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.59it/s]
 20%|██        | 10/50 [00:03<00:10,  3.68it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.77it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.81it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.81it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.85it/s]
 30%|███       | 15/50 [00:05<00:08,  3.90it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.89it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.91it/s]
 38%|███▊      | 19/50 [00:06<00:07,  3.91it/s]
 40%|████      | 20/50 [00:06<00:07,  3.93it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.93it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:07<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:08<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:10<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.94it/s]
 78%|███████▊  | 39/50 [00:11<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:13<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.59it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.87it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.20it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.53it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.62it/s]
100%|██████████| 13/13 [00:03<00:00,  5.86it/s]
100%|██████████| 13/13 [00:03<00:00,  3.89it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9689259645464025
val_acc: 0.7406171809841534
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.09619438981363497
val_cls_loss: 0.5770255149255901
train_total_loss: 0.78121589849838
val_total_loss: 0.5770255149255901
test_abn_acc: 0
balanced_train_acc: 0.9503030209859968
balanced_val_acc: 0.672078105230923
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.7445652173913043
Land_on_Water_val_acc: 0.5965665236051502
Water_on_Land_train_acc: 0.2857142857142857
Water_on_Land_val_acc: 0.18045112781954886
Water_on_Water_train_acc: 0.9489120151371807
Water_on_Water_val_acc: 0.9172932330827067
train_abn_cls_loss: 0.6233053761801456
train_abn_att_clip_vit_loss: 0.06171613029040186
train_acc_Landbird: 0.9850624660510592
train_acc_Waterbird: 0.9155435759209344
val_acc_Landbird: 0.7952840300107181
val_acc_Waterbird: 0.5488721804511278
TRAIN ACC:        0.9689259645464025
VAL ACC:          0.7406171809841534
BALANCED VAL ACC: 0.672078105230923
prev best list: ['best_balanced_valacc_0.67_epoch_71.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.67_epoch_72.ckpt
EPOCH: 73

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.04it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.06it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.02it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.02it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.95it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.95it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.93it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.23it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.79it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.91it/s]
100%|██████████| 13/13 [00:03<00:00,  6.16it/s]
100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9683003128258603
val_acc: 0.7281067556296914
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.09516653285844483
val_cls_loss: 0.5931709029457786
train_total_loss: 0.7787112897205651
val_total_loss: 0.5931709029457786
test_abn_acc: 0
balanced_train_acc: 0.948014990485756
balanced_val_acc: 0.6721022814270403
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.7391304347826086
Land_on_Water_val_acc: 0.5536480686695279
Water_on_Land_train_acc: 0.19642857142857142
Water_on_Land_val_acc: 0.21052631578947367
Water_on_Water_train_acc: 0.9479659413434248
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6218550711031129
train_abn_att_clip_vit_loss: 0.06168968813402561
train_acc_Landbird: 0.9858772406300923
train_acc_Waterbird: 0.9101527403414196
val_acc_Landbird: 0.7727759914255091
val_acc_Waterbird: 0.5714285714285714
TRAIN ACC:        0.9683003128258603
VAL ACC:          0.7281067556296914
BALANCED VAL ACC: 0.6721022814270403
prev best list: ['best_balanced_valacc_0.67_epoch_72.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.67_epoch_73.ckpt
EPOCH: 74

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.22it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.95it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.95it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.96it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.97it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.79it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.13it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.48it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.64it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.74it/s]
100%|██████████| 13/13 [00:03<00:00,  5.93it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.970385818561001
val_acc: 0.7364470391993327
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.0938210674477071
val_cls_loss: 0.5789934711669066
train_total_loss: 0.7770199068519942
val_total_loss: 0.5789934711669066
test_abn_acc: 0
balanced_train_acc: 0.9521939129335643
balanced_val_acc: 0.6734299575304821
Land_on_Land_train_acc: 0.9971412235563178
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.7771739130434783
Land_on_Water_val_acc: 0.5793991416309013
Water_on_Land_train_acc: 0.23214285714285715
Water_on_Land_val_acc: 0.19548872180451127
Water_on_Water_train_acc: 0.9545884578997161
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6215428960335765
train_abn_att_clip_vit_loss: 0.06165594435194983
train_acc_Landbird: 0.9861488321564367
train_acc_Waterbird: 0.9182389937106918
val_acc_Landbird: 0.7867095391211146
val_acc_Waterbird: 0.5601503759398496
TRAIN ACC:        0.970385818561001
VAL ACC:          0.7364470391993327
BALANCED VAL ACC: 0.6734299575304821
prev best list: ['best_balanced_valacc_0.67_epoch_73.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.67_epoch_74.ckpt
EPOCH: 75

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:12,  1.48s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.32it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.91it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.41it/s]
 10%|█         | 5/50 [00:02<00:16,  2.78it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.09it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.35it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.53it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.63it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:05<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.91it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:06<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:07<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:08<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:10<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.91it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:11<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.93it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.94it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:13<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  3.59it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:15,  1.26s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.54it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.94it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.27it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.99it/s]
100%|██████████| 13/13 [00:03<00:00,  6.22it/s]
100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9716371220020855
val_acc: 0.7472894078398665
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.09100332541218391
val_cls_loss: 0.5635221397707719
train_total_loss: 0.7728115044122443
val_total_loss: 0.5635221397707719
test_abn_acc: 0
balanced_train_acc: 0.9523818064423559
balanced_val_acc: 0.6803967313782849
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.7934782608695652
Land_on_Water_val_acc: 0.6072961373390557
Water_on_Land_train_acc: 0.2857142857142857
Water_on_Land_val_acc: 0.19548872180451127
Water_on_Water_train_acc: 0.9498580889309366
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6201931673617755
train_abn_att_clip_vit_loss: 0.06161501108512391
train_acc_Landbird: 0.9883215643671918
train_acc_Waterbird: 0.9164420485175202
val_acc_Landbird: 0.8006430868167203
val_acc_Waterbird: 0.5601503759398496
TRAIN ACC:        0.9716371220020855
VAL ACC:          0.7472894078398665
BALANCED VAL ACC: 0.6803967313782849
prev best list: ['best_balanced_valacc_0.67_epoch_74.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.68_epoch_75.ckpt
EPOCH: 76

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.47it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.73it/s]
 20%|██        | 10/50 [00:03<00:10,  3.80it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.98it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.99it/s]
 30%|███       | 15/50 [00:04<00:08,  4.02it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:08,  4.00it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.93it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.93it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.92it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.91it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.91it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.90it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.90it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.89it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.89it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.89it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.90it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.90it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.89it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.88it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.88it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.90it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.90it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.91it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.94it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.96it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.97it/s]
100%|██████████| 50/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  3.61it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.75it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.86it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.23it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.60it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.75it/s]
100%|██████████| 13/13 [00:03<00:00,  5.86it/s]
100%|██████████| 13/13 [00:03<00:00,  3.90it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9712200208550573
val_acc: 0.7364470391993327
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.08993364989881844
val_cls_loss: 0.5766447978381617
train_total_loss: 0.7710178215013928
val_total_loss: 0.5766447978381617
test_abn_acc: 0
balanced_train_acc: 0.9536774175916152
balanced_val_acc: 0.6761175446655223
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.7663043478260869
Land_on_Water_val_acc: 0.5772532188841202
Water_on_Land_train_acc: 0.32142857142857145
Water_on_Land_val_acc: 0.21052631578947367
Water_on_Water_train_acc: 0.9526963103122044
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6195265733412583
train_abn_att_clip_vit_loss: 0.061557602253863905
train_acc_Landbird: 0.986420423682781
train_acc_Waterbird: 0.9209344115004492
val_acc_Landbird: 0.7845659163987139
val_acc_Waterbird: 0.5676691729323309
TRAIN ACC:        0.9712200208550573
VAL ACC:          0.7364470391993327
BALANCED VAL ACC: 0.6761175446655223
EPOCH: 77

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.94it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.28it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.52it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.78it/s]
 20%|██        | 10/50 [00:03<00:10,  3.90it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.97it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.07it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.07it/s]
 40%|████      | 20/50 [00:05<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.05it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.06it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.07it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.06it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.05it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.05it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.04it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.07it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.24s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.61it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.86it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.19it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.70it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.89it/s]
100%|██████████| 13/13 [00:03<00:00,  6.00it/s]
100%|██████████| 13/13 [00:03<00:00,  3.90it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9710114702815432
val_acc: 0.755629691409508
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.09069390842794005
val_cls_loss: 0.5511157536899377
train_total_loss: 0.7721539385748855
val_total_loss: 0.5511157536899377
test_abn_acc: 0
balanced_train_acc: 0.9516609786177187
balanced_val_acc: 0.6857557881842871
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9957173447537473
Land_on_Water_train_acc: 0.7771739130434783
Land_on_Water_val_acc: 0.6266094420600858
Water_on_Land_train_acc: 0.25
Water_on_Land_val_acc: 0.19548872180451127
Water_on_Water_train_acc: 0.9508041627246925
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.619957665295745
train_abn_att_clip_vit_loss: 0.06150236078096132
train_acc_Landbird: 0.987778381314503
train_acc_Waterbird: 0.9155435759209344
val_acc_Landbird: 0.8113612004287245
val_acc_Waterbird: 0.5601503759398496
TRAIN ACC:        0.9710114702815432
VAL ACC:          0.755629691409508
BALANCED VAL ACC: 0.6857557881842871
prev best list: ['best_balanced_valacc_0.68_epoch_75.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.69_epoch_77.ckpt
EPOCH: 78

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.64it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.73it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.81it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.82it/s]
 30%|███       | 15/50 [00:04<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.01it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.06it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.07it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.05it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.03it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.04it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.05it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.06it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.06it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.04it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.04it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.06it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.06it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.99it/s]
100%|██████████| 13/13 [00:03<00:00,  6.19it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9743482794577685
val_acc: 0.7347789824854045
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.08365833069410512
val_cls_loss: 0.5898848963688571
train_total_loss: 0.7626906785900327
val_total_loss: 0.5898848963688571
test_abn_acc: 0
balanced_train_acc: 0.9585353188552844
balanced_val_acc: 0.6871398754120026
Land_on_Land_train_acc: 0.9982847341337907
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.7934782608695652
Land_on_Water_val_acc: 0.555793991416309
Water_on_Land_train_acc: 0.375
Water_on_Land_val_acc: 0.2706766917293233
Water_on_Water_train_acc: 0.9583727530747398
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6175571224612414
train_abn_att_clip_vit_loss: 0.06147522619217479
train_acc_Landbird: 0.9880499728408474
train_acc_Waterbird: 0.9290206648697215
val_acc_Landbird: 0.7727759914255091
val_acc_Waterbird: 0.6015037593984962
TRAIN ACC:        0.9743482794577685
VAL ACC:          0.7347789824854045
BALANCED VAL ACC: 0.6871398754120026
prev best list: ['best_balanced_valacc_0.69_epoch_77.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.69_epoch_78.ckpt
EPOCH: 79

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.47it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.94it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.03it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.06it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.04it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.06it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.07it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.06it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.08it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.08it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.05it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.06it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.05it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.06it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.98it/s]
100%|██████████| 13/13 [00:03<00:00,  6.00it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9737226277372263
val_acc: 0.7447873227689742
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.08401588085296878
val_cls_loss: 0.5643646656920057
train_total_loss: 0.7627838528815102
val_total_loss: 0.5643646656920057
test_abn_acc: 0
balanced_train_acc: 0.9556204072848021
balanced_val_acc: 0.6828203950390446
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.8152173913043478
Land_on_Water_val_acc: 0.5965665236051502
Water_on_Land_train_acc: 0.3392857142857143
Water_on_Land_val_acc: 0.21804511278195488
Water_on_Water_train_acc: 0.9526963103122044
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6173291107288118
train_abn_att_clip_vit_loss: 0.061438861636909134
train_acc_Landbird: 0.9894079304725693
train_acc_Waterbird: 0.921832884097035
val_acc_Landbird: 0.7942122186495176
val_acc_Waterbird: 0.5714285714285714
TRAIN ACC:        0.9737226277372263
VAL ACC:          0.7447873227689742
BALANCED VAL ACC: 0.6828203950390446
EPOCH: 80

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.13it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.34it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.51it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.59it/s]
 20%|██        | 10/50 [00:03<00:10,  3.70it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.93it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.96it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.96it/s]
 30%|███       | 15/50 [00:04<00:08,  4.01it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.03it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.03it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.06it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.05it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.07it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.06it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.05it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.05it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.06it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.06it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.08it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.08it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.04it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.04it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.06it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.08it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.93it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.27it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  6.24it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.97288842544317
val_acc: 0.7406171809841534
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.08176885080971484
val_cls_loss: 0.5770095579319939
train_total_loss: 0.7596301903689865
val_total_loss: 0.5770095579319939
test_abn_acc: 0
balanced_train_acc: 0.9557041053023548
balanced_val_acc: 0.6908912151762041
Land_on_Land_train_acc: 0.9982847341337907
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.7880434782608695
Land_on_Water_val_acc: 0.5708154506437768
Water_on_Land_train_acc: 0.2857142857142857
Water_on_Land_val_acc: 0.2706766917293233
Water_on_Water_train_acc: 0.9574266792809839
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6164620429930026
train_abn_att_clip_vit_loss: 0.061399289013913075
train_acc_Landbird: 0.987778381314503
train_acc_Waterbird: 0.9236298292902066
val_acc_Landbird: 0.7802786709539121
val_acc_Waterbird: 0.6015037593984962
TRAIN ACC:        0.97288842544317
VAL ACC:          0.7406171809841534
BALANCED VAL ACC: 0.6908912151762041
prev best list: ['best_balanced_valacc_0.69_epoch_78.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.69_epoch_80.ckpt
EPOCH: 81

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.63it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.92it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.93it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.01it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.30it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9749739311783108
val_acc: 0.7472894078398665
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.08023051250652179
val_cls_loss: 0.5717723636800195
train_total_loss: 0.7583957351907327
val_total_loss: 0.5717723636800195
test_abn_acc: 0
balanced_train_acc: 0.9592561466799217
balanced_val_acc: 0.6978660477560461
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.7989130434782609
Land_on_Water_val_acc: 0.5836909871244635
Water_on_Land_train_acc: 0.375
Water_on_Land_val_acc: 0.2857142857142857
Water_on_Water_train_acc: 0.9593188268684958
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6168130777426631
train_abn_att_clip_vit_loss: 0.06135214894574924
train_acc_Landbird: 0.9885931558935361
train_acc_Waterbird: 0.9299191374663073
val_acc_Landbird: 0.7867095391211146
val_acc_Waterbird: 0.6090225563909775
TRAIN ACC:        0.9749739311783108
VAL ACC:          0.7472894078398665
BALANCED VAL ACC: 0.6978660477560461
prev best list: ['best_balanced_valacc_0.69_epoch_80.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.7_epoch_81.ckpt
EPOCH: 82

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.41s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.47it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.05it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.11it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.13it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.13it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.13it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.05it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.14it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.14it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.14it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.64it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.33it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.03it/s]
100%|██████████| 13/13 [00:03<00:00,  6.18it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9724713242961418
val_acc: 0.7506255212677231
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.0798537476798199
val_cls_loss: 0.5647594267323774
train_total_loss: 0.7567649204365529
val_total_loss: 0.5647594267323774
test_abn_acc: 0
balanced_train_acc: 0.9519846678896826
balanced_val_acc: 0.7013534640459671
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.8315217391304348
Land_on_Water_val_acc: 0.5879828326180258
Water_on_Land_train_acc: 0.35714285714285715
Water_on_Land_val_acc: 0.2932330827067669
Water_on_Water_train_acc: 0.9432355723746452
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6156073638371059
train_abn_att_clip_vit_loss: 0.06130380864887342
train_acc_Landbird: 0.9902227050516024
train_acc_Waterbird: 0.9137466307277629
val_acc_Landbird: 0.789924973204716
val_acc_Waterbird: 0.6127819548872181
TRAIN ACC:        0.9724713242961418
VAL ACC:          0.7506255212677231
BALANCED VAL ACC: 0.7013534640459671
prev best list: ['best_balanced_valacc_0.7_epoch_81.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.7_epoch_82.ckpt
EPOCH: 83

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.71it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.84it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.86it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.85it/s]
 30%|███       | 15/50 [00:04<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.91it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.90it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.89it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.92it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.90it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.90it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.90it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.91it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.92it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.92it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.91it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.88it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.87it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.88it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  3.89it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.90it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.92it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.90it/s]
 70%|███████   | 35/50 [00:10<00:03,  3.93it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.03it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.04it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.04it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.04it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  3.61it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.98it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.19it/s]
100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9749739311783108
val_acc: 0.755629691409508
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.0786185651038685
val_cls_loss: 0.5570252331919825
train_total_loss: 0.7562115393788772
val_total_loss: 0.5570252331919825
test_abn_acc: 0
balanced_train_acc: 0.958942706144801
balanced_val_acc: 0.7032251045620482
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.8152173913043478
Land_on_Water_val_acc: 0.6030042918454935
Water_on_Land_train_acc: 0.42857142857142855
Water_on_Land_val_acc: 0.2857142857142857
Water_on_Water_train_acc: 0.9555345316934721
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6163339449665718
train_abn_att_clip_vit_loss: 0.061259032735393244
train_acc_Landbird: 0.9888647474198805
train_acc_Waterbird: 0.9290206648697215
val_acc_Landbird: 0.797427652733119
val_acc_Waterbird: 0.6090225563909775
TRAIN ACC:        0.9749739311783108
VAL ACC:          0.755629691409508
BALANCED VAL ACC: 0.7032251045620482
prev best list: ['best_balanced_valacc_0.7_epoch_82.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.7_epoch_83.ckpt
EPOCH: 84

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.41s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.50it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.69it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.97it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.95it/s]
 28%|██▊       | 14/50 [00:04<00:09,  4.00it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.06it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.07it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.02it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.93it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.92it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.90it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.90it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.90it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.89it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.88it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.88it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.89it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.89it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.87it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.86it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.87it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.86it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.87it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.88it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.87it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.87it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.89it/s]
100%|██████████| 50/50 [00:13<00:00,  3.91it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.64it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.03it/s]
100%|██████████| 13/13 [00:03<00:00,  6.16it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.975599582898853
val_acc: 0.7589658048373644
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07807719302795851
val_cls_loss: 0.5481929883696418
train_total_loss: 0.754783262972787
val_total_loss: 0.5481929883696418
test_abn_acc: 0
balanced_train_acc: 0.9590366528991968
balanced_val_acc: 0.704024933716929
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.8369565217391305
Land_on_Water_val_acc: 0.6137339055793991
Water_on_Land_train_acc: 0.39285714285714285
Water_on_Land_val_acc: 0.2781954887218045
Water_on_Water_train_acc: 0.956480605487228
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6155066869430422
train_abn_att_clip_vit_loss: 0.06119938835237521
train_acc_Landbird: 0.989951113525258
train_acc_Waterbird: 0.9281221922731356
val_acc_Landbird: 0.8027867095391211
val_acc_Waterbird: 0.6052631578947368
TRAIN ACC:        0.975599582898853
VAL ACC:          0.7589658048373644
BALANCED VAL ACC: 0.704024933716929
prev best list: ['best_balanced_valacc_0.7_epoch_83.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.7_epoch_84.ckpt
EPOCH: 85

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.99it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.99it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.77it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.38it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.36it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.76it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9760166840458812
val_acc: 0.7614678899082569
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07775282713742898
val_cls_loss: 0.5475265125963865
train_total_loss: 0.7540485528388038
val_total_loss: 0.5475265125963865
test_abn_acc: 0
balanced_train_acc: 0.9593082444255412
balanced_val_acc: 0.7042888571912096
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.8260869565217391
Land_on_Water_val_acc: 0.6201716738197425
Water_on_Land_train_acc: 0.4642857142857143
Water_on_Land_val_acc: 0.2706766917293233
Water_on_Water_train_acc: 0.9526963103122044
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6151402889874232
train_abn_att_clip_vit_loss: 0.06115543649797022
train_acc_Landbird: 0.9904942965779467
train_acc_Waterbird: 0.9281221922731356
val_acc_Landbird: 0.8070739549839229
val_acc_Waterbird: 0.6015037593984962
TRAIN ACC:        0.9760166840458812
VAL ACC:          0.7614678899082569
BALANCED VAL ACC: 0.7042888571912096
prev best list: ['best_balanced_valacc_0.7_epoch_84.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.7_epoch_85.ckpt
EPOCH: 86

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.52it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.60it/s]
 20%|██        | 10/50 [00:03<00:10,  3.69it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.76it/s]
 24%|██▍       | 12/50 [00:04<00:10,  3.79it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.79it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.83it/s]
 30%|███       | 15/50 [00:04<00:09,  3.85it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.86it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.84it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.86it/s]
 38%|███▊      | 19/50 [00:05<00:08,  3.86it/s]
 40%|████      | 20/50 [00:06<00:07,  3.86it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.86it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.86it/s]
 46%|████▌     | 23/50 [00:07<00:06,  3.87it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.87it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.87it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.87it/s]
 54%|█████▍    | 27/50 [00:08<00:05,  3.88it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.89it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.89it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.88it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  3.93it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.05it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.04it/s]
 70%|███████   | 35/50 [00:10<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:11<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.10it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.83it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.38it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.49it/s]
100%|██████████| 13/13 [00:03<00:00,  5.58it/s]
100%|██████████| 13/13 [00:03<00:00,  3.74it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9768508863399374
val_acc: 0.7597998331943286
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07518455452665422
val_cls_loss: 0.5465896826321329
train_total_loss: 0.750902077129909
val_total_loss: 0.5465896826321329
test_abn_acc: 0
balanced_train_acc: 0.9623589517591957
balanced_val_acc: 0.7072484265325694
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.8315217391304348
Land_on_Water_val_acc: 0.6115879828326181
Water_on_Land_train_acc: 0.39285714285714285
Water_on_Land_val_acc: 0.2932330827067669
Water_on_Water_train_acc: 0.9640491958372753
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6145792880197511
train_abn_att_clip_vit_loss: 0.061138235270293335
train_acc_Landbird: 0.9894079304725693
train_acc_Waterbird: 0.9353099730458221
val_acc_Landbird: 0.8017148981779206
val_acc_Waterbird: 0.6127819548872181
TRAIN ACC:        0.9768508863399374
VAL ACC:          0.7597998331943286
BALANCED VAL ACC: 0.7072484265325694
prev best list: ['best_balanced_valacc_0.7_epoch_85.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.71_epoch_86.ckpt
EPOCH: 87

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.71it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.77it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.88it/s]
 30%|███       | 15/50 [00:04<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.92it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.95it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.94it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.94it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.94it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.94it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.94it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.86it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.72it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.87it/s]
100%|██████████| 13/13 [00:03<00:00,  6.07it/s]
100%|██████████| 13/13 [00:03<00:00,  4.01it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9774765380604796
val_acc: 0.7564637197664721
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07235279052330879
val_cls_loss: 0.5562902606209682
train_total_loss: 0.746990992602765
val_total_loss: 0.5562902606209682
test_abn_acc: 0
balanced_train_acc: 0.9618260174433502
balanced_val_acc: 0.7104799780802489
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8315217391304348
Land_on_Water_val_acc: 0.5965665236051502
Water_on_Land_train_acc: 0.5
Water_on_Land_val_acc: 0.3233082706766917
Water_on_Water_train_acc: 0.9555345316934721
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6135426603716034
train_abn_att_clip_vit_loss: 0.06109554623025426
train_acc_Landbird: 0.9910374796306355
train_acc_Waterbird: 0.9326145552560647
val_acc_Landbird: 0.7931404072883173
val_acc_Waterbird: 0.6278195488721805
TRAIN ACC:        0.9774765380604796
VAL ACC:          0.7564637197664721
BALANCED VAL ACC: 0.7104799780802489
prev best list: ['best_balanced_valacc_0.71_epoch_86.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.71_epoch_87.ckpt
EPOCH: 88

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.87it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.00it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.03it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.23s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.60it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.93it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.26it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9789363920750782
val_acc: 0.7606338615512928
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07049886749064835
val_cls_loss: 0.5470508685750302
train_total_loss: 0.7448496990581747
val_total_loss: 0.5470508685750302
test_abn_acc: 0
balanced_train_acc: 0.9627765877855554
balanced_val_acc: 0.7104719193482097
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8695652173913043
Land_on_Water_val_acc: 0.6115879828326181
Water_on_Land_train_acc: 0.42857142857142855
Water_on_Land_val_acc: 0.3082706766917293
Water_on_Water_train_acc: 0.9593188268684958
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6132845231962154
train_abn_att_clip_vit_loss: 0.06106630994144893
train_acc_Landbird: 0.9929386203150462
train_acc_Waterbird: 0.9326145552560647
val_acc_Landbird: 0.8006430868167203
val_acc_Waterbird: 0.6203007518796992
TRAIN ACC:        0.9789363920750782
VAL ACC:          0.7606338615512928
BALANCED VAL ACC: 0.7104719193482097
EPOCH: 89

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.94it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.27it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.53it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.72it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.82it/s]
 20%|██        | 10/50 [00:03<00:10,  3.93it/s]
 22%|██▏       | 11/50 [00:03<00:09,  4.01it/s]
 24%|██▍       | 12/50 [00:03<00:09,  4.06it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.05it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.07it/s]
 30%|███       | 15/50 [00:04<00:08,  4.10it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.10it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.11it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.11it/s]
 40%|████      | 20/50 [00:05<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.07it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.07it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.73it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.23s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.61it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.89it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.21it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.46it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.59it/s]
100%|██████████| 13/13 [00:03<00:00,  5.62it/s]
100%|██████████| 13/13 [00:03<00:00,  3.81it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9760166840458812
val_acc: 0.7689741451209341
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07225885653986797
val_cls_loss: 0.5361072881282419
train_total_loss: 0.74669611325975
val_total_loss: 0.5361072881282419
test_abn_acc: 0
balanced_train_acc: 0.9605620065660241
balanced_val_acc: 0.7144871825866919
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.8152173913043478
Land_on_Water_val_acc: 0.6330472103004292
Water_on_Land_train_acc: 0.44642857142857145
Water_on_Land_val_acc: 0.3082706766917293
Water_on_Water_train_acc: 0.9574266792809839
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6134383414907922
train_abn_att_clip_vit_loss: 0.060998920724961256
train_acc_Landbird: 0.9894079304725693
train_acc_Waterbird: 0.9317160826594789
val_acc_Landbird: 0.812433011789925
val_acc_Waterbird: 0.6165413533834586
TRAIN ACC:        0.9760166840458812
VAL ACC:          0.7689741451209341
BALANCED VAL ACC: 0.7144871825866919
prev best list: ['best_balanced_valacc_0.71_epoch_87.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.71_epoch_89.ckpt
EPOCH: 90

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:11,  1.46s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.33it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.92it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.42it/s]
 10%|█         | 5/50 [00:02<00:15,  2.82it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.64it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.75it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.00it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.02it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.06it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.06it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.05it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.05it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.05it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.06it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.06it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.01it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  6.30it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.97851929092805
val_acc: 0.7831526271893244
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07215569603555021
val_cls_loss: 0.5160045043267838
train_total_loss: 0.7471446745338479
val_total_loss: 0.5160045043267838
test_abn_acc: 0
balanced_train_acc: 0.9628184367943318
balanced_val_acc: 0.7235975791568954
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9978586723768736
Land_on_Water_train_acc: 0.8695652173913043
Land_on_Water_val_acc: 0.6630901287553648
Water_on_Land_train_acc: 0.48214285714285715
Water_on_Land_val_acc: 0.3082706766917293
Water_on_Water_train_acc: 0.9574266792809839
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6140360928178455
train_abn_att_clip_vit_loss: 0.060952887980886994
train_acc_Landbird: 0.9921238457360131
train_acc_Waterbird: 0.9335130278526504
val_acc_Landbird: 0.8306538049303323
val_acc_Waterbird: 0.6165413533834586
TRAIN ACC:        0.97851929092805
VAL ACC:          0.7831526271893244
BALANCED VAL ACC: 0.7235975791568954
prev best list: ['best_balanced_valacc_0.71_epoch_89.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.72_epoch_90.ckpt
EPOCH: 91

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.85it/s]
 30%|███       | 15/50 [00:04<00:08,  3.90it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.90it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.93it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.90it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.93it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.94it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.93it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.03it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.03it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.01it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.22it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9766423357664233
val_acc: 0.7648040033361134
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.07214096882016367
val_cls_loss: 0.5417546326662721
train_total_loss: 0.7467744170935733
val_total_loss: 0.5417546326662721
test_abn_acc: 0
balanced_train_acc: 0.9600290722501785
balanced_val_acc: 0.7185266220212911
Land_on_Land_train_acc: 0.9982847341337907
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8532608695652174
Land_on_Water_val_acc: 0.6137339055793991
Water_on_Land_train_acc: 0.5357142857142857
Water_on_Land_val_acc: 0.3383458646616541
Water_on_Water_train_acc: 0.9498580889309366
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6137172102803856
train_abn_att_clip_vit_loss: 0.060916237612337464
train_acc_Landbird: 0.9910374796306355
train_acc_Waterbird: 0.9290206648697215
val_acc_Landbird: 0.8017148981779206
val_acc_Waterbird: 0.6353383458646616
TRAIN ACC:        0.9766423357664233
VAL ACC:          0.7648040033361134
BALANCED VAL ACC: 0.7185266220212911
EPOCH: 92

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.97it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.91it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.94it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.95it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.96it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.35it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9820646506777894
val_acc: 0.7723102585487907
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.06456853938021924
val_cls_loss: 0.5363085086987951
train_total_loss: 0.7368630064789272
val_total_loss: 0.5363085086987951
test_abn_acc: 0
balanced_train_acc: 0.9692016917248283
balanced_val_acc: 0.722005979579173
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8858695652173914
Land_on_Water_val_acc: 0.6351931330472103
Water_on_Land_train_acc: 0.48214285714285715
Water_on_Land_val_acc: 0.3383458646616541
Water_on_Water_train_acc: 0.9697256385998108
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6114014552954713
train_abn_att_clip_vit_loss: 0.06089301406016439
train_acc_Landbird: 0.9932102118413906
train_acc_Waterbird: 0.945193171608266
val_acc_Landbird: 0.812433011789925
val_acc_Waterbird: 0.631578947368421
TRAIN ACC:        0.9820646506777894
VAL ACC:          0.7723102585487907
BALANCED VAL ACC: 0.722005979579173
EPOCH: 93

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.89it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.95it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.77it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.02it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9787278415015641
val_acc: 0.7631359466221852
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.06662033835777526
val_cls_loss: 0.5517687419984021
train_total_loss: 0.7391148459923778
val_total_loss: 0.5517687419984021
test_abn_acc: 0
balanced_train_acc: 0.9642079946979868
balanced_val_acc: 0.7268613656327314
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8478260869565217
Land_on_Water_val_acc: 0.5944206008583691
Water_on_Land_train_acc: 0.44642857142857145
Water_on_Land_val_acc: 0.3684210526315789
Water_on_Water_train_acc: 0.9631031220435194
Water_on_Water_val_acc: 0.9548872180451128
train_abn_cls_loss: 0.6116438999663304
train_abn_att_clip_vit_loss: 0.06085061251231478
train_acc_Landbird: 0.9913090711569799
train_acc_Waterbird: 0.9371069182389937
val_acc_Landbird: 0.7920685959271169
val_acc_Waterbird: 0.6616541353383458
TRAIN ACC:        0.9787278415015641
VAL ACC:          0.7631359466221852
BALANCED VAL ACC: 0.7268613656327314
prev best list: ['best_balanced_valacc_0.72_epoch_90.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.73_epoch_93.ckpt
EPOCH: 94

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.49it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.69it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.80it/s]
 20%|██        | 10/50 [00:03<00:10,  3.87it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.02it/s]
 40%|████      | 20/50 [00:06<00:07,  4.04it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.03it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.03it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.04it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.04it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.05it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.05it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.06it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.06it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.07it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.07it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.04it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.89it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.23it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.84it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.99it/s]
100%|██████████| 13/13 [00:03<00:00,  6.29it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.981021897810219
val_acc: 0.7748123436196831
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.06827846951044637
val_cls_loss: 0.5303124186766953
train_total_loss: 0.7410472373644179
val_total_loss: 0.5303124186766953
test_abn_acc: 0
balanced_train_acc: 0.9694630345143294
balanced_val_acc: 0.7236136966209736
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8478260869565217
Land_on_Water_val_acc: 0.6416309012875536
Water_on_Land_train_acc: 0.5892857142857143
Water_on_Land_val_acc: 0.3383458646616541
Water_on_Water_train_acc: 0.9668874172185431
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6119620170657901
train_abn_att_clip_vit_loss: 0.060806748640798304
train_acc_Landbird: 0.9910374796306355
train_acc_Waterbird: 0.9478885893980233
val_acc_Landbird: 0.8156484458735263
val_acc_Waterbird: 0.631578947368421
TRAIN ACC:        0.981021897810219
VAL ACC:          0.7748123436196831
BALANCED VAL ACC: 0.7236136966209736
EPOCH: 95

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.52it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.63it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.83it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.91it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.93it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.94it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.94it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.38it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.88it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  5.95it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9818561001042753
val_acc: 0.7798165137614679
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.06375508294892386
val_cls_loss: 0.5285364778415673
train_total_loss: 0.7349666219682465
val_total_loss: 0.5285364778415673
test_abn_acc: 0
balanced_train_acc: 0.9684390148914146
balanced_val_acc: 0.728172924272095
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.8967391304347826
Land_on_Water_val_acc: 0.6502145922746781
Water_on_Land_train_acc: 0.5714285714285714
Water_on_Land_val_acc: 0.3458646616541353
Water_on_Water_train_acc: 0.9631031220435194
Water_on_Water_val_acc: 0.924812030075188
train_abn_cls_loss: 0.6104432373399904
train_abn_att_clip_vit_loss: 0.06076830545201416
train_acc_Landbird: 0.993481803367735
train_acc_Waterbird: 0.9433962264150944
val_acc_Landbird: 0.8210075026795284
val_acc_Waterbird: 0.6353383458646616
TRAIN ACC:        0.9818561001042753
VAL ACC:          0.7798165137614679
BALANCED VAL ACC: 0.728172924272095
prev best list: ['best_balanced_valacc_0.73_epoch_93.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.73_epoch_95.ckpt
EPOCH: 96

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.00it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.84it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.96it/s]
100%|██████████| 13/13 [00:03<00:00,  6.09it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9814389989572472
val_acc: 0.7673060884070059
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.060723143907669815
val_cls_loss: 0.5462349114117769
train_total_loss: 0.7315584681951465
val_total_loss: 0.5462349114117769
test_abn_acc: 0
balanced_train_acc: 0.9669136612245874
balanced_val_acc: 0.7281971004682124
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8913043478260869
Land_on_Water_val_acc: 0.6072961373390557
Water_on_Land_train_acc: 0.5178571428571429
Water_on_Land_val_acc: 0.3684210526315789
Water_on_Water_train_acc: 0.9621570482497634
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6100781415625086
train_abn_att_clip_vit_loss: 0.06075717961188402
train_acc_Landbird: 0.9940249864204237
train_acc_Waterbird: 0.9398023360287511
val_acc_Landbird: 0.7984994640943194
val_acc_Waterbird: 0.6578947368421053
TRAIN ACC:        0.9814389989572472
VAL ACC:          0.7673060884070059
BALANCED VAL ACC: 0.7281971004682124
prev best list: ['best_balanced_valacc_0.73_epoch_95.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.73_epoch_96.ckpt
EPOCH: 97

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:11,  1.46s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.33it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.92it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.42it/s]
 10%|█         | 5/50 [00:02<00:15,  2.81it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.09it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.32it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.49it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.61it/s]
 20%|██        | 10/50 [00:03<00:10,  3.69it/s]
 22%|██▏       | 11/50 [00:04<00:10,  3.71it/s]
 24%|██▍       | 12/50 [00:04<00:10,  3.78it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.79it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.82it/s]
 30%|███       | 15/50 [00:05<00:09,  3.85it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.87it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.87it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.87it/s]
 38%|███▊      | 19/50 [00:06<00:08,  3.87it/s]
 40%|████      | 20/50 [00:06<00:07,  3.89it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.89it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:07<00:06,  4.02it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:08<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.11it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.04it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.00it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  3.93it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.93it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.92it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.93it/s]
 94%|█████████▍| 47/50 [00:13<00:00,  3.94it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.94it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.93it/s]
100%|██████████| 50/50 [00:13<00:00,  3.97it/s]
100%|██████████| 50/50 [00:13<00:00,  3.59it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 46%|████▌     | 6/13 [00:02<00:01,  3.64it/s]
 62%|██████▏   | 8/13 [00:02<00:00,  5.22it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.76it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.18it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.76it/s]
100%|██████████| 13/13 [00:03<00:00,  4.00it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9806047966631908
val_acc: 0.7773144286905754
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.061878566025941786
val_cls_loss: 0.5271733893490116
train_total_loss: 0.7326142663627521
val_total_loss: 0.5271733893490116
test_abn_acc: 0
balanced_train_acc: 0.9673107997772608
balanced_val_acc: 0.7279090007978145
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8695652173913043
Land_on_Water_val_acc: 0.6437768240343348
Water_on_Land_train_acc: 0.5357142857142857
Water_on_Land_val_acc: 0.3458646616541353
Water_on_Water_train_acc: 0.9640491958372753
Water_on_Water_val_acc: 0.9323308270676691
train_abn_cls_loss: 0.6100322664716321
train_abn_att_clip_vit_loss: 0.060703425201838905
train_acc_Landbird: 0.9921238457360131
train_acc_Waterbird: 0.9424977538185085
val_acc_Landbird: 0.8167202572347267
val_acc_Waterbird: 0.6390977443609023
TRAIN ACC:        0.9806047966631908
VAL ACC:          0.7773144286905754
BALANCED VAL ACC: 0.7279090007978145
EPOCH: 98

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.62it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.75it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.91it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.09it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.05it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.05it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.05it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:15,  1.25s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.58it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.86it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.80it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.96it/s]
100%|██████████| 13/13 [00:03<00:00,  6.15it/s]
100%|██████████| 13/13 [00:03<00:00,  3.93it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9814389989572472
val_acc: 0.7756463719766472
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05982932806776388
val_cls_loss: 0.5340184835939232
train_total_loss: 0.7306089234923918
val_total_loss: 0.5340184835939232
test_abn_acc: 0
balanced_train_acc: 0.9666002206894667
balanced_val_acc: 0.7362437444092547
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9130434782608695
Land_on_Water_val_acc: 0.6244635193133047
Water_on_Land_train_acc: 0.5535714285714286
Water_on_Land_val_acc: 0.38345864661654133
Water_on_Water_train_acc: 0.9593188268684958
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6101095847342634
train_abn_att_clip_vit_loss: 0.06067001173453361
train_acc_Landbird: 0.9942965779467681
train_acc_Waterbird: 0.9389038634321654
val_acc_Landbird: 0.8070739549839229
val_acc_Waterbird: 0.6654135338345865
TRAIN ACC:        0.9814389989572472
VAL ACC:          0.7756463719766472
BALANCED VAL ACC: 0.7362437444092547
prev best list: ['best_balanced_valacc_0.73_epoch_96.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.74_epoch_98.ckpt
EPOCH: 99

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.88it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.93it/s]
 40%|████      | 20/50 [00:06<00:07,  3.94it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.23s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.59it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.82it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.16it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.60it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.78it/s]
100%|██████████| 13/13 [00:03<00:00,  5.88it/s]
100%|██████████| 13/13 [00:03<00:00,  3.85it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9837330552659019
val_acc: 0.7789824854045038
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.059766548103628615
val_cls_loss: 0.5295505546176305
train_total_loss: 0.7302689053840756
val_total_loss: 0.5295505546176305
test_abn_acc: 0
balanced_train_acc: 0.9721687010409301
balanced_val_acc: 0.7356997799966154
Land_on_Land_train_acc: 0.9982847341337907
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.907608695652174
Land_on_Water_val_acc: 0.6373390557939914
Water_on_Land_train_acc: 0.6071428571428571
Water_on_Land_val_acc: 0.3684210526315789
Water_on_Water_train_acc: 0.9687795648060549
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6098893566474676
train_abn_att_clip_vit_loss: 0.06061300157925757
train_acc_Landbird: 0.9937533948940793
train_acc_Waterbird: 0.9505840071877808
val_acc_Landbird: 0.8135048231511254
val_acc_Waterbird: 0.6578947368421053
TRAIN ACC:        0.9837330552659019
VAL ACC:          0.7789824854045038
BALANCED VAL ACC: 0.7356997799966154
EPOCH: 100

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.92it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.97it/s]
 30%|███       | 15/50 [00:04<00:08,  3.99it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.03it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.06it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:06<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.07it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.08it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.05it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.05it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.04it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.06it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.94it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.82it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.95it/s]
100%|██████████| 13/13 [00:03<00:00,  6.15it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9828988529718456
val_acc: 0.7773144286905754
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05990849762331457
val_cls_loss: 0.5317943513617106
train_total_loss: 0.7296191755748267
val_total_loss: 0.5317943513617106
test_abn_acc: 0
balanced_train_acc: 0.969744874777517
balanced_val_acc: 0.7359717622029349
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9130434782608695
Land_on_Water_val_acc: 0.630901287553648
Water_on_Land_train_acc: 0.6071428571428571
Water_on_Land_val_acc: 0.37593984962406013
Water_on_Water_train_acc: 0.9631031220435194
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6091234348613354
train_abn_att_clip_vit_loss: 0.060587246872181685
train_acc_Landbird: 0.9942965779467681
train_acc_Waterbird: 0.945193171608266
val_acc_Landbird: 0.8102893890675241
val_acc_Waterbird: 0.6616541353383458
TRAIN ACC:        0.9828988529718456
VAL ACC:          0.7773144286905754
BALANCED VAL ACC: 0.7359717622029349
EPOCH: 101

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.62it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.82it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.04it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.06it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.05it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.11it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.13it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.13it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.13it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.94it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.02it/s]
100%|██████████| 13/13 [00:03<00:00,  6.15it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9831074035453597
val_acc: 0.7898248540450375
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05906173595002968
val_cls_loss: 0.5130840700626175
train_total_loss: 0.729217507543355
val_total_loss: 0.5130840700626175
test_abn_acc: 0
balanced_train_acc: 0.9720747542865342
balanced_val_acc: 0.7399789667093779
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.875
Land_on_Water_val_acc: 0.6652360515021459
Water_on_Land_train_acc: 0.6964285714285714
Water_on_Land_val_acc: 0.3609022556390977
Water_on_Water_train_acc: 0.9649952696310312
Water_on_Water_val_acc: 0.9398496240601504
train_abn_cls_loss: 0.609595077117367
train_abn_att_clip_vit_loss: 0.060560689598508376
train_acc_Landbird: 0.9926670287887018
train_acc_Waterbird: 0.9514824797843666
val_acc_Landbird: 0.8295819935691319
val_acc_Waterbird: 0.650375939849624
TRAIN ACC:        0.9831074035453597
VAL ACC:          0.7898248540450375
BALANCED VAL ACC: 0.7399789667093779
prev best list: ['best_balanced_valacc_0.74_epoch_98.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.74_epoch_101.ckpt
EPOCH: 102

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.78it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.03it/s]
 40%|████      | 20/50 [00:06<00:07,  4.04it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.93it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.93it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.93it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.93it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.92it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.92it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.93it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.92it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.95it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.44it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.02it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.24it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.17it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9818561001042753
val_acc: 0.7823185988323603
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05911358913272712
val_cls_loss: 0.534024767819994
train_total_loss: 0.7301317301855594
val_total_loss: 0.534024767819994
test_abn_acc: 0
balanced_train_acc: 0.968125574356294
balanced_val_acc: 0.7432185769890965
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.8967391304347826
Land_on_Water_val_acc: 0.6373390557939914
Water_on_Land_train_acc: 0.5714285714285714
Water_on_Land_val_acc: 0.39849624060150374
Water_on_Water_train_acc: 0.9621570482497634
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6105195084876139
train_abn_att_clip_vit_loss: 0.06049863568840236
train_acc_Landbird: 0.9937533948940793
train_acc_Waterbird: 0.9424977538185085
val_acc_Landbird: 0.8135048231511254
val_acc_Waterbird: 0.6729323308270677
TRAIN ACC:        0.9818561001042753
VAL ACC:          0.7823185988323603
BALANCED VAL ACC: 0.7432185769890965
prev best list: ['best_balanced_valacc_0.74_epoch_101.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.74_epoch_102.ckpt
EPOCH: 103

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.14it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.36it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.53it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.78it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.83it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.86it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.87it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.94it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.04it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.97it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.81it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.94it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.36it/s]
100%|██████████| 13/13 [00:03<00:00,  4.18it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.983941605839416
val_acc: 0.7814845704753962
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05380093866184245
val_cls_loss: 0.5293487661251731
train_total_loss: 0.7218509906275553
val_total_loss: 0.5293487661251731
test_abn_acc: 0
balanced_train_acc: 0.9710507346636194
balanced_val_acc: 0.7440264648760164
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9239130434782609
Land_on_Water_val_acc: 0.6330472103004292
Water_on_Land_train_acc: 0.5357142857142857
Water_on_Land_val_acc: 0.40601503759398494
Water_on_Water_train_acc: 0.9687795648060549
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.607570304860661
train_abn_att_clip_vit_loss: 0.06047974759334071
train_acc_Landbird: 0.9951113525258012
train_acc_Waterbird: 0.9469901168014375
val_acc_Landbird: 0.8113612004287245
val_acc_Waterbird: 0.6766917293233082
TRAIN ACC:        0.983941605839416
VAL ACC:          0.7814845704753962
BALANCED VAL ACC: 0.7440264648760164
prev best list: ['best_balanced_valacc_0.74_epoch_102.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.74_epoch_103.ckpt
EPOCH: 104

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.54it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.11s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.08it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.44it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  4.00it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.14it/s]
100%|██████████| 13/13 [00:02<00:00,  6.41it/s]
100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9862356621480709
val_acc: 0.786488740617181
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.055862694660180304
val_cls_loss: 0.5236464569825148
train_total_loss: 0.7244980404971165
val_total_loss: 0.5236464569825148
test_abn_acc: 0
balanced_train_acc: 0.976305774479962
balanced_val_acc: 0.7458981053920977
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.907608695652174
Land_on_Water_val_acc: 0.648068669527897
Water_on_Land_train_acc: 0.7142857142857143
Water_on_Land_val_acc: 0.39849624060150374
Water_on_Water_train_acc: 0.9706717123935666
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6082050749731014
train_abn_att_clip_vit_loss: 0.060430271140415305
train_acc_Landbird: 0.9948397609994568
train_acc_Waterbird: 0.9577717879604672
val_acc_Landbird: 0.8188638799571275
val_acc_Waterbird: 0.6729323308270677
TRAIN ACC:        0.9862356621480709
VAL ACC:          0.786488740617181
BALANCED VAL ACC: 0.7458981053920977
prev best list: ['best_balanced_valacc_0.74_epoch_103.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.75_epoch_104.ckpt
EPOCH: 105

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  4.00it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  4.01it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.93it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.94it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.77it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.10it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.46it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.96it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.50it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.86it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9872784150156413
val_acc: 0.7839866555462885
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05126451361104768
val_cls_loss: 0.5264621193305565
train_total_loss: 0.719042361714917
val_total_loss: 0.5264621193305565
test_abn_acc: 0
balanced_train_acc: 0.9776116343660644
balanced_val_acc: 0.745634181917817
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9239130434782609
Land_on_Water_val_acc: 0.6394849785407726
Water_on_Land_train_acc: 0.6964285714285714
Water_on_Land_val_acc: 0.40601503759398494
Water_on_Water_train_acc: 0.9735099337748344
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6073744950379023
train_abn_att_clip_vit_loss: 0.06040335808869945
train_acc_Landbird: 0.9956545355784899
train_acc_Waterbird: 0.9595687331536388
val_acc_Landbird: 0.8145766345123259
val_acc_Waterbird: 0.6766917293233082
TRAIN ACC:        0.9872784150156413
VAL ACC:          0.7839866555462885
BALANCED VAL ACC: 0.745634181917817
EPOCH: 106

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.56it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.93it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.02it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.05it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.04it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.26it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9858185610010427
val_acc: 0.7939949958298582
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05217325755232815
val_cls_loss: 0.509273685347149
train_total_loss: 0.7191353927314965
val_total_loss: 0.509273685347149
test_abn_acc: 0
balanced_train_acc: 0.9757207424184969
balanced_val_acc: 0.7480336693824594
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.8967391304347826
Land_on_Water_val_acc: 0.6673819742489271
Water_on_Land_train_acc: 0.625
Water_on_Land_val_acc: 0.38345864661654133
Water_on_Water_train_acc: 0.9744560075685903
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6066026045582465
train_abn_att_clip_vit_loss: 0.060359525602073937
train_acc_Landbird: 0.9945681694731124
train_acc_Waterbird: 0.9568733153638814
val_acc_Landbird: 0.8306538049303323
val_acc_Waterbird: 0.6654135338345865
TRAIN ACC:        0.9858185610010427
VAL ACC:          0.7939949958298582
BALANCED VAL ACC: 0.7480336693824594
prev best list: ['best_balanced_valacc_0.75_epoch_104.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.75_epoch_106.ckpt
EPOCH: 107

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.92it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.99it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.94it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.96it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  4.00it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.48it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.78it/s]
100%|██████████| 13/13 [00:03<00:00,  4.16it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9831074035453597
val_acc: 0.7898248540450375
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05891136132002001
val_cls_loss: 0.5226179969693543
train_total_loss: 0.7282508076169568
val_total_loss: 0.5226179969693543
test_abn_acc: 0
balanced_train_acc: 0.9717613137514135
balanced_val_acc: 0.7507293152495387
Land_on_Land_train_acc: 0.9977129788450543
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9021739130434783
Land_on_Water_val_acc: 0.6523605150214592
Water_on_Land_train_acc: 0.6071428571428571
Water_on_Land_val_acc: 0.41353383458646614
Water_on_Water_train_acc: 0.9687795648060549
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6090250332487264
train_abn_att_clip_vit_loss: 0.06031441675174721
train_acc_Landbird: 0.9929386203150462
train_acc_Waterbird: 0.9505840071877808
val_acc_Landbird: 0.8210075026795284
val_acc_Waterbird: 0.6804511278195489
TRAIN ACC:        0.9831074035453597
VAL ACC:          0.7898248540450375
BALANCED VAL ACC: 0.7507293152495387
prev best list: ['best_balanced_valacc_0.75_epoch_106.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.75_epoch_107.ckpt
EPOCH: 108

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.63it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.75it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.13it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.11it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.15it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  4.18it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.55it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.71it/s]
100%|██████████| 13/13 [00:03<00:00,  5.71it/s]
100%|██████████| 13/13 [00:03<00:00,  3.86it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9872784150156413
val_acc: 0.7881567973311092
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04976375015905055
val_cls_loss: 0.5188534234194481
train_total_loss: 0.7164593931407949
val_total_loss: 0.5188534234194481
test_abn_acc: 0
balanced_train_acc: 0.9772981938309436
balanced_val_acc: 0.746969916753298
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9293478260869565
Land_on_Water_val_acc: 0.6523605150214592
Water_on_Land_train_acc: 0.6785714285714286
Water_on_Land_val_acc: 0.39849624060150374
Water_on_Water_train_acc: 0.9735099337748344
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6064017969823604
train_abn_att_clip_vit_loss: 0.06029384756719109
train_acc_Landbird: 0.9959261271048343
train_acc_Waterbird: 0.958670260557053
val_acc_Landbird: 0.8210075026795284
val_acc_Waterbird: 0.6729323308270677
TRAIN ACC:        0.9872784150156413
VAL ACC:          0.7881567973311092
BALANCED VAL ACC: 0.746969916753298
EPOCH: 109

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:17,  2.57it/s]
 10%|█         | 5/50 [00:02<00:15,  2.96it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.29it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.52it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.87it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.92it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.97it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:05<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.01it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.01it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.02it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.03it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.07it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.11it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.13it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.08it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.06it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.14it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  4.19it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.87it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9862356621480709
val_acc: 0.7948290241868223
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05013243588264468
val_cls_loss: 0.511426992844899
train_total_loss: 0.7165942969237676
val_total_loss: 0.511426992844899
test_abn_acc: 0
balanced_train_acc: 0.9753654528745999
balanced_val_acc: 0.7512571621980998
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9130434782608695
Land_on_Water_val_acc: 0.6652360515021459
Water_on_Land_train_acc: 0.6607142857142857
Water_on_Land_val_acc: 0.39849624060150374
Water_on_Water_train_acc: 0.9706717123935666
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.60620096948025
train_abn_att_clip_vit_loss: 0.06026089311780348
train_acc_Landbird: 0.9956545355784899
train_acc_Waterbird: 0.9550763701707098
val_acc_Landbird: 0.8295819935691319
val_acc_Waterbird: 0.6729323308270677
TRAIN ACC:        0.9862356621480709
VAL ACC:          0.7948290241868223
BALANCED VAL ACC: 0.7512571621980998
prev best list: ['best_balanced_valacc_0.75_epoch_107.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.75_epoch_109.ckpt
EPOCH: 110

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.94it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.97it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.01it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.05it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.07it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.06it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.03it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.04it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.05it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.06it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.07it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.07it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.05it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.06it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.06it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.06it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.06it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.06it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.08it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.08it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.82it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.15it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.63it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.78it/s]
100%|██████████| 13/13 [00:03<00:00,  5.94it/s]
100%|██████████| 13/13 [00:03<00:00,  3.92it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9841501564129301
val_acc: 0.780650542118432
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.05132313002875935
val_cls_loss: 0.534464488012578
train_total_loss: 0.7180099062054448
val_total_loss: 0.534464488012578
test_abn_acc: 0
balanced_train_acc: 0.9708730898916709
balanced_val_acc: 0.7461781463304564
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9293478260869565
Land_on_Water_val_acc: 0.6266094420600858
Water_on_Land_train_acc: 0.6428571428571429
Water_on_Land_val_acc: 0.42105263157894735
Water_on_Water_train_acc: 0.9621570482497634
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6064361793902917
train_abn_att_clip_vit_loss: 0.06025060076689944
train_acc_Landbird: 0.9956545355784899
train_acc_Waterbird: 0.9460916442048517
val_acc_Landbird: 0.8081457663451233
val_acc_Waterbird: 0.6842105263157895
TRAIN ACC:        0.9841501564129301
VAL ACC:          0.780650542118432
BALANCED VAL ACC: 0.7461781463304564
EPOCH: 111

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.93it/s]
 40%|████      | 20/50 [00:06<00:07,  3.94it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.95it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.94it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.93it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.93it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.94it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.93it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.90it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.91it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.94it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.93it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.93it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.94it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.93it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.94it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.69it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.98it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.44it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.81it/s]
100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9856100104275287
val_acc: 0.7948290241868223
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04900766737114277
val_cls_loss: 0.5125719591341384
train_total_loss: 0.7150930702002628
val_total_loss: 0.5125719591341384
test_abn_acc: 0
balanced_train_acc: 0.9746446250499625
balanced_val_acc: 0.7539447493331399
Land_on_Land_train_acc: 0.9979988564894225
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9402173913043478
Land_on_Water_val_acc: 0.6652360515021459
Water_on_Land_train_acc: 0.7142857142857143
Water_on_Land_val_acc: 0.41353383458646614
Water_on_Water_train_acc: 0.9668874172185431
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6058782461661616
train_abn_att_clip_vit_loss: 0.06020715668238117
train_acc_Landbird: 0.9951113525258012
train_acc_Waterbird: 0.954177897574124
val_acc_Landbird: 0.827438370846731
val_acc_Waterbird: 0.6804511278195489
TRAIN ACC:        0.9856100104275287
VAL ACC:          0.7948290241868223
BALANCED VAL ACC: 0.7539447493331399
prev best list: ['best_balanced_valacc_0.75_epoch_109.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.75_epoch_111.ckpt
EPOCH: 112

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.87it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.96it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.97it/s]
 30%|███       | 15/50 [00:04<00:08,  4.02it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.01it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.02it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.02it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.04it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.04it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.07it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.06it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.05it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.06it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.34it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.74it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9856100104275287
val_acc: 0.7798165137614679
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.0507253247735647
val_cls_loss: 0.5455084456514576
train_total_loss: 0.7168390055766817
val_total_loss: 0.5455084456514576
test_abn_acc: 0
balanced_train_acc: 0.9737043034446005
balanced_val_acc: 0.7469860342173762
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9347826086956522
Land_on_Water_val_acc: 0.6223175965665236
Water_on_Land_train_acc: 0.625
Water_on_Land_val_acc: 0.42857142857142855
Water_on_Water_train_acc: 0.9687795648060549
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6059475796066062
train_abn_att_clip_vit_loss: 0.060166104385732236
train_acc_Landbird: 0.9959261271048343
train_acc_Waterbird: 0.9514824797843666
val_acc_Landbird: 0.8060021436227224
val_acc_Waterbird: 0.6879699248120301
TRAIN ACC:        0.9856100104275287
VAL ACC:          0.7798165137614679
BALANCED VAL ACC: 0.7469860342173762
EPOCH: 113

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.12it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.32it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.52it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.64it/s]
 20%|██        | 10/50 [00:03<00:10,  3.69it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.80it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.89it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.95it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.01it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.06it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.02it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.02it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.01it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.03it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.04it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.28it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.78it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.98it/s]
100%|██████████| 13/13 [00:03<00:00,  6.00it/s]
100%|██████████| 13/13 [00:03<00:00,  4.01it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9856100104275287
val_acc: 0.8015012510425354
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.049149299928058054
val_cls_loss: 0.5015586996520928
train_total_loss: 0.715211113053641
val_total_loss: 0.5015586996520928
test_abn_acc: 0
balanced_train_acc: 0.9758983871904454
balanced_val_acc: 0.7555444076429014
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.8913043478260869
Land_on_Water_val_acc: 0.6824034334763949
Water_on_Land_train_acc: 0.6964285714285714
Water_on_Land_val_acc: 0.39849624060150374
Water_on_Water_train_acc: 0.9716177861873226
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6059374164117887
train_abn_att_clip_vit_loss: 0.060124400621658816
train_acc_Landbird: 0.9940249864204237
train_acc_Waterbird: 0.9577717879604672
val_acc_Landbird: 0.8381564844587353
val_acc_Waterbird: 0.6729323308270677
TRAIN ACC:        0.9856100104275287
VAL ACC:          0.8015012510425354
BALANCED VAL ACC: 0.7555444076429014
prev best list: ['best_balanced_valacc_0.75_epoch_111.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.76_epoch_113.ckpt
EPOCH: 114

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.40s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.97it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.78it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.87it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.95it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.06it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.06it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.06it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.06it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.06it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.08it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.26it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.82it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.00it/s]
100%|██████████| 13/13 [00:03<00:00,  6.06it/s]
100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9887382690302399
val_acc: 0.7931609674728941
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.045823583511074344
val_cls_loss: 0.5168612772867618
train_total_loss: 0.710916591995824
val_total_loss: 0.5168612772867618
test_abn_acc: 0
balanced_train_acc: 0.9807562884541147
balanced_val_acc: 0.7528729379719394
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9293478260869565
Land_on_Water_val_acc: 0.6587982832618026
Water_on_Land_train_acc: 0.7321428571428571
Water_on_Land_val_acc: 0.41353383458646614
Water_on_Water_train_acc: 0.978240302743614
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6049816862634374
train_abn_att_clip_vit_loss: 0.06011132081044106
train_acc_Landbird: 0.9956545355784899
train_acc_Waterbird: 0.9658580413297394
val_acc_Landbird: 0.8252947481243301
val_acc_Waterbird: 0.6804511278195489
TRAIN ACC:        0.9887382690302399
VAL ACC:          0.7931609674728941
BALANCED VAL ACC: 0.7528729379719394
EPOCH: 115

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.02it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.03it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.01it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.00it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.06it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.64it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.45it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.18it/s]
100%|██████████| 13/13 [00:03<00:00,  6.19it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9912408759124087
val_acc: 0.8023352793994996
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04484267051606531
val_cls_loss: 0.4951220509332851
train_total_loss: 0.7093166989753095
val_total_loss: 0.4951220509332851
test_abn_acc: 0
balanced_train_acc: 0.9839530402877845
balanced_val_acc: 0.7547365197559817
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9957173447537473
Land_on_Water_train_acc: 0.9619565217391305
Land_on_Water_val_acc: 0.6845493562231759
Water_on_Land_train_acc: 0.7678571428571429
Water_on_Land_val_acc: 0.39097744360902253
Water_on_Water_train_acc: 0.9810785241248817
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6044058868733387
train_abn_att_clip_vit_loss: 0.06006814725813577
train_acc_Landbird: 0.9975556762629006
train_acc_Waterbird: 0.9703504043126685
val_acc_Landbird: 0.8403001071811361
val_acc_Waterbird: 0.6691729323308271
TRAIN ACC:        0.9912408759124087
VAL ACC:          0.8023352793994996
BALANCED VAL ACC: 0.7547365197559817
EPOCH: 116

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.12it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.33it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.50it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.64it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.94it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.98it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.12it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.14it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.13it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.14it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.14it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.13it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.15it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.16it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.18it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.18it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.19it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.13it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.03it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.02it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.02it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.04it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.08it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.33it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.43it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.75it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9883211678832117
val_acc: 0.79232693911593
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.044642419803875955
val_cls_loss: 0.5221662869967452
train_total_loss: 0.7093743234903894
val_total_loss: 0.5221662869967452
test_abn_acc: 0
balanced_train_acc: 0.980798137462891
balanced_val_acc: 0.7550246194263794
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.907608695652174
Land_on_Water_val_acc: 0.6545064377682404
Water_on_Land_train_acc: 0.8035714285714286
Water_on_Land_val_acc: 0.42857142857142855
Water_on_Water_train_acc: 0.9754020813623463
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.604699655058983
train_abn_att_clip_vit_loss: 0.06003224849778619
train_acc_Landbird: 0.9948397609994568
train_acc_Waterbird: 0.9667565139263252
val_acc_Landbird: 0.8220793140407289
val_acc_Waterbird: 0.6879699248120301
TRAIN ACC:        0.9883211678832117
VAL ACC:          0.79232693911593
BALANCED VAL ACC: 0.7550246194263794
EPOCH: 117

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.80it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.84it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.98it/s]
100%|██████████| 13/13 [00:03<00:00,  6.19it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9872784150156413
val_acc: 0.798999165971643
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.044337306831253455
val_cls_loss: 0.504996341526558
train_total_loss: 0.7082633122289019
val_total_loss: 0.504996341526558
test_abn_acc: 0
balanced_train_acc: 0.9776116343660644
balanced_val_acc: 0.7552804841686209
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9347826086956522
Land_on_Water_val_acc: 0.6738197424892703
Water_on_Land_train_acc: 0.7142857142857143
Water_on_Land_val_acc: 0.40601503759398494
Water_on_Water_train_acc: 0.9725638599810785
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6039172039166233
train_abn_att_clip_vit_loss: 0.06000880061943041
train_acc_Landbird: 0.9956545355784899
train_acc_Waterbird: 0.9595687331536388
val_acc_Landbird: 0.8338692390139335
val_acc_Waterbird: 0.6766917293233082
TRAIN ACC:        0.9872784150156413
VAL ACC:          0.798999165971643
BALANCED VAL ACC: 0.7552804841686209
EPOCH: 118

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.22it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.61it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.93it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.96it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.33it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.01it/s]
100%|██████████| 13/13 [00:03<00:00,  3.99it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9885297184567258
val_acc: 0.7981651376146789
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04353170035265161
val_cls_loss: 0.5125768886097677
train_total_loss: 0.7074314583702803
val_total_loss: 0.5125768886097677
test_abn_acc: 0
balanced_train_acc: 0.9793667305504596
balanced_val_acc: 0.760119752758101
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9456521739130435
Land_on_Water_val_acc: 0.6652360515021459
Water_on_Land_train_acc: 0.7142857142857143
Water_on_Land_val_acc: 0.43609022556390975
Water_on_Water_train_acc: 0.9754020813623463
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6039324690701442
train_abn_att_clip_vit_loss: 0.05996728338324489
train_acc_Landbird: 0.996469310157523
train_acc_Waterbird: 0.9622641509433962
val_acc_Landbird: 0.8285101822079314
val_acc_Waterbird: 0.6917293233082706
TRAIN ACC:        0.9885297184567258
VAL ACC:          0.7981651376146789
BALANCED VAL ACC: 0.760119752758101
prev best list: ['best_balanced_valacc_0.76_epoch_113.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.76_epoch_118.ckpt
EPOCH: 119

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.44s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.35it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.91it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.40it/s]
 10%|█         | 5/50 [00:02<00:16,  2.78it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.07it/s]
 14%|█▍        | 7/50 [00:02<00:13,  3.29it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.44it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.57it/s]
 20%|██        | 10/50 [00:03<00:10,  3.70it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.92it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.97it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.96it/s]
 30%|███       | 15/50 [00:04<00:08,  4.00it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.05it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.14it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.15it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.14it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.15it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  4.19it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  5.93it/s]
100%|██████████| 13/13 [00:03<00:00,  3.98it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9883211678832117
val_acc: 0.7906588824020017
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04304891868773168
val_cls_loss: 0.5319732541188884
train_total_loss: 0.7070689514729974
val_total_loss: 0.5319732541188884
test_abn_acc: 0
balanced_train_acc: 0.9779771726468045
balanced_val_acc: 0.7579841887677393
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9619565217391305
Land_on_Water_val_acc: 0.6437768240343348
Water_on_Land_train_acc: 0.6785714285714286
Water_on_Land_val_acc: 0.45112781954887216
Water_on_Water_train_acc: 0.9735099337748344
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6040949475529047
train_abn_att_clip_vit_loss: 0.059925082402072685
train_acc_Landbird: 0.9972840847365562
train_acc_Waterbird: 0.958670260557053
val_acc_Landbird: 0.8167202572347267
val_acc_Waterbird: 0.6992481203007519
TRAIN ACC:        0.9883211678832117
VAL ACC:          0.7906588824020017
BALANCED VAL ACC: 0.7579841887677393
EPOCH: 120

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.80it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.99it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.95it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.97it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.95it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.75it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.42it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.42it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.72it/s]
100%|██████████| 13/13 [00:03<00:00,  4.14it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9912408759124087
val_acc: 0.798999165971643
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.039839891721110895
val_cls_loss: 0.5091858176363817
train_total_loss: 0.7021560947763286
val_total_loss: 0.5091858176363817
test_abn_acc: 0
balanced_train_acc: 0.984579921358026
balanced_val_acc: 0.7593118648711812
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9565217391304348
Land_on_Water_val_acc: 0.6673819742489271
Water_on_Land_train_acc: 0.7857142857142857
Water_on_Land_val_acc: 0.42857142857142855
Water_on_Water_train_acc: 0.9820245979186376
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6024028215467992
train_abn_att_clip_vit_loss: 0.059913379998879586
train_acc_Landbird: 0.9970124932102118
train_acc_Waterbird: 0.97214734950584
val_acc_Landbird: 0.8306538049303323
val_acc_Waterbird: 0.6879699248120301
TRAIN ACC:        0.9912408759124087
VAL ACC:          0.798999165971643
BALANCED VAL ACC: 0.7593118648711812
EPOCH: 121

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.94it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.80it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.08it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.06it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.94it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.05it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.11it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.06it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.07it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.13it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.63it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.96it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.44it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.77it/s]
100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9879040667361835
val_acc: 0.7873227689741451
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04524984640983148
val_cls_loss: 0.5395557823729973
train_total_loss: 0.7096096987147525
val_total_loss: 0.5395557823729973
test_abn_acc: 0
balanced_train_acc: 0.9783324621907017
balanced_val_acc: 0.7598719467478987
Land_on_Land_train_acc: 0.9982847341337907
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9565217391304348
Land_on_Water_val_acc: 0.630901287553648
Water_on_Land_train_acc: 0.7321428571428571
Water_on_Land_val_acc: 0.47368421052631576
Water_on_Water_train_acc: 0.9725638599810785
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6044970951314017
train_abn_att_clip_vit_loss: 0.059862759153866546
train_acc_Landbird: 0.9961977186311787
train_acc_Waterbird: 0.9604672057502246
val_acc_Landbird: 0.8092175777063236
val_acc_Waterbird: 0.7105263157894737
TRAIN ACC:        0.9879040667361835
VAL ACC:          0.7873227689741451
BALANCED VAL ACC: 0.7598719467478987
EPOCH: 122

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.44it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.83it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.97it/s]
 30%|███       | 15/50 [00:04<00:08,  3.98it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.12it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.14it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9906152241918665
val_acc: 0.804837364470392
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.038728702529814245
val_cls_loss: 0.49996042665439017
train_total_loss: 0.700654762703634
val_total_loss: 0.49996042665439017
test_abn_acc: 0
balanced_train_acc: 0.9832322124631472
balanced_val_acc: 0.7630632046353827
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9510869565217391
Land_on_Water_val_acc: 0.6824034334763949
Water_on_Land_train_acc: 0.7857142857142857
Water_on_Land_val_acc: 0.42857142857142855
Water_on_Water_train_acc: 0.97918637653737
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6020825132214861
train_abn_att_clip_vit_loss: 0.0598435466229232
train_acc_Landbird: 0.9970124932102118
train_acc_Waterbird: 0.9694519317160827
val_acc_Landbird: 0.8381564844587353
val_acc_Waterbird: 0.6879699248120301
TRAIN ACC:        0.9906152241918665
VAL ACC:          0.804837364470392
BALANCED VAL ACC: 0.7630632046353827
prev best list: ['best_balanced_valacc_0.76_epoch_118.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.76_epoch_122.ckpt
EPOCH: 123

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.64it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.87it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.06it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.11it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.10it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.02it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.12it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.11it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.11it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.02it/s]
100%|██████████| 13/13 [00:03<00:00,  6.18it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9889468196037539
val_acc: 0.8031693077564637
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04298626461548962
val_cls_loss: 0.5050747853154635
train_total_loss: 0.7064208772557868
val_total_loss: 0.5050747853154635
test_abn_acc: 0
balanced_train_acc: 0.979638322076804
balanced_val_acc: 0.7619913932741822
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9510869565217391
Land_on_Water_val_acc: 0.6781115879828327
Water_on_Land_train_acc: 0.7142857142857143
Water_on_Land_val_acc: 0.42857142857142855
Water_on_Water_train_acc: 0.9754020813623463
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6036633277585782
train_abn_att_clip_vit_loss: 0.05977129403023949
train_acc_Landbird: 0.9970124932102118
train_acc_Waterbird: 0.9622641509433962
val_acc_Landbird: 0.8360128617363344
val_acc_Waterbird: 0.6879699248120301
TRAIN ACC:        0.9889468196037539
VAL ACC:          0.8031693077564637
BALANCED VAL ACC: 0.7619913932741822
EPOCH: 124

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  3.97it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.02it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.03it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.05it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.03it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.03it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.06it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.05it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.04it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.07it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.05it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.28it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9906152241918665
val_acc: 0.8056713928273561
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.038415814496429175
val_cls_loss: 0.49688937438588227
train_total_loss: 0.7001944949529965
val_total_loss: 0.49688937438588227
test_abn_acc: 0
balanced_train_acc: 0.9838590935333886
balanced_val_acc: 0.7609115231809427
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9347826086956522
Land_on_Water_val_acc: 0.6888412017167382
Water_on_Land_train_acc: 0.7678571428571429
Water_on_Land_val_acc: 0.41353383458646614
Water_on_Water_train_acc: 0.9820245979186376
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6020056837915255
train_abn_att_clip_vit_loss: 0.059772995118211034
train_acc_Landbird: 0.996469310157523
train_acc_Waterbird: 0.9712488769092543
val_acc_Landbird: 0.8413719185423365
val_acc_Waterbird: 0.6804511278195489
TRAIN ACC:        0.9906152241918665
VAL ACC:          0.8056713928273561
BALANCED VAL ACC: 0.7609115231809427
EPOCH: 125

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.96it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.97it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.02it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.93it/s]
 40%|████      | 20/50 [00:06<00:07,  3.92it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.93it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.93it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.92it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.91it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.92it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.91it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.89it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.88it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.88it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.89it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.89it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.89it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.90it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.90it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.90it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.90it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.90it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.89it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.90it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.92it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.01it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.05it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.83it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.69it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.84it/s]
100%|██████████| 13/13 [00:03<00:00,  5.97it/s]
100%|██████████| 13/13 [00:03<00:00,  3.92it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9897810218978103
val_acc: 0.7998331943286072
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.039658894401521455
val_cls_loss: 0.5094167399868754
train_total_loss: 0.7015322644220776
val_total_loss: 0.5094167399868754
test_abn_acc: 0
balanced_train_acc: 0.9808083861997343
balanced_val_acc: 0.7625353576868216
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.967391304347826
Land_on_Water_val_acc: 0.6673819742489271
Water_on_Land_train_acc: 0.75
Water_on_Land_val_acc: 0.44360902255639095
Water_on_Water_train_acc: 0.9754020813623463
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6021685426376907
train_abn_att_clip_vit_loss: 0.05970483443722113
train_acc_Landbird: 0.9975556762629006
train_acc_Waterbird: 0.9640610961365679
val_acc_Landbird: 0.8295819935691319
val_acc_Waterbird: 0.6954887218045113
TRAIN ACC:        0.9897810218978103
VAL ACC:          0.7998331943286072
BALANCED VAL ACC: 0.7625353576868216
EPOCH: 126

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.78it/s]
 24%|██▍       | 12/50 [00:04<00:10,  3.79it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.83it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.86it/s]
 30%|███       | 15/50 [00:04<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.88it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.92it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  4.01it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.04it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.05it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.05it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.05it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.04it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.04it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.05it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.06it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.07it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.07it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.07it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.24it/s]
100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9899895724713242
val_acc: 0.8015012510425354
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.04033916529823518
val_cls_loss: 0.5066628775266531
train_total_loss: 0.7023574017260197
val_total_loss: 0.5066628775266531
test_abn_acc: 0
balanced_train_acc: 0.9821979441033892
balanced_val_acc: 0.763607169048022
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9402173913043478
Land_on_Water_val_acc: 0.6716738197424893
Water_on_Land_train_acc: 0.7321428571428571
Water_on_Land_val_acc: 0.44360902255639095
Water_on_Water_train_acc: 0.9801324503311258
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6023257195017261
train_abn_att_clip_vit_loss: 0.059692515379227734
train_acc_Landbird: 0.9967409016838674
train_acc_Waterbird: 0.967654986522911
val_acc_Landbird: 0.8317256162915327
val_acc_Waterbird: 0.6954887218045113
TRAIN ACC:        0.9899895724713242
VAL ACC:          0.8015012510425354
BALANCED VAL ACC: 0.763607169048022
prev best list: ['best_balanced_valacc_0.76_epoch_122.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.76_epoch_126.ckpt
EPOCH: 127

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.14it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.73it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.92it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.07it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.10it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  4.01it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.02it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.06it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.04it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.03it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.94it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.94it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.91it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.93it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.95it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.94it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.94it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.95it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.38it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.28it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9916579770594369
val_acc: 0.8065054211843202
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03707640024117652
val_cls_loss: 0.5036500446293333
train_total_loss: 0.6982994253369392
val_total_loss: 0.5036500446293333
test_abn_acc: 0
balanced_train_acc: 0.984224631814129
balanced_val_acc: 0.7654788095641032
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.967391304347826
Land_on_Water_val_acc: 0.6845493562231759
Water_on_Land_train_acc: 0.7678571428571429
Water_on_Land_val_acc: 0.43609022556390975
Water_on_Water_train_acc: 0.9810785241248817
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6015645645457836
train_abn_att_clip_vit_loss: 0.059658461533354766
train_acc_Landbird: 0.9980988593155894
train_acc_Waterbird: 0.9703504043126685
val_acc_Landbird: 0.8392282958199357
val_acc_Waterbird: 0.6917293233082706
TRAIN ACC:        0.9916579770594369
VAL ACC:          0.8065054211843202
BALANCED VAL ACC: 0.7654788095641032
prev best list: ['best_balanced_valacc_0.76_epoch_126.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.77_epoch_127.ckpt
EPOCH: 128

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.80it/s]
 20%|██        | 10/50 [00:03<00:10,  3.88it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.03it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.07it/s]
 30%|███       | 15/50 [00:04<00:08,  4.10it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.10it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.10it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.11it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.11it/s]
 40%|████      | 20/50 [00:06<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.09it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.04it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.95it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.97it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.95it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.97it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.81it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.09it/s]
 46%|████▌     | 6/13 [00:01<00:01,  3.76it/s]
 62%|██████▏   | 8/13 [00:02<00:00,  5.41it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.14it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.68it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9912408759124087
val_acc: 0.7956630525437864
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03768824799155294
val_cls_loss: 0.5301260655253405
train_total_loss: 0.6985639441373823
val_total_loss: 0.5301260655253405
test_abn_acc: 0
balanced_train_acc: 0.9848933618931466
balanced_val_acc: 0.7625434164188607
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9456521739130435
Land_on_Water_val_acc: 0.6523605150214592
Water_on_Land_train_acc: 0.8214285714285714
Water_on_Land_val_acc: 0.45864661654135336
Water_on_Water_train_acc: 0.9810785241248817
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6012449360241855
train_abn_att_clip_vit_loss: 0.05963076127768806
train_acc_Landbird: 0.9967409016838674
train_acc_Waterbird: 0.9730458221024259
val_acc_Landbird: 0.8220793140407289
val_acc_Waterbird: 0.7030075187969925
TRAIN ACC:        0.9912408759124087
VAL ACC:          0.7956630525437864
BALANCED VAL ACC: 0.7625434164188607
EPOCH: 129

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.86it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.93it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.98it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.01it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.01it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.07it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.12it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.07it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.12it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.13it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.12it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.06it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.05it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.68it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.94it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.32it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9910323253388947
val_acc: 0.8090075062552127
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03643562739270198
val_cls_loss: 0.491251921360447
train_total_loss: 0.6976441482060645
val_total_loss: 0.491251921360447
test_abn_acc: 0
balanced_train_acc: 0.9835038039894917
balanced_val_acc: 0.7643989394708637
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.967391304347826
Land_on_Water_val_acc: 0.6952789699570815
Water_on_Land_train_acc: 0.8035714285714286
Water_on_Land_val_acc: 0.42105263157894735
Water_on_Water_train_acc: 0.978240302743614
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6016367241165312
train_abn_att_clip_vit_loss: 0.0595718054720458
train_acc_Landbird: 0.9975556762629006
train_acc_Waterbird: 0.9694519317160827
val_acc_Landbird: 0.8445873526259379
val_acc_Waterbird: 0.6842105263157895
TRAIN ACC:        0.9910323253388947
VAL ACC:          0.8090075062552127
BALANCED VAL ACC: 0.7643989394708637
EPOCH: 130

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.06it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.02it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.84it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.19it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.81it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.97it/s]
100%|██████████| 13/13 [00:03<00:00,  6.16it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9929092805005214
val_acc: 0.8081734778982486
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03347053206462619
val_cls_loss: 0.5043055140122062
train_total_loss: 0.693720075124496
val_total_loss: 0.5043055140122062
test_abn_acc: 0
balanced_train_acc: 0.9872334901390071
balanced_val_acc: 0.7678944144928237
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9728260869565217
Land_on_Water_val_acc: 0.6866952789699571
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.44360902255639095
Water_on_Water_train_acc: 0.9829706717123936
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6006986434566589
train_abn_att_clip_vit_loss: 0.059550902820012616
train_acc_Landbird: 0.997827267789245
train_acc_Waterbird: 0.9766397124887691
val_acc_Landbird: 0.8403001071811361
val_acc_Waterbird: 0.6954887218045113
TRAIN ACC:        0.9929092805005214
VAL ACC:          0.8081734778982486
BALANCED VAL ACC: 0.7678944144928237
prev best list: ['best_balanced_valacc_0.77_epoch_127.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.77_epoch_130.ckpt
EPOCH: 131

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.41s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.82it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.14it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.98it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.96it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.94it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.23s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.57it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.21it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.73it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.91it/s]
100%|██████████| 13/13 [00:03<00:00,  5.98it/s]
100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9914494264859228
val_acc: 0.8098415346121768
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03430883181558163
val_cls_loss: 0.497192600675182
train_total_loss: 0.6942405835306806
val_total_loss: 0.497192600675182
test_abn_acc: 0
balanced_train_acc: 0.9834619549807153
balanced_val_acc: 0.7662786387189839
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.6952789699570815
Water_on_Land_train_acc: 0.7857142857142857
Water_on_Land_val_acc: 0.42857142857142855
Water_on_Water_train_acc: 0.978240302743614
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6004097358153684
train_abn_att_clip_vit_loss: 0.059522016735687244
train_acc_Landbird: 0.9983704508419338
train_acc_Waterbird: 0.9685534591194969
val_acc_Landbird: 0.8445873526259379
val_acc_Waterbird: 0.6879699248120301
TRAIN ACC:        0.9914494264859228
VAL ACC:          0.8098415346121768
BALANCED VAL ACC: 0.7662786387189839
EPOCH: 132

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.99it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.02it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.93it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.94it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.11s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.84it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.10it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.46it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.02it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.17it/s]
100%|██████████| 13/13 [00:02<00:00,  6.42it/s]
100%|██████████| 13/13 [00:03<00:00,  4.23it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9912408759124087
val_acc: 0.8040033361134279
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03386141308024914
val_cls_loss: 0.5166657337976357
train_total_loss: 0.6940013809174268
val_total_loss: 0.5166657337976357
test_abn_acc: 0
balanced_train_acc: 0.9852068024282674
balanced_val_acc: 0.7679024732248628
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9510869565217391
Land_on_Water_val_acc: 0.6759656652360515
Water_on_Land_train_acc: 0.8214285714285714
Water_on_Land_val_acc: 0.45864661654135336
Water_on_Water_train_acc: 0.9820245979186376
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6006537818436329
train_abn_att_clip_vit_loss: 0.05948618313956062
train_acc_Landbird: 0.996469310157523
train_acc_Waterbird: 0.9739442946990117
val_acc_Landbird: 0.8327974276527331
val_acc_Waterbird: 0.7030075187969925
TRAIN ACC:        0.9912408759124087
VAL ACC:          0.8040033361134279
BALANCED VAL ACC: 0.7679024732248628
prev best list: ['best_balanced_valacc_0.77_epoch_130.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.77_epoch_132.ckpt
EPOCH: 133

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.86it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.87it/s]
 30%|███       | 15/50 [00:04<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.91it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.94it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.95it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.91it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.94it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.93it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.93it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.94it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.75it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.46it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.19it/s]
100%|██████████| 13/13 [00:03<00:00,  6.31it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.994577685088634
val_acc: 0.804837364470392
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03141423267301666
val_cls_loss: 0.5116545512737882
train_total_loss: 0.6903933009962095
val_total_loss: 0.5116545512737882
test_abn_acc: 0
balanced_train_acc: 0.9895736183848673
balanced_val_acc: 0.768438378905463
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.6759656652360515
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.45864661654135336
Water_on_Water_train_acc: 0.9867549668874173
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5995276022131426
train_abn_att_clip_vit_loss: 0.05945146425750507
train_acc_Landbird: 0.9989136338946225
train_acc_Waterbird: 0.9802336028751123
val_acc_Landbird: 0.8338692390139335
val_acc_Waterbird: 0.7030075187969925
TRAIN ACC:        0.994577685088634
VAL ACC:          0.804837364470392
BALANCED VAL ACC: 0.768438378905463
prev best list: ['best_balanced_valacc_0.77_epoch_132.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.77_epoch_133.ckpt
EPOCH: 134

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.24it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.50it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.87it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.91it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.94it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.92it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.97it/s]
 30%|███       | 15/50 [00:04<00:08,  4.00it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.01it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.03it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.13it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.12it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.12it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.12it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.12it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.13it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.14it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.12it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.13it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.02it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.02it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.04it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.39it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.95it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.09it/s]
100%|██████████| 13/13 [00:03<00:00,  6.40it/s]
100%|██████████| 13/13 [00:03<00:00,  4.16it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9895724713242962
val_acc: 0.8015012510425354
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.038900459940789014
val_cls_loss: 0.5178951492674456
train_total_loss: 0.6997589125250377
val_total_loss: 0.5178951492674456
test_abn_acc: 0
balanced_train_acc: 0.982866674182407
balanced_val_acc: 0.7676385497505822
Land_on_Land_train_acc: 0.998570611778159
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9347826086956522
Land_on_Water_val_acc: 0.6673819742489271
Water_on_Land_train_acc: 0.7678571428571429
Water_on_Land_val_acc: 0.46616541353383456
Water_on_Water_train_acc: 0.9810785241248817
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6014523941980786
train_abn_att_clip_vit_loss: 0.05940605908772122
train_acc_Landbird: 0.9953829440521456
train_acc_Waterbird: 0.9703504043126685
val_acc_Landbird: 0.8285101822079314
val_acc_Waterbird: 0.706766917293233
TRAIN ACC:        0.9895724713242962
VAL ACC:          0.8015012510425354
BALANCED VAL ACC: 0.7676385497505822
EPOCH: 135

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.41s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.13it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.35it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.83it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.91it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.97it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.10it/s]
 30%|███       | 15/50 [00:04<00:08,  4.10it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.12it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.02it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.02it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.03it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.03it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.13it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.05it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.06it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.06it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.04it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.54it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.97it/s]
100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9910323253388947
val_acc: 0.8115095913261051
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03562787871058094
val_cls_loss: 0.496667458687453
train_total_loss: 0.6960300390862076
val_total_loss: 0.496667458687453
test_abn_acc: 0
balanced_train_acc: 0.9838172445246123
balanced_val_acc: 0.7727256243502647
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9619565217391305
Land_on_Water_val_acc: 0.6931330472103004
Water_on_Land_train_acc: 0.8214285714285714
Water_on_Land_val_acc: 0.45864661654135336
Water_on_Water_train_acc: 0.978240302743614
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6010479967089465
train_abn_att_clip_vit_loss: 0.059354168011945777
train_acc_Landbird: 0.9972840847365562
train_acc_Waterbird: 0.9703504043126685
val_acc_Landbird: 0.842443729903537
val_acc_Waterbird: 0.7030075187969925
TRAIN ACC:        0.9910323253388947
VAL ACC:          0.8115095913261051
BALANCED VAL ACC: 0.7727256243502647
prev best list: ['best_balanced_valacc_0.77_epoch_133.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.77_epoch_135.ckpt
EPOCH: 136

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.43s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.35it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.94it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.61it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.83it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.90it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.93it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.98it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.02it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.05it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.07it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.06it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.05it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.04it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.05it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.01it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.04it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.02it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.03it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.04it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.06it/s]
100%|██████████| 13/13 [00:03<00:00,  6.32it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9927007299270073
val_acc: 0.8031693077564637
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03222328025587408
val_cls_loss: 0.5168050700570266
train_total_loss: 0.6911399715635401
val_total_loss: 0.5168050700570266
test_abn_acc: 0
balanced_train_acc: 0.9867842538407141
balanced_val_acc: 0.7700541546793027
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.967391304347826
Land_on_Water_val_acc: 0.6695278969957081
Water_on_Land_train_acc: 0.8392857142857143
Water_on_Land_val_acc: 0.47368421052631576
Water_on_Water_train_acc: 0.9829706717123936
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5995750053955691
train_abn_att_clip_vit_loss: 0.05934168629899885
train_acc_Landbird: 0.997827267789245
train_acc_Waterbird: 0.9757412398921833
val_acc_Landbird: 0.8295819935691319
val_acc_Waterbird: 0.7105263157894737
TRAIN ACC:        0.9927007299270073
VAL ACC:          0.8031693077564637
BALANCED VAL ACC: 0.7700541546793027
EPOCH: 137

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:17,  2.56it/s]
 10%|█         | 5/50 [00:02<00:15,  2.95it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.61it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.99it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.12it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.02it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.05it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.03it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.04it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.04it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.05it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.03it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.03it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.02it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.03it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.01it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.02it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.93it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.93it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.91it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.90it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.89it/s]
100%|██████████| 50/50 [00:13<00:00,  3.94it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.68it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.09it/s]
100%|██████████| 13/13 [00:03<00:00,  6.29it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9943691345151199
val_acc: 0.8123436196830692
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.0298079156457632
val_cls_loss: 0.49619108765347986
train_total_loss: 0.6879475053209458
val_total_loss: 0.49619108765347986
test_abn_acc: 0
balanced_train_acc: 0.9891243820865745
balanced_val_acc: 0.7705739428958247
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.6995708154506438
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.44360902255639095
Water_on_Water_train_acc: 0.9858088930936613
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5988177557931329
train_abn_att_clip_vit_loss: 0.05932183083111849
train_acc_Landbird: 0.9989136338946225
train_acc_Waterbird: 0.9793351302785265
val_acc_Landbird: 0.8456591639871383
val_acc_Waterbird: 0.6954887218045113
TRAIN ACC:        0.9943691345151199
VAL ACC:          0.8123436196830692
BALANCED VAL ACC: 0.7705739428958247
EPOCH: 138

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.54it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.69it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.78it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.84it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.85it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.99it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.02it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.06it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.02it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.04it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.03it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.05it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.02it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.02it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.14it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.77it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.91it/s]
100%|██████████| 13/13 [00:03<00:00,  6.10it/s]
100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9931178310740355
val_acc: 0.8131776480400333
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.030786628692145764
val_cls_loss: 0.4912047218142995
train_total_loss: 0.6886326822175473
val_total_loss: 0.4912047218142995
test_abn_acc: 0
balanced_train_acc: 0.9870558453670586
balanced_val_acc: 0.7697660550089049
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9728260869565217
Land_on_Water_val_acc: 0.7017167381974249
Water_on_Land_train_acc: 0.8035714285714286
Water_on_Land_val_acc: 0.43609022556390975
Water_on_Water_train_acc: 0.9848628192999054
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5985726424750247
train_abn_att_clip_vit_loss: 0.05927342059356826
train_acc_Landbird: 0.9983704508419338
train_acc_Waterbird: 0.9757412398921833
val_acc_Landbird: 0.8478027867095391
val_acc_Waterbird: 0.6917293233082706
TRAIN ACC:        0.9931178310740355
VAL ACC:          0.8131776480400333
BALANCED VAL ACC: 0.7697660550089049
EPOCH: 139

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.49it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.96it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.04it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.06it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.08it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.06it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:05<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.12it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.12it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.11it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.10it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.04it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  3.96it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.97it/s]
100%|██████████| 50/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.991866527632951
val_acc: 0.8123436196830692
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.032262300374423375
val_cls_loss: 0.5017518540587994
train_total_loss: 0.6907505827104212
val_total_loss: 0.5017518540587994
test_abn_acc: 0
balanced_train_acc: 0.9849873086475425
balanced_val_acc: 0.774605323598385
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9619565217391305
Land_on_Water_val_acc: 0.6931330472103004
Water_on_Land_train_acc: 0.7857142857142857
Water_on_Land_val_acc: 0.46616541353383456
Water_on_Water_train_acc: 0.9820245979186376
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5992518196016456
train_abn_att_clip_vit_loss: 0.05923646716507806
train_acc_Landbird: 0.997827267789245
train_acc_Waterbird: 0.97214734950584
val_acc_Landbird: 0.842443729903537
val_acc_Waterbird: 0.706766917293233
TRAIN ACC:        0.991866527632951
VAL ACC:          0.8123436196830692
BALANCED VAL ACC: 0.774605323598385
prev best list: ['best_balanced_valacc_0.77_epoch_135.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.77_epoch_139.ckpt
EPOCH: 140

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:13,  1.50s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.31it/s]
  6%|▌         | 3/50 [00:02<00:25,  1.87it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.37it/s]
 10%|█         | 5/50 [00:02<00:16,  2.75it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.06it/s]
 14%|█▍        | 7/50 [00:03<00:13,  3.28it/s]
 16%|█▌        | 8/50 [00:03<00:12,  3.48it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.59it/s]
 20%|██        | 10/50 [00:03<00:10,  3.69it/s]
 22%|██▏       | 11/50 [00:04<00:10,  3.75it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.81it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.82it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.86it/s]
 30%|███       | 15/50 [00:05<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.90it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.88it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.90it/s]
 38%|███▊      | 19/50 [00:06<00:08,  3.87it/s]
 40%|████      | 20/50 [00:06<00:07,  3.92it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.93it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.92it/s]
 46%|████▌     | 23/50 [00:07<00:06,  3.92it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.92it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.93it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.92it/s]
 54%|█████▍    | 27/50 [00:08<00:05,  3.92it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.91it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.92it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.92it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  3.92it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.92it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.93it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.93it/s]
 70%|███████   | 35/50 [00:10<00:03,  3.93it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.92it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.89it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.90it/s]
 78%|███████▊  | 39/50 [00:11<00:02,  3.92it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.92it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.93it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.92it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  3.93it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.92it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.90it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.90it/s]
 94%|█████████▍| 47/50 [00:13<00:00,  3.93it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.93it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.95it/s]
100%|██████████| 50/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:14<00:00,  3.55it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.95it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.85it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.40it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.79it/s]
100%|██████████| 13/13 [00:03<00:00,  4.01it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9914494264859228
val_acc: 0.8206839032527106
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03368682436823721
val_cls_loss: 0.4790284325546578
train_total_loss: 0.693339972886353
val_total_loss: 0.4790284325546578
test_abn_acc: 0
balanced_train_acc: 0.9840888360509568
balanced_val_acc: 0.7732454125667867
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9957173447537473
Land_on_Water_train_acc: 0.9728260869565217
Land_on_Water_val_acc: 0.721030042918455
Water_on_Land_train_acc: 0.8214285714285714
Water_on_Land_val_acc: 0.42857142857142855
Water_on_Water_train_acc: 0.978240302743614
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.6004621103732255
train_abn_att_clip_vit_loss: 0.05919103392703814
train_acc_Landbird: 0.997827267789245
train_acc_Waterbird: 0.9703504043126685
val_acc_Landbird: 0.8585209003215434
val_acc_Waterbird: 0.6879699248120301
TRAIN ACC:        0.9914494264859228
VAL ACC:          0.8206839032527106
BALANCED VAL ACC: 0.7732454125667867
EPOCH: 141

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.95it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.24it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.94it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.04it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:05<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.10it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.10it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.08it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.13it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.13it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.14it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  3.73it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.28it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.31it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.69it/s]
100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.991866527632951
val_acc: 0.817347789824854
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.030504031776138838
val_cls_loss: 0.485922353294017
train_total_loss: 0.6885593064634346
val_total_loss: 0.485922353294017
test_abn_acc: 0
balanced_train_acc: 0.9853007491826633
balanced_val_acc: 0.7737893769794261
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9510869565217391
Land_on_Water_val_acc: 0.7124463519313304
Water_on_Land_train_acc: 0.7857142857142857
Water_on_Land_val_acc: 0.44360902255639095
Water_on_Water_train_acc: 0.9829706717123936
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.598888851020085
train_abn_att_clip_vit_loss: 0.059166430023899916
train_acc_Landbird: 0.9975556762629006
train_acc_Waterbird: 0.9730458221024259
val_acc_Landbird: 0.8520900321543409
val_acc_Waterbird: 0.6954887218045113
TRAIN ACC:        0.991866527632951
VAL ACC:          0.817347789824854
BALANCED VAL ACC: 0.7737893769794261
EPOCH: 142

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.01it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.02it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.03it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.68it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.79it/s]
100%|██████████| 13/13 [00:03<00:00,  5.96it/s]
100%|██████████| 13/13 [00:03<00:00,  4.00it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.994577685088634
val_acc: 0.810675562969141
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02938921070221629
val_cls_loss: 0.5060792239608121
train_total_loss: 0.6870113258565678
val_total_loss: 0.5060792239608121
test_abn_acc: 0
balanced_train_acc: 0.9892601778497467
balanced_val_acc: 0.7762210993722247
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.6866952789699571
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.48120300751879697
Water_on_Water_train_acc: 0.9848628192999054
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5984966412575078
train_abn_att_clip_vit_loss: 0.05912546839048392
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9793351302785265
val_acc_Landbird: 0.8381564844587353
val_acc_Waterbird: 0.7142857142857143
TRAIN ACC:        0.994577685088634
VAL ACC:          0.810675562969141
BALANCED VAL ACC: 0.7762210993722247
prev best list: ['best_balanced_valacc_0.77_epoch_139.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_142.ckpt
EPOCH: 143

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.26it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.51it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.88it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.04it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.08it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.07it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.08it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.61it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.85it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.18it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.98it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9935349322210636
val_acc: 0.810675562969141
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.028867879641223875
val_cls_loss: 0.5040238242879125
train_total_loss: 0.6856237403419144
val_total_loss: 0.5040238242879125
test_abn_acc: 0
balanced_train_acc: 0.988267758498765
balanced_val_acc: 0.7762210993722247
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9728260869565217
Land_on_Water_val_acc: 0.6845493562231759
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.48120300751879697
Water_on_Water_train_acc: 0.9848628192999054
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5976570381611057
train_abn_att_clip_vit_loss: 0.05909882726709089
train_acc_Landbird: 0.9980988593155894
train_acc_Waterbird: 0.9784366576819407
val_acc_Landbird: 0.8381564844587353
val_acc_Waterbird: 0.7142857142857143
TRAIN ACC:        0.9935349322210636
VAL ACC:          0.810675562969141
BALANCED VAL ACC: 0.7762210993722247
prev best list: ['best_balanced_valacc_0.78_epoch_142.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_143.ckpt
EPOCH: 144

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.92it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.93it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.93it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.94it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.94it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.93it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.93it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.95it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.97it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.81it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.31it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.77it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.90it/s]
100%|██████████| 13/13 [00:03<00:00,  5.99it/s]
100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9941605839416059
val_acc: 0.8215179316096747
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.026876315462856522
val_cls_loss: 0.4746866700448425
train_total_loss: 0.6834054445946925
val_total_loss: 0.4746866700448425
test_abn_acc: 0
balanced_train_acc: 0.9893020268585231
balanced_val_acc: 0.775125111814907
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.723175965665236
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.43609022556390975
Water_on_Water_train_acc: 0.9858088930936613
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5974795834861533
train_abn_att_clip_vit_loss: 0.05904954521682762
train_acc_Landbird: 0.9983704508419338
train_acc_Waterbird: 0.9802336028751123
val_acc_Landbird: 0.8585209003215434
val_acc_Waterbird: 0.6917293233082706
TRAIN ACC:        0.9941605839416059
VAL ACC:          0.8215179316096747
BALANCED VAL ACC: 0.775125111814907
EPOCH: 145

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:03,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  4.02it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.04it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.03it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.03it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.03it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.03it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.01it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.01it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.03it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.05it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.04it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.10s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.81it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.39it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.03it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9960375391032326
val_acc: 0.8131776480400333
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.026702401798307834
val_cls_loss: 0.5006726058425259
train_total_loss: 0.6829347756657287
val_total_loss: 0.5006726058425259
test_abn_acc: 0
balanced_train_acc: 0.9917779508675556
balanced_val_acc: 0.7764850228465053
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.6931330472103004
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.47368421052631576
Water_on_Water_train_acc: 0.9895931882686849
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5972053287424559
train_abn_att_clip_vit_loss: 0.05902704543844876
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9838274932614556
val_acc_Landbird: 0.842443729903537
val_acc_Waterbird: 0.7105263157894737
TRAIN ACC:        0.9960375391032326
VAL ACC:          0.8131776480400333
BALANCED VAL ACC: 0.7764850228465053
prev best list: ['best_balanced_valacc_0.78_epoch_143.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_145.ckpt
EPOCH: 146

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.43s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.84it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.96it/s]
 30%|███       | 15/50 [00:04<00:08,  4.03it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.09it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.06it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.02it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.01it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.04it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.02it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.06it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.14it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.13it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.28it/s]
100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9931178310740355
val_acc: 0.8181818181818182
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.03005280905287631
val_cls_loss: 0.49416896715772657
train_total_loss: 0.6868242260686299
val_total_loss: 0.49416896715772657
test_abn_acc: 0
balanced_train_acc: 0.9864289642968171
balanced_val_acc: 0.7770128697950665
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.7103004291845494
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.45864661654135336
Water_on_Water_train_acc: 0.9801324503311258
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5977853798145298
train_abn_att_clip_vit_loss: 0.058986040125518446
train_acc_Landbird: 0.9989136338946225
train_acc_Waterbird: 0.9739442946990117
val_acc_Landbird: 0.8510182207931404
val_acc_Waterbird: 0.7030075187969925
TRAIN ACC:        0.9931178310740355
VAL ACC:          0.8181818181818182
BALANCED VAL ACC: 0.7770128697950665
prev best list: ['best_balanced_valacc_0.78_epoch_145.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_146.ckpt
EPOCH: 147

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:11,  1.46s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.34it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.93it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.76it/s]
 20%|██        | 10/50 [00:03<00:10,  3.88it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.02it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.04it/s]
 30%|███       | 15/50 [00:04<00:08,  4.07it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.08it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.07it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.07it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.06it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.07it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.06it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.08it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.08it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.07it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.08it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.06it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.07it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.06it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.16it/s]
100%|██████████| 13/13 [00:03<00:00,  6.27it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9939520333680918
val_acc: 0.8090075062552127
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.027162049360363524
val_cls_loss: 0.5159609053187613
train_total_loss: 0.6838322970988977
val_total_loss: 0.5159609053187613
test_abn_acc: 0
balanced_train_acc: 0.9882259094899888
balanced_val_acc: 0.7778368751460645
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.6802575107296137
Water_on_Land_train_acc: 0.8928571428571429
Water_on_Land_val_acc: 0.49624060150375937
Water_on_Water_train_acc: 0.9820245979186376
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5977084403366192
train_abn_att_clip_vit_loss: 0.05896180951589091
train_acc_Landbird: 0.9989136338946225
train_acc_Waterbird: 0.977538185085355
val_acc_Landbird: 0.8338692390139335
val_acc_Waterbird: 0.7218045112781954
TRAIN ACC:        0.9939520333680918
VAL ACC:          0.8090075062552127
BALANCED VAL ACC: 0.7778368751460645
prev best list: ['best_balanced_valacc_0.78_epoch_146.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_147.ckpt
EPOCH: 148

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.94it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.07it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.08it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.12it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.12it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.10it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.12it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.13it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.12it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.12it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.13it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.12it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.12it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.13it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.14it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.15it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.16it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.14it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.14it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.15it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.15it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.14it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.14it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.14it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.14it/s]
100%|██████████| 50/50 [00:13<00:00,  4.18it/s]
100%|██████████| 50/50 [00:13<00:00,  3.73it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.90it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.71it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.89it/s]
100%|██████████| 13/13 [00:03<00:00,  6.01it/s]
100%|██████████| 13/13 [00:03<00:00,  4.00it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9952033368091763
val_acc: 0.8165137614678899
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.026475993014009703
val_cls_loss: 0.4981132413294039
train_total_loss: 0.6825702995030798
val_total_loss: 0.4981132413294039
test_abn_acc: 0
balanced_train_acc: 0.9909213272797461
balanced_val_acc: 0.7799724391364262
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.6995708154506438
Water_on_Land_train_acc: 0.8392857142857143
Water_on_Land_val_acc: 0.48120300751879697
Water_on_Water_train_acc: 0.9905392620624409
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5971741941847816
train_abn_att_clip_vit_loss: 0.05892010664759637
train_acc_Landbird: 0.9989136338946225
train_acc_Waterbird: 0.9829290206648698
val_acc_Landbird: 0.8456591639871383
val_acc_Waterbird: 0.7142857142857143
TRAIN ACC:        0.9952033368091763
VAL ACC:          0.8165137614678899
BALANCED VAL ACC: 0.7799724391364262
prev best list: ['best_balanced_valacc_0.78_epoch_147.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_148.ckpt
EPOCH: 149

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.97it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.04it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.06it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.05it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.23s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.61it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.91it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.21it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.85it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.01it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9952033368091763
val_acc: 0.8148457047539617
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.025858112333713407
val_cls_loss: 0.5044325012977765
train_total_loss: 0.6809546443916337
val_total_loss: 0.5044325012977765
test_abn_acc: 0
balanced_train_acc: 0.9909213272797461
balanced_val_acc: 0.7789006277752258
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.6952789699570815
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.48120300751879697
Water_on_Water_train_acc: 0.9895931882686849
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5962000882662871
train_abn_att_clip_vit_loss: 0.05889644632669509
train_acc_Landbird: 0.9989136338946225
train_acc_Waterbird: 0.9829290206648698
val_acc_Landbird: 0.8435155412647374
val_acc_Waterbird: 0.7142857142857143
TRAIN ACC:        0.9952033368091763
VAL ACC:          0.8148457047539617
BALANCED VAL ACC: 0.7789006277752258
EPOCH: 150

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.02it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.04it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.05it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.14it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.14it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.04it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.03it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.94it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.93it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.94it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.93it/s]
100%|██████████| 50/50 [00:13<00:00,  3.96it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:16,  1.35s/it]
 23%|██▎       | 3/13 [00:01<00:04,  2.42it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.77it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.10it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.75it/s]
 77%|███████▋  | 10/13 [00:03<00:00,  4.18it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.57it/s]
100%|██████████| 13/13 [00:03<00:00,  3.86it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9933263816475495
val_acc: 0.810675562969141
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.027468538256332945
val_cls_loss: 0.5114063637966509
train_total_loss: 0.6831848545790464
val_total_loss: 0.5114063637966509
test_abn_acc: 0
balanced_train_acc: 0.9871916411302307
balanced_val_acc: 0.7762210993722247
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9728260869565217
Land_on_Water_val_acc: 0.6866952789699571
Water_on_Land_train_acc: 0.8392857142857143
Water_on_Land_val_acc: 0.48120300751879697
Water_on_Water_train_acc: 0.9829706717123936
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5968560021910603
train_abn_att_clip_vit_loss: 0.05886030679217096
train_acc_Landbird: 0.9986420423682781
train_acc_Waterbird: 0.9757412398921833
val_acc_Landbird: 0.8381564844587353
val_acc_Waterbird: 0.7142857142857143
TRAIN ACC:        0.9933263816475495
VAL ACC:          0.810675562969141
BALANCED VAL ACC: 0.7762210993722247
EPOCH: 151

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.24it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.50it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.69it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.82it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.96it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.01it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.06it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.07it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.10it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.12it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.04it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.10it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.12it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.12it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.10it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.62it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.97it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.11it/s]
100%|██████████| 13/13 [00:03<00:00,  6.38it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.994577685088634
val_acc: 0.8131776480400333
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02606679859092387
val_cls_loss: 0.5079009120692006
train_total_loss: 0.6815026266234262
val_total_loss: 0.5079009120692006
test_abn_acc: 0
balanced_train_acc: 0.9902004994551088
balanced_val_acc: 0.7764850228465053
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.6931330472103004
Water_on_Land_train_acc: 0.8928571428571429
Water_on_Land_val_acc: 0.47368421052631576
Water_on_Water_train_acc: 0.9867549668874173
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5966213949902587
train_abn_att_clip_vit_loss: 0.058814437289618354
train_acc_Landbird: 0.9983704508419338
train_acc_Waterbird: 0.9820305480682839
val_acc_Landbird: 0.842443729903537
val_acc_Waterbird: 0.7105263157894737
TRAIN ACC:        0.994577685088634
VAL ACC:          0.8131776480400333
BALANCED VAL ACC: 0.7764850228465053
EPOCH: 152

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.22it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.44it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.83it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.92it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.95it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  4.02it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.02it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.03it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.04it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.07it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.07it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.06it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.08it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.08it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.32it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.82it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.96it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9939520333680918
val_acc: 0.8181818181818182
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.025578602495077877
val_cls_loss: 0.4999491693304418
train_total_loss: 0.6802129279833765
val_total_loss: 0.4999491693304418
test_abn_acc: 0
balanced_train_acc: 0.987912468954868
balanced_val_acc: 0.7797004569301066
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7060085836909872
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.47368421052631576
Water_on_Water_train_acc: 0.9829706717123936
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5958397024988009
train_abn_att_clip_vit_loss: 0.058794628030099015
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9766397124887691
val_acc_Landbird: 0.8488745980707395
val_acc_Waterbird: 0.7105263157894737
TRAIN ACC:        0.9939520333680918
VAL ACC:          0.8181818181818182
BALANCED VAL ACC: 0.7797004569301066
EPOCH: 153

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.35it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.52it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.62it/s]
 20%|██        | 10/50 [00:03<00:10,  3.70it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.98it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.97it/s]
 30%|███       | 15/50 [00:04<00:08,  3.98it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.06it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.06it/s]
 40%|████      | 20/50 [00:06<00:07,  4.08it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.06it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.07it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.03it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.05it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.11it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.13it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.01it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.94it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.92it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.91it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.91it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.91it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.91it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.92it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.89it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.90it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.90it/s]
100%|██████████| 50/50 [00:13<00:00,  3.95it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.91it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.28it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.38it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.78it/s]
100%|██████████| 13/13 [00:03<00:00,  4.00it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9947862356621481
val_acc: 0.8131776480400333
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.024736429572229712
val_cls_loss: 0.5081146388898004
train_total_loss: 0.6790093693171353
val_total_loss: 0.5081146388898004
test_abn_acc: 0
balanced_train_acc: 0.9893959736129189
balanced_val_acc: 0.7805164035490656
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.6888412017167382
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.49624060150375937
Water_on_Water_train_acc: 0.9858088930936613
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5955193724448291
train_abn_att_clip_vit_loss: 0.058753565232715216
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9793351302785265
val_acc_Landbird: 0.8392282958199357
val_acc_Waterbird: 0.7218045112781954
TRAIN ACC:        0.9947862356621481
VAL ACC:          0.8131776480400333
BALANCED VAL ACC: 0.7805164035490656
prev best list: ['best_balanced_valacc_0.78_epoch_148.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_153.ckpt
EPOCH: 154

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.53it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.76it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.81it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.85it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.88it/s]
 30%|███       | 15/50 [00:04<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.89it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.91it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.90it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.90it/s]
 40%|████      | 20/50 [00:06<00:07,  3.91it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.92it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.93it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.93it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.94it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.93it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.92it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.93it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.93it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.93it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.94it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.95it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.95it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.95it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.96it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.61it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.79it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.94it/s]
100%|██████████| 13/13 [00:03<00:00,  6.15it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9949947862356622
val_acc: 0.8156797331109258
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.023750185471210664
val_cls_loss: 0.5037473888572203
train_total_loss: 0.6780206758361912
val_total_loss: 0.5037473888572203
test_abn_acc: 0
balanced_train_acc: 0.989531769376091
balanced_val_acc: 0.7807803270233462
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.6952789699570815
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.48872180451127817
Water_on_Water_train_acc: 0.9848628192999054
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5955556405100261
train_abn_att_clip_vit_loss: 0.05871484793559478
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9793351302785265
val_acc_Landbird: 0.8435155412647374
val_acc_Waterbird: 0.7180451127819549
TRAIN ACC:        0.9949947862356622
VAL ACC:          0.8156797331109258
BALANCED VAL ACC: 0.7807803270233462
prev best list: ['best_balanced_valacc_0.78_epoch_153.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_154.ckpt
EPOCH: 155

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.38it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.95it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.81it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.91it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.99it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.06it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.07it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.06it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.06it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.07it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.07it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.07it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.07it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.06it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.06it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.06it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.08it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.26it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.69it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.86it/s]
100%|██████████| 13/13 [00:03<00:00,  6.02it/s]
100%|██████████| 13/13 [00:03<00:00,  3.95it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9931178310740355
val_acc: 0.8165137614678899
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.027268047213197002
val_cls_loss: 0.5078025603289401
train_total_loss: 0.6823041771698793
val_total_loss: 0.5078025603289401
test_abn_acc: 0
balanced_train_acc: 0.9870558453670586
balanced_val_acc: 0.7813162327039465
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.6974248927038627
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.48872180451127817
Water_on_Water_train_acc: 0.9820245979186376
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5963776331251183
train_abn_att_clip_vit_loss: 0.05865849502330279
train_acc_Landbird: 0.9983704508419338
train_acc_Waterbird: 0.9757412398921833
val_acc_Landbird: 0.8445873526259379
val_acc_Waterbird: 0.7180451127819549
TRAIN ACC:        0.9931178310740355
VAL ACC:          0.8165137614678899
BALANCED VAL ACC: 0.7813162327039465
prev best list: ['best_balanced_valacc_0.78_epoch_154.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_155.ckpt
EPOCH: 156

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.94it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.26it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.64it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.87it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.89it/s]
 30%|███       | 15/50 [00:04<00:08,  3.90it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.03it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.06it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.10it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.12it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.12it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.12it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.11it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.07it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.07it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.09it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.01it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.39it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.11it/s]
100%|██████████| 13/13 [00:03<00:00,  6.28it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9954118873826903
val_acc: 0.8181818181818182
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02300495245533765
val_cls_loss: 0.5027499772092519
train_total_loss: 0.6764657856525544
val_total_loss: 0.5027499772092519
test_abn_acc: 0
balanced_train_acc: 0.9910571230429184
balanced_val_acc: 0.7823880440651468
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.7017167381974249
Water_on_Land_train_acc: 0.8928571428571429
Water_on_Land_val_acc: 0.48872180451127817
Water_on_Water_train_acc: 0.9877010406811731
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5948176152514715
train_abn_att_clip_vit_loss: 0.05864321716650311
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9829290206648698
val_acc_Landbird: 0.8467309753483387
val_acc_Waterbird: 0.7180451127819549
TRAIN ACC:        0.9954118873826903
VAL ACC:          0.8181818181818182
BALANCED VAL ACC: 0.7823880440651468
prev best list: ['best_balanced_valacc_0.78_epoch_155.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.78_epoch_156.ckpt
EPOCH: 157

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.63it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.76it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.90it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.99it/s]
 28%|██▊       | 14/50 [00:04<00:09,  4.00it/s]
 30%|███       | 15/50 [00:04<00:08,  4.03it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.05it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.04it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.06it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.10it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.11it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.08it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.08it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.08it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.08it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.09it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.12it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.32it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.43it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.57it/s]
100%|██████████| 13/13 [00:03<00:00,  5.61it/s]
100%|██████████| 13/13 [00:03<00:00,  3.86it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9958289885297185
val_acc: 0.8165137614678899
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02338161964408424
val_cls_loss: 0.5206075996980755
train_total_loss: 0.6775709879286471
val_total_loss: 0.5206075996980755
test_abn_acc: 0
balanced_train_acc: 0.9916421551043835
balanced_val_acc: 0.792066581244107
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.6845493562231759
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.5488721804511278
Water_on_Water_train_acc: 0.9895931882686849
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5955959574398084
train_abn_att_clip_vit_loss: 0.05859341576415754
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9838274932614556
val_acc_Landbird: 0.8360128617363344
val_acc_Waterbird: 0.7481203007518797
TRAIN ACC:        0.9958289885297185
VAL ACC:          0.8165137614678899
BALANCED VAL ACC: 0.792066581244107
prev best list: ['best_balanced_valacc_0.78_epoch_156.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.79_epoch_157.ckpt
EPOCH: 158

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.37it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.96it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.83it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.78it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.02it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.04it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.03it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.02it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.92it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.94it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.01it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.62it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.80it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.15it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.63it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.80it/s]
100%|██████████| 13/13 [00:03<00:00,  5.94it/s]
100%|██████████| 13/13 [00:03<00:00,  3.87it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9937434827945777
val_acc: 0.8065054211843202
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.024687585160835444
val_cls_loss: 0.5378136461083346
train_total_loss: 0.6784862646842773
val_total_loss: 0.5378136461083346
test_abn_acc: 0
balanced_train_acc: 0.9874632326565751
balanced_val_acc: 0.7856357130769045
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.6587982832618026
Water_on_Land_train_acc: 0.7857142857142857
Water_on_Land_val_acc: 0.5488721804511278
Water_on_Water_train_acc: 0.9858088930936613
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5952374815567939
train_abn_att_clip_vit_loss: 0.05856119756265402
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9757412398921833
val_acc_Landbird: 0.8231511254019293
val_acc_Waterbird: 0.7481203007518797
TRAIN ACC:        0.9937434827945777
VAL ACC:          0.8065054211843202
BALANCED VAL ACC: 0.7856357130769045
EPOCH: 159

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.94it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.94it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.95it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.96it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.96it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.77it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.94it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.72it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.87it/s]
100%|██████████| 13/13 [00:03<00:00,  6.05it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9935349322210636
val_acc: 0.8223519599666389
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.026540092015260204
val_cls_loss: 0.48902139121090205
train_total_loss: 0.6811455024668521
val_total_loss: 0.48902139121090205
test_abn_acc: 0
balanced_train_acc: 0.9873274368934029
balanced_val_acc: 0.7810361917655876
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.7188841201716738
Water_on_Land_train_acc: 0.8571428571428571
Water_on_Land_val_acc: 0.46616541353383456
Water_on_Water_train_acc: 0.9820245979186376
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5960812270579174
train_abn_att_clip_vit_loss: 0.05852418703971988
train_acc_Landbird: 0.9989136338946225
train_acc_Waterbird: 0.9757412398921833
val_acc_Landbird: 0.8553054662379421
val_acc_Waterbird: 0.706766917293233
TRAIN ACC:        0.9935349322210636
VAL ACC:          0.8223519599666389
BALANCED VAL ACC: 0.7810361917655876
EPOCH: 160

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.71it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.85it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.92it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.01it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.02it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.02it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.01it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.05it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.05it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.02it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.01it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.02it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.02it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.97it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.11s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.11it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.46it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.00it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.16it/s]
100%|██████████| 13/13 [00:02<00:00,  6.40it/s]
100%|██████████| 13/13 [00:03<00:00,  4.24it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9941605839416059
val_acc: 0.8140116763969975
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02431684291190288
val_cls_loss: 0.5144883248336719
train_total_loss: 0.6778817140024322
val_total_loss: 0.5144883248336719
test_abn_acc: 0
balanced_train_acc: 0.9899289079287645
balanced_val_acc: 0.782396102797186
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9728260869565217
Land_on_Water_val_acc: 0.6909871244635193
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.5037593984962406
Water_on_Water_train_acc: 0.9877010406811731
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.595072217716042
train_abn_att_clip_vit_loss: 0.05849265769450334
train_acc_Landbird: 0.997827267789245
train_acc_Waterbird: 0.9820305480682839
val_acc_Landbird: 0.8392282958199357
val_acc_Waterbird: 0.7255639097744361
TRAIN ACC:        0.9941605839416059
VAL ACC:          0.8140116763969975
BALANCED VAL ACC: 0.782396102797186
EPOCH: 161

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.95it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.94it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.94it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.94it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.94it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.95it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.94it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.94it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.94it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.94it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.95it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.97it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.10it/s]
100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9960375391032326
val_acc: 0.8206839032527106
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.023853937023328043
val_cls_loss: 0.5019292780714695
train_total_loss: 0.6775104841052305
val_total_loss: 0.5019292780714695
test_abn_acc: 0
balanced_train_acc: 0.9914645103324349
balanced_val_acc: 0.7839957611069475
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.7081545064377682
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.48872180451127817
Water_on_Water_train_acc: 0.988647114474929
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5951990716524492
train_abn_att_clip_vit_loss: 0.05845748434412343
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9829290206648698
val_acc_Landbird: 0.84994640943194
val_acc_Waterbird: 0.7180451127819549
TRAIN ACC:        0.9960375391032326
VAL ACC:          0.8206839032527106
BALANCED VAL ACC: 0.7839957611069475
EPOCH: 162

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.02it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.03it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.01it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.03it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.01it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.01it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.04it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  4.00it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.98it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.94it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.93it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.95it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.98it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.09it/s]
100%|██████████| 13/13 [00:03<00:00,  6.26it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9964546402502606
val_acc: 0.8140116763969975
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02059596137641866
val_cls_loss: 0.5294867633555311
train_total_loss: 0.6725886756734878
val_total_loss: 0.5294867633555311
test_abn_acc: 0
balanced_train_acc: 0.9926764234641414
balanced_val_acc: 0.7918026577698265
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.6759656652360515
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9914853358561968
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5935642771477246
train_abn_att_clip_vit_loss: 0.058428438024923625
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9856244384546271
val_acc_Landbird: 0.8317256162915327
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9964546402502606
VAL ACC:          0.8140116763969975
BALANCED VAL ACC: 0.7918026577698265
EPOCH: 163

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:03,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.54it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.64it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.80it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.84it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.85it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.93it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.97it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.98it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.01it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.03it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.08it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.77it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  4.00it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.17it/s]
100%|██████████| 13/13 [00:03<00:00,  6.35it/s]
100%|██████████| 13/13 [00:03<00:00,  4.16it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9960375391032326
val_acc: 0.8181818181818182
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.021745754492481756
val_cls_loss: 0.5034981751014432
train_total_loss: 0.6746839520083479
val_total_loss: 0.5034981751014432
test_abn_acc: 0
balanced_train_acc: 0.9930317130080384
balanced_val_acc: 0.7823880440651468
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.703862660944206
Water_on_Land_train_acc: 0.9107142857142857
Water_on_Land_val_acc: 0.48872180451127817
Water_on_Water_train_acc: 0.9914853358561968
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5945609527782802
train_abn_att_clip_vit_loss: 0.058377248781409825
train_acc_Landbird: 0.9986420423682781
train_acc_Waterbird: 0.9874213836477987
val_acc_Landbird: 0.8467309753483387
val_acc_Waterbird: 0.7180451127819549
TRAIN ACC:        0.9960375391032326
VAL ACC:          0.8181818181818182
BALANCED VAL ACC: 0.7823880440651468
EPOCH: 164

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:03,  1.29s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.07it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.88it/s]
 30%|███       | 15/50 [00:04<00:08,  3.92it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.01it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.03it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.05it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.06it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.08it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.05it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.08it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.10it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.25s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.53it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.03it/s]
100%|██████████| 13/13 [00:03<00:00,  6.31it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9962460896767467
val_acc: 0.8140116763969975
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02035004933431698
val_cls_loss: 0.5311298198730773
train_total_loss: 0.6722844959797029
val_total_loss: 0.5311298198730773
test_abn_acc: 0
balanced_train_acc: 0.9925406277009692
balanced_val_acc: 0.7918026577698265
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.6759656652360515
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.988647114474929
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5935846231279582
train_abn_att_clip_vit_loss: 0.05834982961307477
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9856244384546271
val_acc_Landbird: 0.8317256162915327
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9962460896767467
VAL ACC:          0.8140116763969975
BALANCED VAL ACC: 0.7918026577698265
EPOCH: 165

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.61it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.81it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.95it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.96it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.94it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.95it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.96it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.09it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.44it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.92it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.17it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9962460896767467
val_acc: 0.8240200166805671
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.019242016338316938
val_cls_loss: 0.5068487080561309
train_total_loss: 0.6704644000940452
val_total_loss: 0.5068487080561309
test_abn_acc: 0
balanced_train_acc: 0.9928540682360899
balanced_val_acc: 0.7942021452344687
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.7060085836909872
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.5338345864661654
Water_on_Water_train_acc: 0.9924314096499527
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5929005783715512
train_abn_att_clip_vit_loss: 0.05832180401409381
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9865229110512129
val_acc_Landbird: 0.8478027867095391
val_acc_Waterbird: 0.7406015037593985
TRAIN ACC:        0.9962460896767467
VAL ACC:          0.8240200166805671
BALANCED VAL ACC: 0.7942021452344687
prev best list: ['best_balanced_valacc_0.79_epoch_157.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.79_epoch_165.ckpt
EPOCH: 166

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.85it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.01it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.01it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.02it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.04it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.76it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.96it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.14it/s]
100%|██████████| 13/13 [00:03<00:00,  6.32it/s]
100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.994577685088634
val_acc: 0.817347789824854
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02145167991161595
val_cls_loss: 0.5234167410668181
train_total_loss: 0.673220228514905
val_total_loss: 0.5234167410668181
test_abn_acc: 0
balanced_train_acc: 0.9892601778497467
balanced_val_acc: 0.7939462804922273
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.6845493562231759
Water_on_Land_train_acc: 0.875
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9848628192999054
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5934778241345482
train_abn_att_clip_vit_loss: 0.058290719471646546
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9793351302785265
val_acc_Landbird: 0.8360128617363344
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.994577685088634
VAL ACC:          0.817347789824854
BALANCED VAL ACC: 0.7939462804922273
EPOCH: 167

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.97it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.46it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.13it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.34it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.52it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.63it/s]
 20%|██        | 10/50 [00:03<00:10,  3.71it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.76it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.83it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.85it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.86it/s]
 30%|███       | 15/50 [00:04<00:09,  3.88it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.03it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.05it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.05it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.03it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.92it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.93it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.93it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.91it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.94it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.94it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.00it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.03it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.03it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.06it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.10it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.80it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.14it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.66it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.84it/s]
100%|██████████| 13/13 [00:03<00:00,  5.97it/s]
100%|██████████| 13/13 [00:03<00:00,  3.87it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9960375391032326
val_acc: 0.8198498748957465
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02143940613367153
val_cls_loss: 0.5137930770681937
train_total_loss: 0.6731270738513179
val_total_loss: 0.5137930770681937
test_abn_acc: 0
balanced_train_acc: 0.9930317130080384
balanced_val_acc: 0.795553997534028
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.6909871244635193
Water_on_Land_train_acc: 0.9107142857142857
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9914853358561968
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5934497880612474
train_abn_att_clip_vit_loss: 0.05823788155604453
train_acc_Landbird: 0.9986420423682781
train_acc_Waterbird: 0.9874213836477987
val_acc_Landbird: 0.8392282958199357
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9960375391032326
VAL ACC:          0.8198498748957465
BALANCED VAL ACC: 0.795553997534028
prev best list: ['best_balanced_valacc_0.79_epoch_165.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_167.ckpt
EPOCH: 168

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.03it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.07it/s]
 30%|███       | 15/50 [00:04<00:08,  4.09it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.12it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.11it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.12it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.12it/s]
 40%|████      | 20/50 [00:06<00:07,  4.13it/s]
 42%|████▏     | 21/50 [00:06<00:06,  4.15it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.13it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.11it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.12it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.14it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.13it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.12it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.14it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.13it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.06it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.04it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.92it/s]
 80%|████████  | 40/50 [00:10<00:02,  3.91it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.93it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.93it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.93it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  3.95it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.95it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.94it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.92it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.93it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.94it/s]
100%|██████████| 50/50 [00:13<00:00,  3.98it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.68it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  3.94it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.67it/s]
 77%|███████▋  | 10/13 [00:03<00:00,  4.16it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.57it/s]
100%|██████████| 13/13 [00:03<00:00,  3.88it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9964546402502606
val_acc: 0.8148457047539617
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.020921347773127933
val_cls_loss: 0.5254403970284299
train_total_loss: 0.6727153138274072
val_total_loss: 0.5254403970284299
test_abn_acc: 0
balanced_train_acc: 0.9933033045343829
balanced_val_acc: 0.7936823570179468
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.6759656652360515
Water_on_Land_train_acc: 0.9107142857142857
Water_on_Land_val_acc: 0.5639097744360902
Water_on_Water_train_acc: 0.9914853358561968
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5935732391877517
train_abn_att_clip_vit_loss: 0.05822072448723632
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9874213836477987
val_acc_Landbird: 0.8317256162915327
val_acc_Waterbird: 0.7556390977443609
TRAIN ACC:        0.9964546402502606
VAL ACC:          0.8148457047539617
BALANCED VAL ACC: 0.7936823570179468
EPOCH: 169

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.74it/s]
 20%|██        | 10/50 [00:03<00:10,  3.82it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.87it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.96it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.05it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.03it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.02it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.02it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.95it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.98it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.01it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.92it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.91it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.90it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.94it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.94it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.01it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.05it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.97it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.94it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.61it/s]
 31%|███       | 4/13 [00:01<00:02,  3.22it/s]
 38%|███▊      | 5/13 [00:02<00:03,  2.61it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.22it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.78it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  5.06it/s]
100%|██████████| 13/13 [00:03<00:00,  6.08it/s]
100%|██████████| 13/13 [00:03<00:00,  3.85it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997497393117831
val_acc: 0.8240200166805671
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.018424174807989063
val_cls_loss: 0.5075883701431244
train_total_loss: 0.6690288590688775
val_total_loss: 0.5075883701431244
test_abn_acc: 0
balanced_train_acc: 0.9946091644204852
balanced_val_acc: 0.7942021452344687
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.7060085836909872
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.5338345864661654
Water_on_Water_train_acc: 0.9914853358561968
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5924236917023366
train_abn_att_clip_vit_loss: 0.058180991410276814
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9892183288409704
val_acc_Landbird: 0.8478027867095391
val_acc_Waterbird: 0.7406015037593985
TRAIN ACC:        0.997497393117831
VAL ACC:          0.8240200166805671
BALANCED VAL ACC: 0.7942021452344687
EPOCH: 170

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.34it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.94it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.44it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.63it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.92it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.98it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.02it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.04it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.06it/s]
 40%|████      | 20/50 [00:06<00:07,  4.02it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.95it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.92it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.91it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.92it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.92it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.91it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.91it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.91it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.92it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.92it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.91it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.92it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.91it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.91it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.92it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.93it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.00it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 15%|█▌        | 2/13 [00:01<00:06,  1.82it/s]
 31%|███       | 4/13 [00:01<00:02,  3.84it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.76it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.30it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.84it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.06it/s]
100%|██████████| 13/13 [00:03<00:00,  6.25it/s]
100%|██████████| 13/13 [00:03<00:00,  3.98it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9979144942648592
val_acc: 0.8073394495412844
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01861953659719235
val_cls_loss: 0.546407176851232
train_total_loss: 0.669335244942507
val_total_loss: 0.546407176851232
test_abn_acc: 0
balanced_train_acc: 0.995507637017071
balanced_val_acc: 0.7888592058925449
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9850107066381156
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.6587982832618026
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.5639097744360902
Water_on_Water_train_acc: 0.9933774834437086
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5925733858651488
train_abn_att_clip_vit_loss: 0.058142325954125246
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9910152740341419
val_acc_Landbird: 0.8220793140407289
val_acc_Waterbird: 0.7556390977443609
TRAIN ACC:        0.9979144942648592
VAL ACC:          0.8073394495412844
BALANCED VAL ACC: 0.7888592058925449
EPOCH: 171

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.84it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.64it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.76it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.06it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.10it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.11it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.06it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.04it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.05it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.08it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.09it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.10it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.09it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.98it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  3.95it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.95it/s]
100%|██████████| 50/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:16,  1.34s/it]
 23%|██▎       | 3/13 [00:01<00:04,  2.44it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.80it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.13it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.71it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.89it/s]
100%|██████████| 13/13 [00:03<00:00,  5.96it/s]
100%|██████████| 13/13 [00:03<00:00,  3.81it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9962460896767467
val_acc: 0.8281901584653878
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02019524301040036
val_cls_loss: 0.4866430605819963
train_total_loss: 0.6710846117067387
val_total_loss: 0.4866430605819963
test_abn_acc: 0
balanced_train_acc: 0.9922271871658485
balanced_val_acc: 0.7901627057998695
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7253218884120172
Water_on_Land_train_acc: 0.8928571428571429
Water_on_Land_val_acc: 0.49624060150375937
Water_on_Water_train_acc: 0.9895931882686849
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5927903167274126
train_abn_att_clip_vit_loss: 0.05809905726435411
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9847259658580413
val_acc_Landbird: 0.8585209003215434
val_acc_Waterbird: 0.7218045112781954
TRAIN ACC:        0.9962460896767467
VAL ACC:          0.8281901584653878
BALANCED VAL ACC: 0.7901627057998695
EPOCH: 172

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:12,  1.47s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.33it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.93it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.44it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.62it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.74it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.04it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.09it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:06<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.10it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.11it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.12it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.12it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.11it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.12it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.12it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.13it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.13it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.12it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.12it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.12it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.14it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.14it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.14it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:15,  1.29s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.54it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.86it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.23it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.88it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.24it/s]
100%|██████████| 13/13 [00:03<00:00,  3.96it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997288842544317
val_acc: 0.8256880733944955
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01841827349599385
val_cls_loss: 0.4995672130107482
train_total_loss: 0.6688429013531698
val_total_loss: 0.4995672130107482
test_abn_acc: 0
balanced_train_acc: 0.9944733686573131
balanced_val_acc: 0.7925863694606291
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7145922746781116
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.518796992481203
Water_on_Water_train_acc: 0.9924314096499527
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5923618662469206
train_abn_att_clip_vit_loss: 0.05806276526795438
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9892183288409704
val_acc_Landbird: 0.8520900321543409
val_acc_Waterbird: 0.7330827067669173
TRAIN ACC:        0.997288842544317
VAL ACC:          0.8256880733944955
BALANCED VAL ACC: 0.7925863694606291
EPOCH: 173

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:12,  1.49s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.33it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.93it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.45it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.65it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.76it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.00it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.04it/s]
 30%|███       | 15/50 [00:04<00:08,  4.08it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.11it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.12it/s]
 40%|████      | 20/50 [00:06<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.12it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.11it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.12it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.13it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.12it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.12it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.13it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.15it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.15it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.13it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.12it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.13it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.12it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.13it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.12it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.12it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.11it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.13it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.12it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:16,  1.36s/it]
 23%|██▎       | 3/13 [00:01<00:04,  2.39it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.72it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.02it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.76it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.92it/s]
100%|██████████| 13/13 [00:03<00:00,  6.09it/s]
100%|██████████| 13/13 [00:03<00:00,  3.83it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9968717413972888
val_acc: 0.8181818181818182
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01928021373291334
val_cls_loss: 0.5215521668075421
train_total_loss: 0.6689824738020196
val_total_loss: 0.5215521668075421
test_abn_acc: 0
balanced_train_acc: 0.9932614555256065
balanced_val_acc: 0.7944821861728275
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.6866952789699571
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9895931882686849
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5916543135056281
train_abn_att_clip_vit_loss: 0.05804794500810138
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9865229110512129
val_acc_Landbird: 0.8370846730975349
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9968717413972888
VAL ACC:          0.8181818181818182
BALANCED VAL ACC: 0.7944821861728275
EPOCH: 174

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:12,  1.48s/it]
  4%|▍         | 2/50 [00:01<00:36,  1.33it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.90it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.39it/s]
 10%|█         | 5/50 [00:02<00:16,  2.79it/s]
 12%|█▏        | 6/50 [00:02<00:14,  3.12it/s]
 14%|█▍        | 7/50 [00:03<00:14,  2.96it/s]
 16%|█▌        | 8/50 [00:03<00:13,  3.21it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.42it/s]
 20%|██        | 10/50 [00:03<00:11,  3.59it/s]
 22%|██▏       | 11/50 [00:04<00:10,  3.70it/s]
 24%|██▍       | 12/50 [00:04<00:10,  3.78it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.84it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.86it/s]
 30%|███       | 15/50 [00:05<00:08,  3.89it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:06<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.01it/s]
 46%|████▌     | 23/50 [00:07<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:08<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.01it/s]
 62%|██████▏   | 31/50 [00:09<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:10<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.02it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.01it/s]
 78%|███████▊  | 39/50 [00:11<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.04it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.01it/s]
 86%|████████▌ | 43/50 [00:12<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.04it/s]
 94%|█████████▍| 47/50 [00:13<00:00,  4.05it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.05it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  3.58it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.95it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.36it/s]
100%|██████████| 13/13 [00:03<00:00,  4.13it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9949947862356622
val_acc: 0.8256880733944955
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02053782143926285
val_cls_loss: 0.5031575129691316
train_total_loss: 0.6716935185868996
val_total_loss: 0.5031575129691316
test_abn_acc: 0
balanced_train_acc: 0.9907855315165739
balanced_val_acc: 0.7952739565956692
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9782608695652174
Land_on_Water_val_acc: 0.7103004291845494
Water_on_Land_train_acc: 0.8392857142857143
Water_on_Land_val_acc: 0.5338345864661654
Water_on_Water_train_acc: 0.9905392620624409
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.593168793803584
train_abn_att_clip_vit_loss: 0.05798690482212679
train_acc_Landbird: 0.9986420423682781
train_acc_Waterbird: 0.9829290206648698
val_acc_Landbird: 0.84994640943194
val_acc_Waterbird: 0.7406015037593985
TRAIN ACC:        0.9949947862356622
VAL ACC:          0.8256880733944955
BALANCED VAL ACC: 0.7952739565956692
EPOCH: 175

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:03,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.07it/s]
  8%|▊         | 4/50 [00:02<00:17,  2.56it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.62it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.72it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.94it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.95it/s]
 40%|████      | 20/50 [00:06<00:07,  3.96it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.97it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.94it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.99it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.02it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.01it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.01it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.01it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.04it/s]
100%|██████████| 50/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.41it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.80it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.91it/s]
100%|██████████| 13/13 [00:03<00:00,  6.15it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9962460896767467
val_acc: 0.8273561301084237
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.018511838107772863
val_cls_loss: 0.502825983421717
train_total_loss: 0.6678623210277498
val_total_loss: 0.502825983421717
test_abn_acc: 0
balanced_train_acc: 0.9925406277009692
balanced_val_acc: 0.7976895615243897
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.7124463519313304
Water_on_Land_train_acc: 0.8928571428571429
Water_on_Land_val_acc: 0.5413533834586466
Water_on_Water_train_acc: 0.9905392620624409
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5913788354309806
train_abn_att_clip_vit_loss: 0.05797164843216678
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9856244384546271
val_acc_Landbird: 0.8510182207931404
val_acc_Waterbird: 0.7443609022556391
TRAIN ACC:        0.9962460896767467
VAL ACC:          0.8273561301084237
BALANCED VAL ACC: 0.7976895615243897
prev best list: ['best_balanced_valacc_0.8_epoch_167.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_175.ckpt
EPOCH: 176

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.37s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.90it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  4.00it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.03it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.04it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.10it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.11it/s]
 40%|████      | 20/50 [00:06<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.06it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.05it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.07it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.05it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.00it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.98it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.01it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.00it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.02it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.13s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.78it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.79it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.93it/s]
100%|██████████| 13/13 [00:03<00:00,  6.12it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9966631908237747
val_acc: 0.8165137614678899
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.018642139866777208
val_cls_loss: 0.5350198481011331
train_total_loss: 0.6689877291789766
val_total_loss: 0.5350198481011331
test_abn_acc: 0
balanced_train_acc: 0.9937525408326757
balanced_val_acc: 0.7934103748116271
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.6824034334763949
Water_on_Land_train_acc: 0.9107142857142857
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9924314096499527
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5924224279968532
train_abn_att_clip_vit_loss: 0.0579231611887096
train_acc_Landbird: 0.9991852254209669
train_acc_Waterbird: 0.9883198562443846
val_acc_Landbird: 0.834941050375134
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9966631908237747
VAL ACC:          0.8165137614678899
BALANCED VAL ACC: 0.7934103748116271
EPOCH: 177

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.95it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.26it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.49it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.66it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.79it/s]
 20%|██        | 10/50 [00:03<00:10,  3.88it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.04it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.06it/s]
 32%|███▏      | 16/50 [00:04<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:05<00:07,  4.09it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.11it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.10it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.09it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.10it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.09it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.10it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.09it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.09it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.09it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.11it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.12it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.10it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.08it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.10it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.13it/s]
100%|██████████| 50/50 [00:13<00:00,  3.74it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.19s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.68it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.99it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.39it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.83it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.99it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9966631908237747
val_acc: 0.8298582151793161
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.019040977745098418
val_cls_loss: 0.4881462780657761
train_total_loss: 0.6690737110979241
val_total_loss: 0.4881462780657761
test_abn_acc: 0
balanced_train_acc: 0.9946928624380378
balanced_val_acc: 0.7898907235935498
Land_on_Land_train_acc: 0.9988564894225271
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.7296137339055794
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.48872180451127817
Water_on_Water_train_acc: 0.9943235572374646
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5921535627063795
train_abn_att_clip_vit_loss: 0.05787916694368635
train_acc_Landbird: 0.9983704508419338
train_acc_Waterbird: 0.9910152740341419
val_acc_Landbird: 0.8617363344051447
val_acc_Waterbird: 0.7180451127819549
TRAIN ACC:        0.9966631908237747
VAL ACC:          0.8298582151793161
BALANCED VAL ACC: 0.7898907235935498
EPOCH: 178

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.74it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.81it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.99it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.95it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.94it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.90it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.90it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.92it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.94it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.92it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.93it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.94it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.92it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.93it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.94it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.93it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.00it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.00it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.03it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.91it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  6.35it/s]
100%|██████████| 13/13 [00:03<00:00,  4.16it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9956204379562044
val_acc: 0.8248540450375312
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.02066368236283192
val_cls_loss: 0.5176607815920063
train_total_loss: 0.6708678334050183
val_total_loss: 0.5176607815920063
test_abn_acc: 0
balanced_train_acc: 0.9921332404114527
balanced_val_acc: 0.7974256380501092
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9836956521739131
Land_on_Water_val_acc: 0.703862660944206
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.5488721804511278
Water_on_Water_train_acc: 0.988647114474929
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5923673110535297
train_abn_att_clip_vit_loss: 0.05783683729199722
train_acc_Landbird: 0.9986420423682781
train_acc_Waterbird: 0.9856244384546271
val_acc_Landbird: 0.8467309753483387
val_acc_Waterbird: 0.7481203007518797
TRAIN ACC:        0.9956204379562044
VAL ACC:          0.8248540450375312
BALANCED VAL ACC: 0.7974256380501092
EPOCH: 179

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.98it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.47it/s]
 10%|█         | 5/50 [00:02<00:15,  2.85it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.95it/s]
 30%|███       | 15/50 [00:04<00:08,  3.93it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.92it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.95it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.95it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.02it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.96it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.03it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.01it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.01it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.04it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.02it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.04it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.06it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.97it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.97it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.95it/s]
100%|██████████| 50/50 [00:13<00:00,  3.94it/s]
100%|██████████| 50/50 [00:13<00:00,  3.63it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.66it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.02it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.43it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.94it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.49it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.81it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997497393117831
val_acc: 0.8265221017514596
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01650360312227381
val_cls_loss: 0.511737677556858
train_total_loss: 0.6650889385728568
val_total_loss: 0.511737677556858
test_abn_acc: 0
balanced_train_acc: 0.9946091644204852
balanced_val_acc: 0.7998412429788297
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.7060085836909872
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9914853358561968
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5907799337777903
train_abn_att_clip_vit_loss: 0.057805401721543886
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9892183288409704
val_acc_Landbird: 0.8478027867095391
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.997497393117831
VAL ACC:          0.8265221017514596
BALANCED VAL ACC: 0.7998412429788297
prev best list: ['best_balanced_valacc_0.8_epoch_175.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_179.ckpt
EPOCH: 180

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.96it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.28it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.50it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.69it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.76it/s]
 20%|██        | 10/50 [00:03<00:10,  3.83it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  4.00it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.07it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.09it/s]
 40%|████      | 20/50 [00:06<00:07,  4.10it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.09it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.08it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.08it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.09it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.10it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.10it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.12it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.12it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.13it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.12it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.11it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.13it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.12it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.11it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.12it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.13it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.13it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.17it/s]
100%|██████████| 50/50 [00:13<00:00,  3.73it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.21s/it]
 15%|█▌        | 2/13 [00:01<00:06,  1.79it/s]
 31%|███       | 4/13 [00:01<00:02,  3.81it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.54it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.04it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.33it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.71it/s]
100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9954118873826903
val_acc: 0.8115095913261051
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01970341769090783
val_cls_loss: 0.5478359691245641
train_total_loss: 0.6697571884230852
val_total_loss: 0.5478359691245641
test_abn_acc: 0
balanced_train_acc: 0.9919974446482804
balanced_val_acc: 0.791538734295546
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9728260869565217
Land_on_Water_val_acc: 0.6673819742489271
Water_on_Land_train_acc: 0.9107142857142857
Water_on_Land_val_acc: 0.5639097744360902
Water_on_Water_train_acc: 0.9895931882686849
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5922916884715664
train_abn_att_clip_vit_loss: 0.05776208129413309
train_acc_Landbird: 0.9983704508419338
train_acc_Waterbird: 0.9856244384546271
val_acc_Landbird: 0.827438370846731
val_acc_Waterbird: 0.7556390977443609
TRAIN ACC:        0.9954118873826903
VAL ACC:          0.8115095913261051
BALANCED VAL ACC: 0.791538734295546
EPOCH: 181

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.86it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.87it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.95it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.05it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.97it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.99it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.01it/s]
 40%|████      | 20/50 [00:06<00:07,  4.02it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.04it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.03it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.03it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.04it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.04it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.04it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.06it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.06it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.09it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.10it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.10it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.09it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.06it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.06it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.04it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.06it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.07it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.09it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.33it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.79it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.03it/s]
 92%|█████████▏| 12/13 [00:03<00:00,  5.38it/s]
100%|██████████| 13/13 [00:03<00:00,  3.95it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9983315954118874
val_acc: 0.8156797331109258
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.017302830924005155
val_cls_loss: 0.5359704124495027
train_total_loss: 0.6661499336066659
val_total_loss: 0.5359704124495027
test_abn_acc: 0
balanced_train_acc: 0.9967195501487776
balanced_val_acc: 0.7928744691310269
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.6802575107296137
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9971617786187322
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5911260797656739
train_abn_att_clip_vit_loss: 0.05772101973825376
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9937106918238994
val_acc_Landbird: 0.8338692390139335
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9983315954118874
VAL ACC:          0.8156797331109258
BALANCED VAL ACC: 0.7928744691310269
EPOCH: 182

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.00it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.24it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.76it/s]
 20%|██        | 10/50 [00:03<00:10,  3.88it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.94it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.99it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.93it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.99it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.94it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.97it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.94it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.94it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.94it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.94it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.92it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.92it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.95it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.95it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.93it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.93it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.96it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.96it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.94it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.94it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.96it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.94it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.94it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.95it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.95it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.93it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.92it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.95it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.97it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.96it/s]
100%|██████████| 50/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.10s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.82it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.11it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.44it/s]
 69%|██████▉   | 9/13 [00:02<00:00,  4.00it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.11it/s]
100%|██████████| 13/13 [00:02<00:00,  6.44it/s]
100%|██████████| 13/13 [00:03<00:00,  4.26it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997497393117831
val_acc: 0.8081734778982486
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.017986277136582653
val_cls_loss: 0.5542367148936242
train_total_loss: 0.66736223434134
val_total_loss: 0.5542367148936242
test_abn_acc: 0
balanced_train_acc: 0.9952360454907265
balanced_val_acc: 0.7907389051406652
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.6566523605150214
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.5714285714285714
Water_on_Water_train_acc: 0.9933774834437086
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5917003363712736
train_abn_att_clip_vit_loss: 0.057675625320147174
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9910152740341419
val_acc_Landbird: 0.8220793140407289
val_acc_Waterbird: 0.7593984962406015
TRAIN ACC:        0.997497393117831
VAL ACC:          0.8081734778982486
BALANCED VAL ACC: 0.7907389051406652
EPOCH: 183

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:17,  2.56it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.45it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.61it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.79it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.86it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.82it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.89it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.92it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.02it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.09it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.05it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.06it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.04it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.05it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.03it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.03it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.98it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.00it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.04it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.05it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.01it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.03it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.04it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.75it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.96it/s]
 77%|███████▋  | 10/13 [00:02<00:00,  4.49it/s]
 92%|█████████▏| 12/13 [00:02<00:00,  5.84it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997288842544317
val_acc: 0.8248540450375312
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.016755960039343838
val_cls_loss: 0.5166880396925677
train_total_loss: 0.6650775236556379
val_total_loss: 0.5166880396925677
test_abn_acc: 0
balanced_train_acc: 0.9944733686573131
balanced_val_acc: 0.7987694316176293
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.703862660944206
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9924314096499527
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5906804867407328
train_abn_att_clip_vit_loss: 0.05764108085859183
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9892183288409704
val_acc_Landbird: 0.8456591639871383
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.997288842544317
VAL ACC:          0.8248540450375312
BALANCED VAL ACC: 0.7987694316176293
EPOCH: 184

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.89it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.58it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.68it/s]
 20%|██        | 10/50 [00:03<00:10,  3.78it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.85it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.89it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.97it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.99it/s]
 40%|████      | 20/50 [00:06<00:07,  3.99it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.00it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.99it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.99it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.99it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.00it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.07it/s]
100%|██████████| 50/50 [00:13<00:00,  3.65it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.03it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.86it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.04it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997497393117831
val_acc: 0.8273561301084237
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.016620788703807576
val_cls_loss: 0.515498886638328
train_total_loss: 0.6643596545498861
val_total_loss: 0.515498886638328
test_abn_acc: 0
balanced_train_acc: 0.9949226049556059
balanced_val_acc: 0.8003771486594299
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7081545064377682
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9933774834437086
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5901218526927722
train_abn_att_clip_vit_loss: 0.057617012320457336
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9901168014375562
val_acc_Landbird: 0.8488745980707395
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.997497393117831
VAL ACC:          0.8273561301084237
BALANCED VAL ACC: 0.8003771486594299
prev best list: ['best_balanced_valacc_0.8_epoch_179.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_184.ckpt
EPOCH: 185

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.44it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.63it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.77it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.92it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.97it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.01it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.01it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.05it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.08it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.08it/s]
 40%|████      | 20/50 [00:06<00:07,  4.08it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.08it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.09it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.09it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.08it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.09it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.09it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.08it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.08it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.07it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.07it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.04it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.08it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.10it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.09it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.10it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.11it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.11it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.10it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.09it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.08it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.09it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.10it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.71it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.98it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.11it/s]
100%|██████████| 13/13 [00:03<00:00,  6.23it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997288842544317
val_acc: 0.8273561301084237
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.016059922634374363
val_cls_loss: 0.5158441038654684
train_total_loss: 0.6635645523682874
val_total_loss: 0.5158441038654684
test_abn_acc: 0
balanced_train_acc: 0.9947868091924337
balanced_val_acc: 0.8003771486594299
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7103004291845494
Water_on_Land_train_acc: 0.9107142857142857
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9943235572374646
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5899037943144909
train_abn_att_clip_vit_loss: 0.05760083335050701
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9901168014375562
val_acc_Landbird: 0.8488745980707395
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.997288842544317
VAL ACC:          0.8273561301084237
BALANCED VAL ACC: 0.8003771486594299
prev best list: ['best_balanced_valacc_0.8_epoch_184.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_185.ckpt
EPOCH: 186

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.18it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.90it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.92it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.97it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.96it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.96it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.95it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.97it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.98it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.97it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.98it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.98it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.99it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.99it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.92it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.29it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.89it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9983315954118874
val_acc: 0.8248540450375312
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.014964270148119414
val_cls_loss: 0.5179013486849059
train_total_loss: 0.6619142363541317
val_total_loss: 0.5179013486849059
test_abn_acc: 0
balanced_train_acc: 0.9964061096136567
balanced_val_acc: 0.7987694316176293
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.7017167381974249
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9952696310312205
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5893920297045901
train_abn_att_clip_vit_loss: 0.0575579374880997
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9928122192273136
val_acc_Landbird: 0.8456591639871383
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9983315954118874
VAL ACC:          0.8248540450375312
BALANCED VAL ACC: 0.7987694316176293
EPOCH: 187

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.36s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.90it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.43it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.59it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.88it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.93it/s]
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.96it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.97it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.98it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.99it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.99it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.99it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.98it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.98it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.99it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.02it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.03it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.05it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.05it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.03it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.02it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.01it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.22s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.60it/s]
 38%|███▊      | 5/13 [00:02<00:02,  2.86it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.15it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.62it/s]
 85%|████████▍ | 11/13 [00:03<00:00,  4.75it/s]
100%|██████████| 13/13 [00:03<00:00,  5.89it/s]
100%|██████████| 13/13 [00:03<00:00,  3.92it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9979144942648592
val_acc: 0.8340283569641368
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.015499224600006318
val_cls_loss: 0.48692996960266915
train_total_loss: 0.6629190940802239
val_total_loss: 0.48692996960266915
test_abn_acc: 0
balanced_train_acc: 0.995507637017071
balanced_val_acc: 0.7992892198341512
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.7317596566523605
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.5263157894736842
Water_on_Water_train_acc: 0.9943235572374646
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5898966283693801
train_abn_att_clip_vit_loss: 0.05752323964169798
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9910152740341419
val_acc_Landbird: 0.8617363344051447
val_acc_Waterbird: 0.7368421052631579
TRAIN ACC:        0.9979144942648592
VAL ACC:          0.8340283569641368
BALANCED VAL ACC: 0.7992892198341512
EPOCH: 188

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.45it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.20it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.70it/s]
 20%|██        | 10/50 [00:03<00:10,  3.77it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.80it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.85it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.00it/s]
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.07it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.09it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.07it/s]
 40%|████      | 20/50 [00:06<00:07,  4.07it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.06it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.03it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.01it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.96it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.91it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.02it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.05it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.05it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.05it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.06it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.07it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.06it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.06it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.07it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.07it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.07it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.08it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.11it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.11it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.67it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.21it/s]
100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997288842544317
val_acc: 0.8306922435362802
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.015345349562926387
val_cls_loss: 0.4948957659509204
train_total_loss: 0.6622448224220833
val_total_loss: 0.4948957659509204
test_abn_acc: 0
balanced_train_acc: 0.9947868091924337
balanced_val_acc: 0.7971455971117505
Land_on_Land_train_acc: 0.9997141223556318
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7253218884120172
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.5263157894736842
Water_on_Water_train_acc: 0.9933774834437086
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5894228021469554
train_abn_att_clip_vit_loss: 0.05747666665827768
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9901168014375562
val_acc_Landbird: 0.857449088960343
val_acc_Waterbird: 0.7368421052631579
TRAIN ACC:        0.997288842544317
VAL ACC:          0.8306922435362802
BALANCED VAL ACC: 0.7971455971117505
EPOCH: 189

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.40it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.02it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.47it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.78it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.02it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.04it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.07it/s]
 30%|███       | 15/50 [00:04<00:08,  4.09it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.11it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.09it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.07it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:05<00:07,  4.12it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.09it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.06it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.05it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.03it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.02it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.01it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.01it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.99it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.00it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.00it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.99it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.99it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.97it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.96it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.97it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.98it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.99it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.01it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.05it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.45it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.79it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.95it/s]
100%|██████████| 13/13 [00:03<00:00,  6.08it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9964546402502606
val_acc: 0.823185988323603
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.016580744883253378
val_cls_loss: 0.5316827406949853
train_total_loss: 0.6635415922489106
val_total_loss: 0.5316827406949853
test_abn_acc: 0
balanced_train_acc: 0.9939301856046243
balanced_val_acc: 0.799041413823949
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.6952789699570815
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.5639097744360902
Water_on_Water_train_acc: 0.9924314096499527
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5895099454552588
train_abn_att_clip_vit_loss: 0.05745090152427352
train_acc_Landbird: 0.9986420423682781
train_acc_Waterbird: 0.9892183288409704
val_acc_Landbird: 0.842443729903537
val_acc_Waterbird: 0.7556390977443609
TRAIN ACC:        0.9964546402502606
VAL ACC:          0.823185988323603
BALANCED VAL ACC: 0.799041413823949
EPOCH: 190

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.50it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.83it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.86it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.88it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.01it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.03it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.07it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.02it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.01it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.04it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.07it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.08it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.07it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.07it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.05it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.02it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.02it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.00it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.06it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.07it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.01it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.00it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.97it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.98it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.01it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.00it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.98it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.99it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.12s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.79it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.07it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.40it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.94it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.09it/s]
100%|██████████| 13/13 [00:03<00:00,  6.31it/s]
100%|██████████| 13/13 [00:03<00:00,  4.16it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9981230448383733
val_acc: 0.8140116763969975
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.015296355844888063
val_cls_loss: 0.5451416734410287
train_total_loss: 0.6628076541784285
val_total_loss: 0.5451416734410287
test_abn_acc: 0
balanced_train_acc: 0.9962703138504846
balanced_val_acc: 0.7944902449048667
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.6716738197424893
Water_on_Land_train_acc: 0.9642857142857143
Water_on_Land_val_acc: 0.5714285714285714
Water_on_Water_train_acc: 0.9943235572374646
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5901092857712874
train_abn_att_clip_vit_loss: 0.05740200863438304
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9928122192273136
val_acc_Landbird: 0.8295819935691319
val_acc_Waterbird: 0.7593984962406015
TRAIN ACC:        0.9981230448383733
VAL ACC:          0.8140116763969975
BALANCED VAL ACC: 0.7944902449048667
EPOCH: 191

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.32s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.05it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.91it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.21it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.69it/s]
 20%|██        | 10/50 [00:03<00:10,  3.76it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.84it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.89it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.91it/s]
 30%|███       | 15/50 [00:04<00:08,  3.94it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.94it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.96it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.93it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.93it/s]
 40%|████      | 20/50 [00:06<00:07,  3.93it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.97it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.96it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.98it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.97it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.95it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.95it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.97it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.96it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.96it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.98it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.01it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.00it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.96it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.94it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.98it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.99it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.00it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  4.00it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.99it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.00it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.64it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.15s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.73it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.90it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  5.79it/s]
100%|██████████| 13/13 [00:03<00:00,  3.99it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9983315954118874
val_acc: 0.8348623853211009
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.014329881668556968
val_cls_loss: 0.48168560402705535
train_total_loss: 0.6603831936594592
val_total_loss: 0.48168560402705535
test_abn_acc: 0
balanced_train_acc: 0.9967195501487776
balanced_val_acc: 0.7957937448121912
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9935760171306209
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7381974248927039
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.5037593984962406
Water_on_Water_train_acc: 0.9962157048249763
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5886772514881258
train_abn_att_clip_vit_loss: 0.057376054139871915
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9937106918238994
val_acc_Landbird: 0.8660235798499464
val_acc_Waterbird: 0.7255639097744361
TRAIN ACC:        0.9983315954118874
VAL ACC:          0.8348623853211009
BALANCED VAL ACC: 0.7957937448121912
EPOCH: 192

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:07,  1.38s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.39it/s]
  6%|▌         | 3/50 [00:01<00:23,  1.99it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.48it/s]
 10%|█         | 5/50 [00:02<00:15,  2.87it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.39it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.56it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.66it/s]
 20%|██        | 10/50 [00:03<00:10,  3.73it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.84it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.91it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.91it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.94it/s]
 30%|███       | 15/50 [00:04<00:08,  3.99it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:08,  4.00it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.02it/s]
 40%|████      | 20/50 [00:06<00:07,  4.01it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.01it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.03it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.04it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.08it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.09it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.06it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.05it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.03it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.01it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  4.00it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.93it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.95it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.95it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.92it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.90it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.92it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.95it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.91it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.91it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.92it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.92it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.90it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.90it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  3.93it/s]
100%|██████████| 50/50 [00:13<00:00,  3.96it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.18s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.65it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.04it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.37it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.95it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.39it/s]
100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9979144942648592
val_acc: 0.8323603002502085
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.014667773021072366
val_cls_loss: 0.49545197925834084
train_total_loss: 0.6611175801756484
val_total_loss: 0.49545197925834084
test_abn_acc: 0
balanced_train_acc: 0.9961345180873125
balanced_val_acc: 0.7982174084729509
Land_on_Land_train_acc: 0.9994282447112636
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.7274678111587983
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.5263157894736842
Water_on_Water_train_acc: 0.9952696310312205
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5891335514340087
train_abn_att_clip_vit_loss: 0.057316256623726816
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9928122192273136
val_acc_Landbird: 0.8595927116827439
val_acc_Waterbird: 0.7368421052631579
TRAIN ACC:        0.9979144942648592
VAL ACC:          0.8323603002502085
BALANCED VAL ACC: 0.7982174084729509
EPOCH: 193

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:08,  1.39s/it]
  4%|▍         | 2/50 [00:01<00:34,  1.41it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.52it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.25it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.67it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.80it/s]
 20%|██        | 10/50 [00:03<00:10,  3.89it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.95it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.02it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.99it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.01it/s]
 30%|███       | 15/50 [00:04<00:08,  3.99it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.99it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.98it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.98it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.98it/s]
 40%|████      | 20/50 [00:06<00:07,  3.98it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.96it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.95it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.97it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.96it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.96it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.95it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.97it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.96it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.96it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.99it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.97it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.97it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.03it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.07it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.06it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.03it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.02it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.04it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.03it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.02it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.03it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.06it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.14s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.81it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.35it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.93it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s]
100%|██████████| 13/13 [00:03<00:00,  6.41it/s]
100%|██████████| 13/13 [00:03<00:00,  4.17it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.997288842544317
val_acc: 0.8306922435362802
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01538663644875799
val_cls_loss: 0.5090129143302892
train_total_loss: 0.6616268773894365
val_total_loss: 0.5090129143302892
test_abn_acc: 0
balanced_train_acc: 0.9944733686573131
balanced_val_acc: 0.8025207713818308
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7167381974248928
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9924314096499527
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5889685579832951
train_abn_att_clip_vit_loss: 0.057271687022184055
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9892183288409704
val_acc_Landbird: 0.8531618435155413
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.997288842544317
VAL ACC:          0.8306922435362802
BALANCED VAL ACC: 0.8025207713818308
prev best list: ['best_balanced_valacc_0.8_epoch_185.ckpt']
Saving to trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_193.ckpt
EPOCH: 194

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:10,  1.43s/it]
  4%|▍         | 2/50 [00:01<00:35,  1.36it/s]
  6%|▌         | 3/50 [00:01<00:24,  1.93it/s]
  8%|▊         | 4/50 [00:02<00:19,  2.41it/s]
 10%|█         | 5/50 [00:02<00:16,  2.80it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.15it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.41it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.62it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.74it/s]
 20%|██        | 10/50 [00:03<00:10,  3.84it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.93it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.97it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.95it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.99it/s]
 30%|███       | 15/50 [00:04<00:08,  4.03it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.04it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.03it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.04it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.04it/s]
 40%|████      | 20/50 [00:06<00:07,  4.04it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.99it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.00it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.00it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.00it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.01it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.01it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.00it/s]
 60%|██████    | 30/50 [00:08<00:05,  4.00it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.01it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.02it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.03it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.03it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.02it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.03it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.04it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.04it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.05it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.07it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.07it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.03it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.07it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.09it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.07it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.07it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.10it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.10it/s]
100%|██████████| 50/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.74it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.97it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.34it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.84it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.00it/s]
100%|██████████| 13/13 [00:03<00:00,  6.20it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9981230448383733
val_acc: 0.823185988323603
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.013615889448723032
val_cls_loss: 0.5287868139567825
train_total_loss: 0.6590331889789968
val_total_loss: 0.5287868139567825
test_abn_acc: 0
balanced_train_acc: 0.9959568733153639
balanced_val_acc: 0.7976976202564288
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 1.0
Land_on_Water_val_acc: 0.6995708154506438
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9943235572374646
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5881544552455977
train_abn_att_clip_vit_loss: 0.057262846181893624
train_acc_Landbird: 1.0
train_acc_Waterbird: 0.9919137466307277
val_acc_Landbird: 0.8435155412647374
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9981230448383733
VAL ACC:          0.823185988323603
BALANCED VAL ACC: 0.7976976202564288
EPOCH: 195

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.44it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.04it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.55it/s]
 10%|█         | 5/50 [00:02<00:15,  2.95it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.26it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.48it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.68it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.81it/s]
 20%|██        | 10/50 [00:03<00:10,  3.92it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.96it/s]
 24%|██▍       | 12/50 [00:04<00:09,  4.00it/s]
 26%|██▌       | 13/50 [00:04<00:09,  4.03it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.03it/s]
 30%|███       | 15/50 [00:04<00:08,  4.03it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.01it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.05it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.06it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.10it/s]
 40%|████      | 20/50 [00:05<00:07,  4.11it/s]
 42%|████▏     | 21/50 [00:06<00:06,  4.14it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.14it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.13it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.12it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.11it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.12it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.13it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.14it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.13it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.13it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.13it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.11it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.10it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.12it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.11it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.12it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.13it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.12it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.10it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.06it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.09it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.09it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.08it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.10it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.11it/s]
100%|██████████| 50/50 [00:13<00:00,  4.15it/s]
100%|██████████| 50/50 [00:13<00:00,  3.74it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.72it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.94it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.28it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.81it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  4.98it/s]
100%|██████████| 13/13 [00:03<00:00,  6.16it/s]
100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9987486965589155
val_acc: 0.823185988323603
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.013396825488050768
val_cls_loss: 0.531072921858319
train_total_loss: 0.6589047092839501
val_total_loss: 0.531072921858319
test_abn_acc: 0
balanced_train_acc: 0.9976180227453633
balanced_val_acc: 0.7976976202564288
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.6995708154506438
Water_on_Land_train_acc: 0.9642857142857143
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9971617786187322
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5882910596566105
train_abn_att_clip_vit_loss: 0.05721682952843195
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.995507637017071
val_acc_Landbird: 0.8435155412647374
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9987486965589155
VAL ACC:          0.823185988323603
BALANCED VAL ACC: 0.7976976202564288
EPOCH: 196

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.53it/s]
 10%|█         | 5/50 [00:02<00:15,  2.93it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.23it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.46it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.63it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.74it/s]
 20%|██        | 10/50 [00:03<00:10,  3.85it/s]
 22%|██▏       | 11/50 [00:03<00:09,  3.91it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.97it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.98it/s]
 28%|██▊       | 14/50 [00:04<00:08,  4.01it/s]
 30%|███       | 15/50 [00:04<00:08,  4.04it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.06it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.06it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.08it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.06it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.06it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.08it/s]
 48%|████▊     | 24/50 [00:06<00:06,  4.11it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.09it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.07it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.05it/s]
 56%|█████▌    | 28/50 [00:07<00:05,  4.08it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.10it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.09it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.11it/s]
 64%|██████▍   | 32/50 [00:08<00:04,  4.12it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.11it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.09it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:09<00:03,  4.11it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.11it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.10it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.12it/s]
 80%|████████  | 40/50 [00:10<00:02,  4.15it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.14it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.13it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.13it/s]
 88%|████████▊ | 44/50 [00:11<00:01,  4.15it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.13it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.11it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.12it/s]
 96%|█████████▌| 48/50 [00:12<00:00,  4.14it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.12it/s]
100%|██████████| 50/50 [00:13<00:00,  4.16it/s]
100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.20s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.68it/s]
 38%|███▊      | 5/13 [00:01<00:02,  2.96it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.26it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.87it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.07it/s]
100%|██████████| 13/13 [00:03<00:00,  6.24it/s]
100%|██████████| 13/13 [00:03<00:00,  4.08it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9979144942648592
val_acc: 0.8156797331109258
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.015075447038010276
val_cls_loss: 0.5520502831460636
train_total_loss: 0.6608296405162751
val_total_loss: 0.5520502831460636
test_abn_acc: 0
balanced_train_acc: 0.9958210775521916
balanced_val_acc: 0.7969058498335873
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9850107066381156
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.6759656652360515
Water_on_Land_train_acc: 0.9285714285714286
Water_on_Land_val_acc: 0.5789473684210527
Water_on_Water_train_acc: 0.9952696310312205
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5885587444022002
train_abn_att_clip_vit_loss: 0.057195449708276294
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9919137466307277
val_acc_Landbird: 0.8306538049303323
val_acc_Waterbird: 0.7631578947368421
TRAIN ACC:        0.9979144942648592
VAL ACC:          0.8156797331109258
BALANCED VAL ACC: 0.7969058498335873
EPOCH: 197

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.35s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.43it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.03it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.51it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.16it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.40it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.57it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.65it/s]
 20%|██        | 10/50 [00:03<00:10,  3.72it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.82it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.87it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.86it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:08,  3.95it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.95it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.95it/s]
 36%|███▌      | 18/50 [00:05<00:08,  3.96it/s]
 38%|███▊      | 19/50 [00:05<00:07,  3.94it/s]
 40%|████      | 20/50 [00:06<00:07,  3.94it/s]
 42%|████▏     | 21/50 [00:06<00:07,  3.93it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.95it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.97it/s]
 48%|████▊     | 24/50 [00:07<00:06,  3.96it/s]
 50%|█████     | 25/50 [00:07<00:06,  3.97it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.97it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  4.00it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.99it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.97it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.98it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  3.98it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.94it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.95it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.94it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.93it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.97it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.01it/s]
 80%|████████  | 40/50 [00:11<00:02,  3.97it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  3.97it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.94it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.92it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  3.92it/s]
 90%|█████████ | 45/50 [00:12<00:01,  3.93it/s]
 92%|█████████▏| 46/50 [00:12<00:01,  3.93it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  3.92it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  3.96it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.03it/s]
100%|██████████| 50/50 [00:13<00:00,  4.09it/s]
100%|██████████| 50/50 [00:13<00:00,  3.62it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:13,  1.16s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.71it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.01it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.88it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.08it/s]
100%|██████████| 13/13 [00:03<00:00,  6.14it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9979144942648592
val_acc: 0.8256880733944955
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01451575284186708
val_cls_loss: 0.5259543682034559
train_total_loss: 0.6603097080065635
val_total_loss: 0.5259543682034559
test_abn_acc: 0
balanced_train_acc: 0.9970748396926745
balanced_val_acc: 0.7993053372982295
Land_on_Land_train_acc: 0.9991423670668954
Land_on_Land_val_acc: 0.987152034261242
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.7060085836909872
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.556390977443609
Water_on_Water_train_acc: 0.9981078524124882
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5886373366752681
train_abn_att_clip_vit_loss: 0.057156614206412784
train_acc_Landbird: 0.9986420423682781
train_acc_Waterbird: 0.995507637017071
val_acc_Landbird: 0.8467309753483387
val_acc_Waterbird: 0.7518796992481203
TRAIN ACC:        0.9979144942648592
VAL ACC:          0.8256880733944955
BALANCED VAL ACC: 0.7993053372982295
EPOCH: 198

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:05,  1.34s/it]
  4%|▍         | 2/50 [00:01<00:33,  1.42it/s]
  6%|▌         | 3/50 [00:01<00:23,  2.01it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.49it/s]
 10%|█         | 5/50 [00:02<00:15,  2.88it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.17it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.38it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.55it/s]
 18%|█▊        | 9/50 [00:03<00:11,  3.67it/s]
 20%|██        | 10/50 [00:03<00:10,  3.75it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.79it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.84it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.85it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.90it/s]
 30%|███       | 15/50 [00:04<00:08,  3.91it/s]
 32%|███▏      | 16/50 [00:05<00:08,  3.93it/s]
 34%|███▍      | 17/50 [00:05<00:08,  3.94it/s]
 36%|███▌      | 18/50 [00:05<00:07,  4.03it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.05it/s]
 40%|████      | 20/50 [00:06<00:07,  4.05it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.06it/s]
 44%|████▍     | 22/50 [00:06<00:06,  4.07it/s]
 46%|████▌     | 23/50 [00:06<00:06,  4.04it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.03it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.01it/s]
 52%|█████▏    | 26/50 [00:07<00:05,  4.01it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  3.98it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  4.02it/s]
 60%|██████    | 30/50 [00:08<00:04,  4.05it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  4.07it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.09it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  4.07it/s]
 68%|██████▊   | 34/50 [00:09<00:03,  4.08it/s]
 70%|███████   | 35/50 [00:09<00:03,  4.09it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  4.10it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  4.06it/s]
 76%|███████▌  | 38/50 [00:10<00:02,  4.05it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  4.02it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.03it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.03it/s]
 84%|████████▍ | 42/50 [00:11<00:01,  4.01it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  4.01it/s]
 88%|████████▊ | 44/50 [00:12<00:01,  4.01it/s]
 90%|█████████ | 45/50 [00:12<00:01,  4.01it/s]
 92%|█████████▏| 46/50 [00:12<00:00,  4.02it/s]
 94%|█████████▍| 47/50 [00:12<00:00,  4.03it/s]
 96%|█████████▌| 48/50 [00:13<00:00,  4.02it/s]
 98%|█████████▊| 49/50 [00:13<00:00,  4.02it/s]
100%|██████████| 50/50 [00:13<00:00,  4.05it/s]
100%|██████████| 50/50 [00:13<00:00,  3.66it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:01<00:14,  1.17s/it]
 23%|██▎       | 3/13 [00:01<00:03,  2.70it/s]
 38%|███▊      | 5/13 [00:01<00:02,  3.00it/s]
 54%|█████▍    | 7/13 [00:02<00:01,  4.36it/s]
 69%|██████▉   | 9/13 [00:02<00:01,  3.94it/s]
 85%|████████▍ | 11/13 [00:02<00:00,  5.10it/s]
100%|██████████| 13/13 [00:03<00:00,  6.31it/s]
100%|██████████| 13/13 [00:03<00:00,  4.09it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9979144942648592
val_acc: 0.8331943286071727
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.013342262353705354
val_cls_loss: 0.4935901989605747
train_total_loss: 0.6588823478711658
val_total_loss: 0.4935901989605747
test_abn_acc: 0
balanced_train_acc: 0.9961345180873125
balanced_val_acc: 0.8014409012885912
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9892933618843683
Land_on_Water_train_acc: 0.9891304347826086
Land_on_Water_val_acc: 0.7274678111587983
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.5413533834586466
Water_on_Water_train_acc: 0.9952696310312205
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5884401628819447
train_abn_att_clip_vit_loss: 0.05709992450068591
train_acc_Landbird: 0.9994568169473113
train_acc_Waterbird: 0.9928122192273136
val_acc_Landbird: 0.8585209003215434
val_acc_Waterbird: 0.7443609022556391
TRAIN ACC:        0.9979144942648592
VAL ACC:          0.8331943286071727
BALANCED VAL ACC: 0.8014409012885912
EPOCH: 199

>>> TRAINING 


  0%|          | 0/50 [00:00<?, ?it/s]
  2%|▏         | 1/50 [00:01<01:04,  1.31s/it]
  4%|▍         | 2/50 [00:01<00:32,  1.46it/s]
  6%|▌         | 3/50 [00:01<00:22,  2.06it/s]
  8%|▊         | 4/50 [00:02<00:18,  2.54it/s]
 10%|█         | 5/50 [00:02<00:15,  2.92it/s]
 12%|█▏        | 6/50 [00:02<00:13,  3.19it/s]
 14%|█▍        | 7/50 [00:02<00:12,  3.42it/s]
 16%|█▌        | 8/50 [00:03<00:11,  3.60it/s]
 18%|█▊        | 9/50 [00:03<00:10,  3.75it/s]
 20%|██        | 10/50 [00:03<00:10,  3.82it/s]
 22%|██▏       | 11/50 [00:03<00:10,  3.88it/s]
 24%|██▍       | 12/50 [00:04<00:09,  3.94it/s]
 26%|██▌       | 13/50 [00:04<00:09,  3.95it/s]
 28%|██▊       | 14/50 [00:04<00:09,  3.96it/s]
 30%|███       | 15/50 [00:04<00:08,  3.98it/s]
 32%|███▏      | 16/50 [00:05<00:08,  4.00it/s]
 34%|███▍      | 17/50 [00:05<00:08,  4.00it/s]
 36%|███▌      | 18/50 [00:05<00:08,  4.00it/s]
 38%|███▊      | 19/50 [00:05<00:07,  4.00it/s]
 40%|████      | 20/50 [00:06<00:07,  4.00it/s]
 42%|████▏     | 21/50 [00:06<00:07,  4.01it/s]
 44%|████▍     | 22/50 [00:06<00:07,  3.98it/s]
 46%|████▌     | 23/50 [00:06<00:06,  3.98it/s]
 48%|████▊     | 24/50 [00:07<00:06,  4.01it/s]
 50%|█████     | 25/50 [00:07<00:06,  4.00it/s]
 52%|█████▏    | 26/50 [00:07<00:06,  3.99it/s]
 54%|█████▍    | 27/50 [00:07<00:05,  3.99it/s]
 56%|█████▌    | 28/50 [00:08<00:05,  4.00it/s]
 58%|█████▊    | 29/50 [00:08<00:05,  3.99it/s]
 60%|██████    | 30/50 [00:08<00:05,  3.97it/s]
 62%|██████▏   | 31/50 [00:08<00:04,  3.98it/s]
 64%|██████▍   | 32/50 [00:09<00:04,  4.00it/s]
 66%|██████▌   | 33/50 [00:09<00:04,  3.99it/s]
 68%|██████▊   | 34/50 [00:09<00:04,  3.96it/s]
 70%|███████   | 35/50 [00:09<00:03,  3.97it/s]
 72%|███████▏  | 36/50 [00:10<00:03,  3.99it/s]
 74%|███████▍  | 37/50 [00:10<00:03,  3.98it/s]
 76%|███████▌  | 38/50 [00:10<00:03,  3.98it/s]
 78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]
 80%|████████  | 40/50 [00:11<00:02,  4.02it/s]
 82%|████████▏ | 41/50 [00:11<00:02,  4.02it/s]
 84%|████████▍ | 42/50 [00:11<00:02,  3.99it/s]
 86%|████████▌ | 43/50 [00:11<00:01,  3.99it/s]
 88%|████████▊ | 44/50 [00:12<00:02,  2.40it/s]
 90%|█████████ | 45/50 [00:13<00:03,  1.63it/s]
 92%|█████████▏| 46/50 [00:14<00:02,  1.71it/s]
 94%|█████████▍| 47/50 [00:14<00:01,  2.06it/s]
 96%|█████████▌| 48/50 [00:15<00:01,  1.37it/s]
 98%|█████████▊| 49/50 [00:16<00:00,  1.28it/s]
100%|██████████| 50/50 [00:17<00:00,  1.53it/s]
100%|██████████| 50/50 [00:17<00:00,  2.92it/s]
>>> VALIDATING 


  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:03<00:42,  3.58s/it]
 23%|██▎       | 3/13 [00:03<00:09,  1.00it/s]
 38%|███▊      | 5/13 [00:06<00:08,  1.12s/it]
 46%|████▌     | 6/13 [00:06<00:05,  1.18it/s]
 62%|██████▏   | 8/13 [00:06<00:02,  1.94it/s]
 69%|██████▉   | 9/13 [00:08<00:03,  1.10it/s]
 77%|███████▋  | 10/13 [00:08<00:02,  1.40it/s]
 85%|████████▍ | 11/13 [00:08<00:01,  1.81it/s]
100%|██████████| 13/13 [00:09<00:00,  1.90it/s]
100%|██████████| 13/13 [00:09<00:00,  1.30it/s]
>>> LOGGING 

BALANCED ACCS CHECKED FOR TRAIN
BALANCED ACCS CHECKED FOR VAL
train_acc: 0.9981230448383733
val_acc: 0.8348623853211009
train_abn_acc: 0
val_abn_acc: 0
train_cls_loss: 0.01368089315391168
val_cls_loss: 0.4830668441721357
train_total_loss: 0.6587905430818624
val_total_loss: 0.4830668441721357
test_abn_acc: 0
balanced_train_acc: 0.9962703138504846
balanced_val_acc: 0.7998251255147515
Land_on_Land_train_acc: 1.0
Land_on_Land_val_acc: 0.9914346895074947
Land_on_Water_train_acc: 0.9945652173913043
Land_on_Water_val_acc: 0.7339055793991416
Water_on_Land_train_acc: 0.9464285714285714
Water_on_Land_val_acc: 0.5263157894736842
Water_on_Water_train_acc: 0.9952696310312205
Water_on_Water_val_acc: 0.9473684210526315
train_abn_cls_loss: 0.5880499042360825
train_abn_att_clip_vit_loss: 0.05705974423816977
train_acc_Landbird: 0.9997284084736556
train_acc_Waterbird: 0.9928122192273136
val_acc_Landbird: 0.8628081457663451
val_acc_Waterbird: 0.7368421052631579
TRAIN ACC:        0.9981230448383733
VAL ACC:          0.8348623853211009
BALANCED VAL ACC: 0.7998251255147515
>>> EVALUATING ON TEST SET
WATERBIRDS DIR: /home/ryreu/guided_cnn/waterbirds/waterbird_complete95_forest2water2
NUMBER OF SAMPLES WITH LABEL Landbird: 4510
NUMBER OF SAMPLES WITH LABEL Waterbird: 1284
NUMBER OF SAMPLES WITH GROUP Land_on_Land: 2255
NUMBER OF SAMPLES WITH GROUP Land_on_Water: 2255
NUMBER OF SAMPLES WITH GROUP Water_on_Land: 642
NUMBER OF SAMPLES WITH GROUP Water_on_Water: 642
NUM TEST:   5794

Loaded checkpoint trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_193.ckpt

  0%|          | 0/5794 [00:00<?, ?it/s]
  0%|          | 1/5794 [00:00<33:08,  2.91it/s]
  0%|          | 6/5794 [00:00<06:07, 15.75it/s]
  0%|          | 11/5794 [00:00<03:50, 25.05it/s]
  0%|          | 16/5794 [00:00<03:06, 31.03it/s]
  0%|          | 21/5794 [00:00<02:43, 35.34it/s]
  0%|          | 26/5794 [00:00<02:35, 37.15it/s]
  1%|          | 31/5794 [00:01<02:41, 35.60it/s]
  1%|          | 36/5794 [00:01<02:31, 37.99it/s]
  1%|          | 41/5794 [00:01<02:24, 39.86it/s]
  1%|          | 46/5794 [00:01<02:19, 41.07it/s]
  1%|          | 51/5794 [00:01<02:18, 41.55it/s]
  1%|          | 56/5794 [00:01<02:15, 42.25it/s]
  1%|          | 61/5794 [00:01<02:13, 42.87it/s]
  1%|          | 66/5794 [00:01<02:12, 43.23it/s]
  1%|          | 71/5794 [00:01<02:12, 43.32it/s]
  1%|▏         | 76/5794 [00:02<02:10, 43.80it/s]
  1%|▏         | 81/5794 [00:02<02:12, 43.19it/s]
  1%|▏         | 86/5794 [00:02<02:12, 43.21it/s]
  2%|▏         | 91/5794 [00:02<02:10, 43.76it/s]
  2%|▏         | 96/5794 [00:02<02:10, 43.66it/s]
  2%|▏         | 101/5794 [00:02<02:09, 44.02it/s]
  2%|▏         | 106/5794 [00:02<02:08, 44.13it/s]
  2%|▏         | 111/5794 [00:02<02:08, 44.22it/s]
  2%|▏         | 116/5794 [00:03<02:08, 44.13it/s]
  2%|▏         | 121/5794 [00:03<02:08, 44.19it/s]
  2%|▏         | 126/5794 [00:03<02:08, 44.17it/s]
  2%|▏         | 131/5794 [00:03<02:08, 44.17it/s]
  2%|▏         | 136/5794 [00:03<02:09, 43.83it/s]
  2%|▏         | 141/5794 [00:03<02:07, 44.21it/s]
  3%|▎         | 146/5794 [00:03<02:07, 44.22it/s]
  3%|▎         | 151/5794 [00:03<02:07, 44.16it/s]
  3%|▎         | 156/5794 [00:03<02:07, 44.16it/s]
  3%|▎         | 161/5794 [00:04<02:07, 44.31it/s]
  3%|▎         | 166/5794 [00:04<02:07, 44.26it/s]
  3%|▎         | 171/5794 [00:04<02:07, 44.25it/s]
  3%|▎         | 176/5794 [00:04<02:07, 44.17it/s]
  3%|▎         | 181/5794 [00:04<02:06, 44.51it/s]
  3%|▎         | 186/5794 [00:04<02:06, 44.43it/s]
  3%|▎         | 191/5794 [00:04<02:06, 44.41it/s]
  3%|▎         | 196/5794 [00:04<02:06, 44.26it/s]
  3%|▎         | 201/5794 [00:04<02:05, 44.65it/s]
  4%|▎         | 206/5794 [00:05<02:05, 44.69it/s]
  4%|▎         | 211/5794 [00:05<02:05, 44.65it/s]
  4%|▎         | 216/5794 [00:05<02:04, 44.70it/s]
  4%|▍         | 221/5794 [00:05<02:04, 44.84it/s]
  4%|▍         | 226/5794 [00:05<02:05, 44.44it/s]
  4%|▍         | 231/5794 [00:05<02:03, 44.92it/s]
  4%|▍         | 236/5794 [00:05<02:04, 44.72it/s]
  4%|▍         | 241/5794 [00:05<02:04, 44.51it/s]
  4%|▍         | 246/5794 [00:05<02:03, 45.02it/s]
  4%|▍         | 251/5794 [00:06<02:04, 44.66it/s]
  4%|▍         | 256/5794 [00:06<02:04, 44.61it/s]
  5%|▍         | 261/5794 [00:06<02:03, 44.82it/s]
  5%|▍         | 266/5794 [00:06<02:01, 45.49it/s]
  5%|▍         | 271/5794 [00:06<02:02, 45.27it/s]
  5%|▍         | 276/5794 [00:06<02:01, 45.26it/s]
  5%|▍         | 281/5794 [00:06<02:02, 45.00it/s]
  5%|▍         | 286/5794 [00:06<02:03, 44.44it/s]
  5%|▌         | 291/5794 [00:06<02:03, 44.51it/s]
  5%|▌         | 296/5794 [00:07<02:02, 44.93it/s]
  5%|▌         | 301/5794 [00:07<02:04, 43.96it/s]
  5%|▌         | 306/5794 [00:07<02:08, 42.66it/s]
  5%|▌         | 311/5794 [00:07<02:11, 41.66it/s]
  5%|▌         | 316/5794 [00:07<02:12, 41.35it/s]
  6%|▌         | 321/5794 [00:07<02:14, 40.83it/s]
  6%|▌         | 326/5794 [00:07<02:16, 39.98it/s]
  6%|▌         | 331/5794 [00:07<02:17, 39.80it/s]
  6%|▌         | 335/5794 [00:08<02:17, 39.80it/s]
  6%|▌         | 340/5794 [00:08<02:16, 39.90it/s]
  6%|▌         | 344/5794 [00:08<02:16, 39.85it/s]
  6%|▌         | 349/5794 [00:08<02:16, 39.97it/s]
  6%|▌         | 353/5794 [00:08<02:16, 39.95it/s]
  6%|▌         | 358/5794 [00:08<02:15, 40.13it/s]
  6%|▋         | 363/5794 [00:08<02:13, 40.54it/s]
  6%|▋         | 368/5794 [00:08<02:10, 41.67it/s]
  6%|▋         | 373/5794 [00:08<02:07, 42.44it/s]
  7%|▋         | 378/5794 [00:09<02:05, 43.19it/s]
  7%|▋         | 383/5794 [00:09<02:03, 43.66it/s]
  7%|▋         | 388/5794 [00:09<02:03, 43.89it/s]
  7%|▋         | 393/5794 [00:09<02:05, 42.95it/s]
  7%|▋         | 398/5794 [00:09<02:07, 42.37it/s]
  7%|▋         | 403/5794 [00:09<02:09, 41.57it/s]
  7%|▋         | 408/5794 [00:09<02:10, 41.19it/s]
  7%|▋         | 413/5794 [00:09<02:11, 40.84it/s]
  7%|▋         | 418/5794 [00:10<02:10, 41.28it/s]
  7%|▋         | 423/5794 [00:10<02:06, 42.51it/s]
  7%|▋         | 428/5794 [00:10<02:04, 43.24it/s]
  7%|▋         | 433/5794 [00:10<02:02, 43.90it/s]
  8%|▊         | 438/5794 [00:10<02:01, 44.05it/s]
  8%|▊         | 443/5794 [00:10<01:59, 44.74it/s]
  8%|▊         | 448/5794 [00:10<01:59, 44.71it/s]
  8%|▊         | 453/5794 [00:10<01:59, 44.79it/s]
  8%|▊         | 458/5794 [00:10<01:58, 45.10it/s]
  8%|▊         | 463/5794 [00:11<02:10, 40.92it/s]
  8%|▊         | 468/5794 [00:11<02:06, 42.10it/s]
  8%|▊         | 473/5794 [00:11<02:02, 43.26it/s]
  8%|▊         | 478/5794 [00:11<02:00, 44.14it/s]
  8%|▊         | 483/5794 [00:11<01:59, 44.43it/s]
  8%|▊         | 488/5794 [00:11<01:59, 44.58it/s]
  9%|▊         | 493/5794 [00:11<01:58, 44.87it/s]
  9%|▊         | 498/5794 [00:11<01:57, 45.12it/s]
  9%|▊         | 503/5794 [00:11<01:57, 45.12it/s]
  9%|▉         | 508/5794 [00:12<01:57, 44.97it/s]
  9%|▉         | 513/5794 [00:12<01:56, 45.36it/s]
  9%|▉         | 518/5794 [00:12<01:57, 45.08it/s]
  9%|▉         | 523/5794 [00:12<01:55, 45.51it/s]
  9%|▉         | 528/5794 [00:12<01:56, 45.11it/s]
  9%|▉         | 533/5794 [00:12<01:55, 45.37it/s]
  9%|▉         | 538/5794 [00:12<01:56, 45.24it/s]
  9%|▉         | 543/5794 [00:12<01:55, 45.36it/s]
  9%|▉         | 548/5794 [00:12<01:56, 45.12it/s]
 10%|▉         | 553/5794 [00:13<01:56, 44.91it/s]
 10%|▉         | 558/5794 [00:13<01:55, 45.16it/s]
 10%|▉         | 563/5794 [00:13<01:55, 45.29it/s]
 10%|▉         | 568/5794 [00:13<01:55, 45.14it/s]
 10%|▉         | 573/5794 [00:13<01:55, 45.11it/s]
 10%|▉         | 578/5794 [00:13<01:55, 45.22it/s]
 10%|█         | 583/5794 [00:13<01:54, 45.32it/s]
 10%|█         | 588/5794 [00:13<01:55, 45.24it/s]
 10%|█         | 593/5794 [00:13<01:55, 45.22it/s]
 10%|█         | 598/5794 [00:14<01:54, 45.31it/s]
 10%|█         | 603/5794 [00:14<01:55, 45.01it/s]
 10%|█         | 608/5794 [00:14<01:54, 45.42it/s]
 11%|█         | 613/5794 [00:14<01:54, 45.42it/s]
 11%|█         | 618/5794 [00:14<01:54, 45.38it/s]
 11%|█         | 623/5794 [00:14<01:54, 45.35it/s]
 11%|█         | 628/5794 [00:14<01:53, 45.44it/s]
 11%|█         | 633/5794 [00:14<01:53, 45.45it/s]
 11%|█         | 638/5794 [00:14<01:55, 44.82it/s]
 11%|█         | 643/5794 [00:15<01:55, 44.79it/s]
 11%|█         | 648/5794 [00:15<01:54, 45.01it/s]
 11%|█▏        | 653/5794 [00:15<01:54, 45.01it/s]
 11%|█▏        | 658/5794 [00:15<01:53, 45.17it/s]
 11%|█▏        | 663/5794 [00:15<01:52, 45.53it/s]
 12%|█▏        | 668/5794 [00:15<01:52, 45.49it/s]
 12%|█▏        | 673/5794 [00:15<01:52, 45.44it/s]
 12%|█▏        | 678/5794 [00:15<01:52, 45.53it/s]
 12%|█▏        | 683/5794 [00:15<01:52, 45.48it/s]
 12%|█▏        | 688/5794 [00:16<01:54, 44.65it/s]
 12%|█▏        | 693/5794 [00:16<01:54, 44.67it/s]
 12%|█▏        | 698/5794 [00:16<01:53, 44.91it/s]
 12%|█▏        | 703/5794 [00:16<01:54, 44.40it/s]
 12%|█▏        | 708/5794 [00:16<01:54, 44.32it/s]
 12%|█▏        | 713/5794 [00:16<01:54, 44.55it/s]
 12%|█▏        | 718/5794 [00:16<01:55, 43.96it/s]
 12%|█▏        | 723/5794 [00:16<01:54, 44.44it/s]
 13%|█▎        | 728/5794 [00:16<01:53, 44.70it/s]
 13%|█▎        | 733/5794 [00:17<01:52, 44.93it/s]
 13%|█▎        | 738/5794 [00:17<01:52, 44.87it/s]
 13%|█▎        | 743/5794 [00:17<01:52, 44.90it/s]
 13%|█▎        | 748/5794 [00:17<01:52, 45.02it/s]
 13%|█▎        | 753/5794 [00:17<01:52, 45.00it/s]
 13%|█▎        | 758/5794 [00:17<01:51, 45.01it/s]
 13%|█▎        | 763/5794 [00:17<01:51, 45.15it/s]
 13%|█▎        | 768/5794 [00:17<01:51, 45.15it/s]
 13%|█▎        | 773/5794 [00:17<01:51, 44.89it/s]
 13%|█▎        | 778/5794 [00:18<01:50, 45.23it/s]
 14%|█▎        | 783/5794 [00:18<01:50, 45.26it/s]
 14%|█▎        | 788/5794 [00:18<01:50, 45.24it/s]
 14%|█▎        | 793/5794 [00:18<01:51, 44.85it/s]
 14%|█▍        | 798/5794 [00:18<01:55, 43.32it/s]
 14%|█▍        | 803/5794 [00:18<01:57, 42.52it/s]
 14%|█▍        | 808/5794 [00:18<01:59, 41.75it/s]
 14%|█▍        | 813/5794 [00:18<01:56, 42.73it/s]
 14%|█▍        | 818/5794 [00:18<01:54, 43.40it/s]
 14%|█▍        | 823/5794 [00:19<01:53, 43.74it/s]
 14%|█▍        | 828/5794 [00:19<01:52, 44.20it/s]
 14%|█▍        | 833/5794 [00:19<01:51, 44.54it/s]
 14%|█▍        | 838/5794 [00:19<01:51, 44.42it/s]
 15%|█▍        | 843/5794 [00:19<01:50, 44.79it/s]
 15%|█▍        | 848/5794 [00:19<01:50, 44.88it/s]
 15%|█▍        | 853/5794 [00:19<01:49, 44.97it/s]
 15%|█▍        | 858/5794 [00:19<01:52, 44.04it/s]
 15%|█▍        | 863/5794 [00:19<01:49, 45.17it/s]
 15%|█▍        | 868/5794 [00:20<01:48, 45.23it/s]
 15%|█▌        | 873/5794 [00:20<01:48, 45.21it/s]
 15%|█▌        | 878/5794 [00:20<01:49, 45.08it/s]
 15%|█▌        | 883/5794 [00:20<01:49, 45.00it/s]
 15%|█▌        | 888/5794 [00:20<01:51, 44.02it/s]
 15%|█▌        | 893/5794 [00:20<01:51, 44.00it/s]
 15%|█▌        | 898/5794 [00:20<01:51, 44.09it/s]
 16%|█▌        | 903/5794 [00:20<01:49, 44.69it/s]
 16%|█▌        | 908/5794 [00:20<01:49, 44.48it/s]
 16%|█▌        | 913/5794 [00:21<01:53, 43.04it/s]
 16%|█▌        | 918/5794 [00:21<01:53, 42.96it/s]
 16%|█▌        | 923/5794 [00:21<01:49, 44.30it/s]
 16%|█▌        | 928/5794 [00:21<01:50, 43.88it/s]
 16%|█▌        | 933/5794 [00:21<01:49, 44.27it/s]
 16%|█▌        | 938/5794 [00:21<01:49, 44.49it/s]
 16%|█▋        | 943/5794 [00:21<01:49, 44.44it/s]
 16%|█▋        | 948/5794 [00:21<01:48, 44.62it/s]
 16%|█▋        | 953/5794 [00:21<01:48, 44.57it/s]
 17%|█▋        | 958/5794 [00:22<01:48, 44.42it/s]
 17%|█▋        | 963/5794 [00:22<01:48, 44.48it/s]
 17%|█▋        | 968/5794 [00:22<01:47, 44.76it/s]
 17%|█▋        | 973/5794 [00:22<01:47, 44.87it/s]
 17%|█▋        | 978/5794 [00:22<01:47, 44.69it/s]
 17%|█▋        | 983/5794 [00:22<01:47, 44.89it/s]
 17%|█▋        | 988/5794 [00:22<01:48, 44.48it/s]
 17%|█▋        | 993/5794 [00:22<01:46, 45.05it/s]
 17%|█▋        | 998/5794 [00:22<01:46, 45.11it/s]
 17%|█▋        | 1003/5794 [00:23<01:46, 45.16it/s]
 17%|█▋        | 1008/5794 [00:23<01:46, 45.05it/s]
 17%|█▋        | 1013/5794 [00:23<01:47, 44.29it/s]
 18%|█▊        | 1018/5794 [00:23<01:47, 44.60it/s]
 18%|█▊        | 1023/5794 [00:23<01:46, 44.79it/s]
 18%|█▊        | 1028/5794 [00:23<01:46, 44.83it/s]
 18%|█▊        | 1033/5794 [00:23<01:45, 44.96it/s]
 18%|█▊        | 1038/5794 [00:23<01:48, 43.67it/s]
 18%|█▊        | 1043/5794 [00:24<01:51, 42.49it/s]
 18%|█▊        | 1048/5794 [00:24<01:53, 41.72it/s]
 18%|█▊        | 1053/5794 [00:24<01:55, 41.07it/s]
 18%|█▊        | 1058/5794 [00:24<01:57, 40.19it/s]
 18%|█▊        | 1063/5794 [00:24<01:58, 40.07it/s]
 18%|█▊        | 1068/5794 [00:24<01:57, 40.17it/s]
 19%|█▊        | 1073/5794 [00:24<01:57, 40.02it/s]
 19%|█▊        | 1078/5794 [00:24<01:57, 39.98it/s]
 19%|█▊        | 1083/5794 [00:25<01:58, 39.92it/s]
 19%|█▉        | 1088/5794 [00:25<01:57, 40.10it/s]
 19%|█▉        | 1093/5794 [00:25<01:56, 40.41it/s]
 19%|█▉        | 1098/5794 [00:25<01:56, 40.29it/s]
 19%|█▉        | 1103/5794 [00:25<01:56, 40.30it/s]
 19%|█▉        | 1108/5794 [00:25<01:56, 40.38it/s]
 19%|█▉        | 1113/5794 [00:25<01:56, 40.16it/s]
 19%|█▉        | 1118/5794 [00:25<01:52, 41.66it/s]
 19%|█▉        | 1123/5794 [00:25<01:50, 42.26it/s]
 19%|█▉        | 1128/5794 [00:26<01:48, 42.83it/s]
 20%|█▉        | 1133/5794 [00:26<01:46, 43.85it/s]
 20%|█▉        | 1138/5794 [00:26<01:45, 44.26it/s]
 20%|█▉        | 1143/5794 [00:26<01:44, 44.71it/s]
 20%|█▉        | 1148/5794 [00:26<01:43, 44.71it/s]
 20%|█▉        | 1153/5794 [00:26<01:43, 44.91it/s]
 20%|█▉        | 1158/5794 [00:26<01:43, 44.99it/s]
 20%|██        | 1163/5794 [00:26<01:43, 44.92it/s]
 20%|██        | 1168/5794 [00:26<01:42, 45.04it/s]
 20%|██        | 1173/5794 [00:27<01:42, 45.15it/s]
 20%|██        | 1178/5794 [00:27<01:42, 44.98it/s]
 20%|██        | 1183/5794 [00:27<01:42, 45.02it/s]
 21%|██        | 1188/5794 [00:27<01:42, 44.79it/s]
 21%|██        | 1193/5794 [00:27<01:41, 45.17it/s]
 21%|██        | 1198/5794 [00:27<01:41, 45.07it/s]
 21%|██        | 1203/5794 [00:27<01:41, 45.16it/s]
 21%|██        | 1208/5794 [00:27<01:41, 45.10it/s]
 21%|██        | 1213/5794 [00:27<01:42, 44.79it/s]
 21%|██        | 1218/5794 [00:28<01:41, 45.25it/s]
 21%|██        | 1223/5794 [00:28<01:41, 45.21it/s]
 21%|██        | 1228/5794 [00:28<01:40, 45.32it/s]
 21%|██▏       | 1233/5794 [00:28<01:41, 45.16it/s]
 21%|██▏       | 1238/5794 [00:28<01:40, 45.32it/s]
 21%|██▏       | 1243/5794 [00:28<01:40, 45.33it/s]
 22%|██▏       | 1248/5794 [00:28<01:40, 45.35it/s]
 22%|██▏       | 1253/5794 [00:28<01:39, 45.48it/s]
 22%|██▏       | 1258/5794 [00:28<01:39, 45.56it/s]
 22%|██▏       | 1263/5794 [00:29<01:39, 45.40it/s]
 22%|██▏       | 1268/5794 [00:29<01:39, 45.49it/s]
 22%|██▏       | 1273/5794 [00:29<01:39, 45.53it/s]
 22%|██▏       | 1278/5794 [00:29<01:39, 45.52it/s]
 22%|██▏       | 1283/5794 [00:29<01:39, 45.45it/s]
 22%|██▏       | 1288/5794 [00:29<01:39, 45.51it/s]
 22%|██▏       | 1293/5794 [00:29<01:38, 45.50it/s]
 22%|██▏       | 1298/5794 [00:29<01:38, 45.44it/s]
 22%|██▏       | 1303/5794 [00:29<01:38, 45.48it/s]
 23%|██▎       | 1308/5794 [00:30<01:38, 45.56it/s]
 23%|██▎       | 1313/5794 [00:30<01:38, 45.52it/s]
 23%|██▎       | 1318/5794 [00:30<01:38, 45.24it/s]
 23%|██▎       | 1323/5794 [00:30<01:37, 45.66it/s]
 23%|██▎       | 1328/5794 [00:30<01:37, 45.66it/s]
 23%|██▎       | 1333/5794 [00:30<01:37, 45.52it/s]
 23%|██▎       | 1338/5794 [00:30<01:37, 45.55it/s]
 23%|██▎       | 1343/5794 [00:30<01:37, 45.55it/s]
 23%|██▎       | 1348/5794 [00:30<01:38, 45.21it/s]
 23%|██▎       | 1353/5794 [00:31<01:39, 44.71it/s]
 23%|██▎       | 1358/5794 [00:31<01:37, 45.55it/s]
 24%|██▎       | 1363/5794 [00:31<01:38, 44.94it/s]
 24%|██▎       | 1368/5794 [00:31<01:37, 45.63it/s]
 24%|██▎       | 1373/5794 [00:31<01:36, 45.63it/s]
 24%|██▍       | 1378/5794 [00:31<01:36, 45.65it/s]
 24%|██▍       | 1383/5794 [00:31<01:36, 45.60it/s]
 24%|██▍       | 1388/5794 [00:31<01:36, 45.63it/s]
 24%|██▍       | 1393/5794 [00:31<01:36, 45.57it/s]
 24%|██▍       | 1398/5794 [00:32<01:37, 45.25it/s]
 24%|██▍       | 1403/5794 [00:32<01:37, 45.15it/s]
 24%|██▍       | 1408/5794 [00:32<01:37, 44.98it/s]
 24%|██▍       | 1413/5794 [00:32<01:36, 45.19it/s]
 24%|██▍       | 1418/5794 [00:32<01:36, 45.22it/s]
 25%|██▍       | 1423/5794 [00:32<01:37, 45.03it/s]
 25%|██▍       | 1428/5794 [00:32<01:35, 45.51it/s]
 25%|██▍       | 1433/5794 [00:32<01:36, 45.35it/s]
 25%|██▍       | 1438/5794 [00:32<01:36, 44.94it/s]
 25%|██▍       | 1443/5794 [00:33<01:35, 45.62it/s]
 25%|██▍       | 1448/5794 [00:33<01:35, 45.51it/s]
 25%|██▌       | 1453/5794 [00:33<01:37, 44.70it/s]
 25%|██▌       | 1458/5794 [00:33<01:36, 45.05it/s]
 25%|██▌       | 1463/5794 [00:33<01:35, 45.22it/s]
 25%|██▌       | 1468/5794 [00:33<01:38, 43.72it/s]
 25%|██▌       | 1473/5794 [00:33<01:40, 42.82it/s]
 26%|██▌       | 1478/5794 [00:33<01:42, 42.00it/s]
 26%|██▌       | 1483/5794 [00:33<01:43, 41.47it/s]
 26%|██▌       | 1488/5794 [00:34<01:44, 41.14it/s]
 26%|██▌       | 1493/5794 [00:34<01:44, 40.98it/s]
 26%|██▌       | 1498/5794 [00:34<01:45, 40.73it/s]
 26%|██▌       | 1503/5794 [00:34<01:45, 40.63it/s]
 26%|██▌       | 1508/5794 [00:34<01:45, 40.62it/s]
 26%|██▌       | 1513/5794 [00:34<01:45, 40.51it/s]
 26%|██▌       | 1518/5794 [00:34<01:46, 40.21it/s]
 26%|██▋       | 1523/5794 [00:34<01:45, 40.53it/s]
 26%|██▋       | 1528/5794 [00:35<01:45, 40.48it/s]
 26%|██▋       | 1533/5794 [00:35<01:45, 40.35it/s]
 27%|██▋       | 1538/5794 [00:35<01:45, 40.43it/s]
 27%|██▋       | 1543/5794 [00:35<01:45, 40.32it/s]
 27%|██▋       | 1548/5794 [00:35<01:45, 40.39it/s]
 27%|██▋       | 1553/5794 [00:35<01:45, 40.29it/s]
 27%|██▋       | 1558/5794 [00:35<01:44, 40.37it/s]
 27%|██▋       | 1563/5794 [00:35<01:44, 40.37it/s]
 27%|██▋       | 1568/5794 [00:36<01:44, 40.26it/s]
 27%|██▋       | 1573/5794 [00:36<01:45, 40.14it/s]
 27%|██▋       | 1578/5794 [00:36<01:43, 40.92it/s]
 27%|██▋       | 1583/5794 [00:36<01:39, 42.21it/s]
 27%|██▋       | 1588/5794 [00:36<01:37, 43.13it/s]
 27%|██▋       | 1593/5794 [00:36<01:36, 43.67it/s]
 28%|██▊       | 1598/5794 [00:36<01:34, 44.21it/s]
 28%|██▊       | 1603/5794 [00:36<01:33, 44.67it/s]
 28%|██▊       | 1608/5794 [00:36<01:33, 44.95it/s]
 28%|██▊       | 1613/5794 [00:37<01:32, 45.25it/s]
 28%|██▊       | 1618/5794 [00:37<01:32, 45.27it/s]
 28%|██▊       | 1623/5794 [00:37<01:32, 45.16it/s]
 28%|██▊       | 1628/5794 [00:37<01:31, 45.52it/s]
 28%|██▊       | 1633/5794 [00:37<01:31, 45.40it/s]
 28%|██▊       | 1638/5794 [00:37<01:31, 45.49it/s]
 28%|██▊       | 1643/5794 [00:37<01:31, 45.55it/s]
 28%|██▊       | 1648/5794 [00:37<01:31, 45.24it/s]
 29%|██▊       | 1653/5794 [00:37<01:30, 45.57it/s]
 29%|██▊       | 1658/5794 [00:38<01:30, 45.63it/s]
 29%|██▊       | 1663/5794 [00:38<01:31, 45.35it/s]
 29%|██▉       | 1668/5794 [00:38<01:30, 45.61it/s]
 29%|██▉       | 1673/5794 [00:38<01:30, 45.40it/s]
 29%|██▉       | 1678/5794 [00:38<01:30, 45.72it/s]
 29%|██▉       | 1683/5794 [00:38<01:30, 45.59it/s]
 29%|██▉       | 1688/5794 [00:38<01:29, 45.69it/s]
 29%|██▉       | 1693/5794 [00:38<01:30, 45.55it/s]
 29%|██▉       | 1698/5794 [00:38<01:30, 45.08it/s]
 29%|██▉       | 1703/5794 [00:39<01:29, 45.69it/s]
 29%|██▉       | 1708/5794 [00:39<01:29, 45.45it/s]
 30%|██▉       | 1713/5794 [00:39<01:30, 45.33it/s]
 30%|██▉       | 1718/5794 [00:39<01:30, 45.13it/s]
 30%|██▉       | 1723/5794 [00:39<01:30, 45.22it/s]
 30%|██▉       | 1728/5794 [00:39<01:30, 45.18it/s]
 30%|██▉       | 1733/5794 [00:39<01:30, 45.02it/s]
 30%|██▉       | 1738/5794 [00:39<01:29, 45.09it/s]
 30%|███       | 1743/5794 [00:39<01:29, 45.14it/s]
 30%|███       | 1748/5794 [00:40<01:29, 45.02it/s]
 30%|███       | 1753/5794 [00:40<01:29, 45.02it/s]
 30%|███       | 1758/5794 [00:40<01:29, 45.08it/s]
 30%|███       | 1763/5794 [00:40<01:29, 45.17it/s]
 31%|███       | 1768/5794 [00:40<01:28, 45.30it/s]
 31%|███       | 1773/5794 [00:40<01:28, 45.25it/s]
 31%|███       | 1778/5794 [00:40<01:29, 44.99it/s]
 31%|███       | 1783/5794 [00:40<01:50, 36.20it/s]
 31%|███       | 1788/5794 [00:41<01:42, 39.06it/s]
 31%|███       | 1793/5794 [00:41<01:38, 40.50it/s]
 31%|███       | 1798/5794 [00:41<01:35, 41.90it/s]
 31%|███       | 1803/5794 [00:41<01:33, 42.82it/s]
 31%|███       | 1808/5794 [00:41<01:31, 43.53it/s]
 31%|███▏      | 1813/5794 [00:41<01:30, 43.88it/s]
 31%|███▏      | 1818/5794 [00:41<01:30, 43.95it/s]
 31%|███▏      | 1823/5794 [00:41<01:29, 44.14it/s]
 32%|███▏      | 1828/5794 [00:41<01:32, 42.97it/s]
 32%|███▏      | 1833/5794 [00:42<01:34, 42.09it/s]
 32%|███▏      | 1838/5794 [00:42<01:35, 41.55it/s]
 32%|███▏      | 1843/5794 [00:42<01:35, 41.31it/s]
 32%|███▏      | 1848/5794 [00:42<01:36, 40.97it/s]
 32%|███▏      | 1853/5794 [00:42<01:37, 40.43it/s]
 32%|███▏      | 1858/5794 [00:42<01:37, 40.45it/s]
 32%|███▏      | 1863/5794 [00:42<01:37, 40.46it/s]
 32%|███▏      | 1868/5794 [00:42<01:34, 41.70it/s]
 32%|███▏      | 1873/5794 [00:43<01:31, 42.74it/s]
 32%|███▏      | 1878/5794 [00:43<01:30, 43.40it/s]
 32%|███▏      | 1883/5794 [00:43<01:29, 43.46it/s]
 33%|███▎      | 1888/5794 [00:43<01:29, 43.77it/s]
 33%|███▎      | 1893/5794 [00:43<01:29, 43.79it/s]
 33%|███▎      | 1898/5794 [00:43<01:28, 44.20it/s]
 33%|███▎      | 1903/5794 [00:43<01:28, 44.18it/s]
 33%|███▎      | 1908/5794 [00:43<01:27, 44.47it/s]
 33%|███▎      | 1913/5794 [00:43<01:27, 44.40it/s]
 33%|███▎      | 1918/5794 [00:44<01:27, 44.27it/s]
 33%|███▎      | 1923/5794 [00:44<01:26, 44.97it/s]
 33%|███▎      | 1928/5794 [00:44<01:26, 44.79it/s]
 33%|███▎      | 1933/5794 [00:44<01:25, 44.98it/s]
 33%|███▎      | 1938/5794 [00:44<01:25, 44.97it/s]
 34%|███▎      | 1943/5794 [00:44<01:25, 44.98it/s]
 34%|███▎      | 1948/5794 [00:44<01:25, 44.95it/s]
 34%|███▎      | 1953/5794 [00:44<01:25, 44.86it/s]
 34%|███▍      | 1958/5794 [00:44<01:25, 44.92it/s]
 34%|███▍      | 1963/5794 [00:45<01:25, 44.89it/s]
 34%|███▍      | 1968/5794 [00:45<01:25, 44.79it/s]
 34%|███▍      | 1973/5794 [00:45<01:25, 44.83it/s]
 34%|███▍      | 1978/5794 [00:45<01:24, 44.98it/s]
 34%|███▍      | 1983/5794 [00:45<01:24, 44.93it/s]
 34%|███▍      | 1988/5794 [00:45<01:24, 44.86it/s]
 34%|███▍      | 1993/5794 [00:45<01:25, 44.49it/s]
 34%|███▍      | 1998/5794 [00:45<01:23, 45.21it/s]
 35%|███▍      | 2003/5794 [00:45<01:24, 45.03it/s]
 35%|███▍      | 2008/5794 [00:46<01:23, 45.11it/s]
 35%|███▍      | 2013/5794 [00:46<01:23, 45.20it/s]
 35%|███▍      | 2018/5794 [00:46<01:24, 44.78it/s]
 35%|███▍      | 2023/5794 [00:46<01:24, 44.86it/s]
 35%|███▌      | 2028/5794 [00:46<01:23, 44.84it/s]
 35%|███▌      | 2033/5794 [00:46<01:23, 44.98it/s]
 35%|███▌      | 2038/5794 [00:46<01:23, 44.85it/s]
 35%|███▌      | 2043/5794 [00:46<01:23, 44.85it/s]
 35%|███▌      | 2048/5794 [00:46<01:23, 44.87it/s]
 35%|███▌      | 2053/5794 [00:47<01:23, 44.77it/s]
 36%|███▌      | 2058/5794 [00:47<01:23, 44.87it/s]
 36%|███▌      | 2063/5794 [00:47<01:23, 44.84it/s]
 36%|███▌      | 2068/5794 [00:47<01:23, 44.88it/s]
 36%|███▌      | 2073/5794 [00:47<01:23, 44.78it/s]
 36%|███▌      | 2078/5794 [00:47<01:22, 44.86it/s]
 36%|███▌      | 2083/5794 [00:47<01:22, 44.87it/s]
 36%|███▌      | 2088/5794 [00:47<01:22, 44.79it/s]
 36%|███▌      | 2093/5794 [00:47<01:22, 44.82it/s]
 36%|███▌      | 2098/5794 [00:48<01:22, 44.89it/s]
 36%|███▋      | 2103/5794 [00:48<01:23, 44.33it/s]
 36%|███▋      | 2108/5794 [00:48<01:22, 44.85it/s]
 36%|███▋      | 2113/5794 [00:48<01:21, 45.18it/s]
 37%|███▋      | 2118/5794 [00:48<01:21, 45.06it/s]
 37%|███▋      | 2123/5794 [00:48<01:21, 44.94it/s]
 37%|███▋      | 2128/5794 [00:48<01:21, 44.96it/s]
 37%|███▋      | 2133/5794 [00:48<01:21, 44.97it/s]
 37%|███▋      | 2138/5794 [00:48<01:21, 44.79it/s]
 37%|███▋      | 2143/5794 [00:49<01:21, 44.92it/s]
 37%|███▋      | 2148/5794 [00:49<01:21, 44.96it/s]
 37%|███▋      | 2153/5794 [00:49<01:21, 44.93it/s]
 37%|███▋      | 2158/5794 [00:49<01:21, 44.72it/s]
 37%|███▋      | 2163/5794 [00:49<01:21, 44.68it/s]
 37%|███▋      | 2168/5794 [00:49<01:21, 44.67it/s]
 38%|███▊      | 2173/5794 [00:49<01:21, 44.56it/s]
 38%|███▊      | 2178/5794 [00:49<01:21, 44.31it/s]
 38%|███▊      | 2183/5794 [00:49<01:20, 44.65it/s]
 38%|███▊      | 2188/5794 [00:50<01:21, 44.48it/s]
 38%|███▊      | 2193/5794 [00:50<01:21, 44.22it/s]
 38%|███▊      | 2198/5794 [00:50<01:20, 44.46it/s]
 38%|███▊      | 2203/5794 [00:50<01:20, 44.46it/s]
 38%|███▊      | 2208/5794 [00:50<01:20, 44.46it/s]
 38%|███▊      | 2213/5794 [00:50<01:20, 44.52it/s]
 38%|███▊      | 2218/5794 [00:50<01:20, 44.35it/s]
 38%|███▊      | 2223/5794 [00:50<01:19, 44.68it/s]
 38%|███▊      | 2228/5794 [00:50<01:20, 44.42it/s]
 39%|███▊      | 2233/5794 [00:51<01:19, 44.53it/s]
 39%|███▊      | 2238/5794 [00:51<01:19, 44.85it/s]
 39%|███▊      | 2243/5794 [00:51<01:19, 44.70it/s]
 39%|███▉      | 2248/5794 [00:51<01:19, 44.67it/s]
 39%|███▉      | 2253/5794 [00:51<01:19, 44.56it/s]
 39%|███▉      | 2258/5794 [00:51<01:19, 44.39it/s]
 39%|███▉      | 2263/5794 [00:51<01:19, 44.54it/s]
 39%|███▉      | 2268/5794 [00:51<01:19, 44.60it/s]
 39%|███▉      | 2273/5794 [00:51<01:18, 44.79it/s]
 39%|███▉      | 2278/5794 [00:52<01:18, 44.60it/s]
 39%|███▉      | 2283/5794 [00:52<01:18, 44.86it/s]
 39%|███▉      | 2288/5794 [00:52<01:18, 44.87it/s]
 40%|███▉      | 2293/5794 [00:52<01:18, 44.86it/s]
 40%|███▉      | 2298/5794 [00:52<01:18, 44.80it/s]
 40%|███▉      | 2303/5794 [00:52<01:17, 44.81it/s]
 40%|███▉      | 2308/5794 [00:52<01:18, 44.22it/s]
 40%|███▉      | 2313/5794 [00:52<01:18, 44.63it/s]
 40%|████      | 2318/5794 [00:52<01:17, 44.93it/s]
 40%|████      | 2323/5794 [00:53<01:17, 44.78it/s]
 40%|████      | 2328/5794 [00:53<01:17, 44.70it/s]
 40%|████      | 2333/5794 [00:53<01:19, 43.67it/s]
 40%|████      | 2338/5794 [00:53<01:18, 43.99it/s]
 40%|████      | 2343/5794 [00:53<01:17, 44.58it/s]
 41%|████      | 2348/5794 [00:53<01:16, 44.79it/s]
 41%|████      | 2353/5794 [00:53<01:17, 44.12it/s]
 41%|████      | 2358/5794 [00:53<01:17, 44.35it/s]
 41%|████      | 2363/5794 [00:54<01:17, 44.11it/s]
 41%|████      | 2368/5794 [00:54<01:16, 44.99it/s]
 41%|████      | 2373/5794 [00:54<01:15, 45.10it/s]
 41%|████      | 2378/5794 [00:54<01:15, 45.03it/s]
 41%|████      | 2383/5794 [00:54<01:15, 44.99it/s]
 41%|████      | 2388/5794 [00:54<01:15, 44.97it/s]
 41%|████▏     | 2393/5794 [00:54<01:16, 44.70it/s]
 41%|████▏     | 2398/5794 [00:54<01:15, 44.87it/s]
 41%|████▏     | 2403/5794 [00:54<01:15, 44.89it/s]
 42%|████▏     | 2408/5794 [00:55<01:15, 44.77it/s]
 42%|████▏     | 2413/5794 [00:55<01:15, 44.88it/s]
 42%|████▏     | 2418/5794 [00:55<01:15, 44.93it/s]
 42%|████▏     | 2423/5794 [00:55<01:14, 45.00it/s]
 42%|████▏     | 2428/5794 [00:55<01:14, 44.91it/s]
 42%|████▏     | 2433/5794 [00:55<01:14, 44.90it/s]
 42%|████▏     | 2438/5794 [00:55<01:14, 45.01it/s]
 42%|████▏     | 2443/5794 [00:55<01:14, 44.97it/s]
 42%|████▏     | 2448/5794 [00:55<01:14, 44.67it/s]
 42%|████▏     | 2453/5794 [00:56<01:15, 44.11it/s]
 42%|████▏     | 2458/5794 [00:56<01:15, 44.11it/s]
 43%|████▎     | 2463/5794 [00:56<01:15, 44.29it/s]
 43%|████▎     | 2468/5794 [00:56<01:15, 44.29it/s]
 43%|████▎     | 2473/5794 [00:56<01:15, 44.14it/s]
 43%|████▎     | 2478/5794 [00:56<01:15, 43.88it/s]
 43%|████▎     | 2483/5794 [00:56<01:14, 44.32it/s]
 43%|████▎     | 2488/5794 [00:56<01:14, 44.37it/s]
 43%|████▎     | 2493/5794 [00:56<01:14, 44.17it/s]
 43%|████▎     | 2498/5794 [00:57<01:14, 44.24it/s]
 43%|████▎     | 2503/5794 [00:57<01:14, 44.32it/s]
 43%|████▎     | 2508/5794 [00:57<01:14, 44.10it/s]
 43%|████▎     | 2513/5794 [00:57<01:13, 44.37it/s]
 43%|████▎     | 2518/5794 [00:57<01:13, 44.62it/s]
 44%|████▎     | 2523/5794 [00:57<01:13, 44.64it/s]
 44%|████▎     | 2528/5794 [00:57<01:13, 44.60it/s]
 44%|████▎     | 2533/5794 [00:57<01:12, 44.70it/s]
 44%|████▍     | 2538/5794 [00:57<01:12, 44.78it/s]
 44%|████▍     | 2543/5794 [00:58<01:12, 44.56it/s]
 44%|████▍     | 2548/5794 [00:58<01:12, 44.99it/s]
 44%|████▍     | 2553/5794 [00:58<01:12, 44.95it/s]
 44%|████▍     | 2558/5794 [00:58<01:12, 44.81it/s]
 44%|████▍     | 2563/5794 [00:58<01:12, 44.85it/s]
 44%|████▍     | 2568/5794 [00:58<01:12, 44.79it/s]
 44%|████▍     | 2573/5794 [00:58<01:11, 44.79it/s]
 44%|████▍     | 2578/5794 [00:58<01:12, 44.45it/s]
 45%|████▍     | 2583/5794 [00:58<01:11, 44.88it/s]
 45%|████▍     | 2588/5794 [00:59<01:11, 44.66it/s]
 45%|████▍     | 2593/5794 [00:59<01:11, 44.68it/s]
 45%|████▍     | 2598/5794 [00:59<01:10, 45.05it/s]
 45%|████▍     | 2603/5794 [00:59<01:10, 45.06it/s]
 45%|████▌     | 2608/5794 [00:59<01:11, 44.51it/s]
 45%|████▌     | 2613/5794 [00:59<01:11, 44.74it/s]
 45%|████▌     | 2618/5794 [00:59<01:10, 44.87it/s]
 45%|████▌     | 2623/5794 [00:59<01:10, 44.90it/s]
 45%|████▌     | 2628/5794 [00:59<01:10, 44.90it/s]
 45%|████▌     | 2633/5794 [01:00<01:10, 44.84it/s]
 46%|████▌     | 2638/5794 [01:00<01:10, 44.89it/s]
 46%|████▌     | 2643/5794 [01:00<01:10, 44.90it/s]
 46%|████▌     | 2648/5794 [01:00<01:10, 44.59it/s]
 46%|████▌     | 2653/5794 [01:00<01:09, 45.03it/s]
 46%|████▌     | 2658/5794 [01:00<01:09, 44.86it/s]
 46%|████▌     | 2663/5794 [01:00<01:10, 44.73it/s]
 46%|████▌     | 2668/5794 [01:00<01:10, 44.44it/s]
 46%|████▌     | 2673/5794 [01:00<01:12, 42.96it/s]
 46%|████▌     | 2678/5794 [01:01<01:14, 41.82it/s]
 46%|████▋     | 2683/5794 [01:01<01:15, 41.18it/s]
 46%|████▋     | 2688/5794 [01:01<01:16, 40.81it/s]
 46%|████▋     | 2693/5794 [01:01<01:16, 40.39it/s]
 47%|████▋     | 2698/5794 [01:01<01:16, 40.30it/s]
 47%|████▋     | 2703/5794 [01:01<01:16, 40.25it/s]
 47%|████▋     | 2708/5794 [01:01<01:17, 39.91it/s]
 47%|████▋     | 2713/5794 [01:01<01:17, 40.00it/s]
 47%|████▋     | 2718/5794 [01:02<01:17, 39.84it/s]
 47%|████▋     | 2722/5794 [01:02<01:17, 39.85it/s]
 47%|████▋     | 2726/5794 [01:02<01:17, 39.79it/s]
 47%|████▋     | 2730/5794 [01:02<01:17, 39.74it/s]
 47%|████▋     | 2735/5794 [01:02<01:15, 40.54it/s]
 47%|████▋     | 2740/5794 [01:02<01:13, 41.77it/s]
 47%|████▋     | 2745/5794 [01:02<01:11, 42.49it/s]
 47%|████▋     | 2750/5794 [01:02<01:10, 43.12it/s]
 48%|████▊     | 2755/5794 [01:02<01:09, 43.55it/s]
 48%|████▊     | 2760/5794 [01:03<01:09, 43.48it/s]
 48%|████▊     | 2765/5794 [01:03<01:09, 43.78it/s]
 48%|████▊     | 2770/5794 [01:03<01:08, 43.86it/s]
 48%|████▊     | 2775/5794 [01:03<01:08, 44.02it/s]
 48%|████▊     | 2780/5794 [01:03<01:09, 43.47it/s]
 48%|████▊     | 2785/5794 [01:03<01:08, 43.84it/s]
 48%|████▊     | 2790/5794 [01:03<01:08, 44.16it/s]
 48%|████▊     | 2795/5794 [01:03<01:07, 44.24it/s]
 48%|████▊     | 2800/5794 [01:03<01:07, 44.46it/s]
 48%|████▊     | 2805/5794 [01:04<01:07, 44.52it/s]
 48%|████▊     | 2810/5794 [01:04<01:07, 44.48it/s]
 49%|████▊     | 2815/5794 [01:04<01:06, 44.53it/s]
 49%|████▊     | 2820/5794 [01:04<01:06, 44.64it/s]
 49%|████▉     | 2825/5794 [01:04<01:06, 44.48it/s]
 49%|████▉     | 2830/5794 [01:04<01:07, 44.23it/s]
 49%|████▉     | 2835/5794 [01:04<01:06, 44.68it/s]
 49%|████▉     | 2840/5794 [01:04<01:06, 44.50it/s]
 49%|████▉     | 2845/5794 [01:04<01:06, 44.68it/s]
 49%|████▉     | 2850/5794 [01:05<01:05, 44.74it/s]
 49%|████▉     | 2855/5794 [01:05<01:05, 44.87it/s]
 49%|████▉     | 2860/5794 [01:05<01:05, 44.82it/s]
 49%|████▉     | 2865/5794 [01:05<01:05, 44.54it/s]
 50%|████▉     | 2870/5794 [01:05<01:05, 44.83it/s]
 50%|████▉     | 2875/5794 [01:05<01:05, 44.91it/s]
 50%|████▉     | 2880/5794 [01:05<01:05, 44.67it/s]
 50%|████▉     | 2885/5794 [01:05<01:05, 44.72it/s]
 50%|████▉     | 2890/5794 [01:05<01:04, 44.78it/s]
 50%|████▉     | 2895/5794 [01:06<01:05, 44.41it/s]
 50%|█████     | 2900/5794 [01:06<01:05, 44.40it/s]
 50%|█████     | 2905/5794 [01:06<01:04, 44.57it/s]
 50%|█████     | 2910/5794 [01:06<01:03, 45.18it/s]
 50%|█████     | 2915/5794 [01:06<01:04, 44.66it/s]
 50%|█████     | 2920/5794 [01:06<01:04, 44.72it/s]
 50%|█████     | 2925/5794 [01:06<01:04, 44.78it/s]
 51%|█████     | 2930/5794 [01:06<01:04, 44.74it/s]
 51%|█████     | 2935/5794 [01:06<01:03, 44.84it/s]
 51%|█████     | 2940/5794 [01:07<01:03, 44.74it/s]
 51%|█████     | 2945/5794 [01:07<01:03, 44.70it/s]
 51%|█████     | 2950/5794 [01:07<01:03, 44.73it/s]
 51%|█████     | 2955/5794 [01:07<01:03, 44.79it/s]
 51%|█████     | 2960/5794 [01:07<01:03, 44.80it/s]
 51%|█████     | 2965/5794 [01:07<01:03, 44.72it/s]
 51%|█████▏    | 2970/5794 [01:07<01:03, 44.69it/s]
 51%|█████▏    | 2975/5794 [01:07<01:03, 44.68it/s]
 51%|█████▏    | 2980/5794 [01:08<01:02, 44.67it/s]
 52%|█████▏    | 2985/5794 [01:08<01:02, 44.72it/s]
 52%|█████▏    | 2990/5794 [01:08<01:02, 44.76it/s]
 52%|█████▏    | 2995/5794 [01:08<01:03, 44.42it/s]
 52%|█████▏    | 3000/5794 [01:08<01:02, 44.78it/s]
 52%|█████▏    | 3005/5794 [01:08<01:02, 44.64it/s]
 52%|█████▏    | 3010/5794 [01:08<01:01, 44.91it/s]
 52%|█████▏    | 3015/5794 [01:08<01:02, 44.62it/s]
 52%|█████▏    | 3020/5794 [01:08<01:02, 44.54it/s]
 52%|█████▏    | 3025/5794 [01:09<01:02, 44.59it/s]
 52%|█████▏    | 3030/5794 [01:09<01:02, 44.53it/s]
 52%|█████▏    | 3035/5794 [01:09<01:01, 44.66it/s]
 52%|█████▏    | 3040/5794 [01:09<01:01, 44.71it/s]
 53%|█████▎    | 3045/5794 [01:09<01:01, 44.51it/s]
 53%|█████▎    | 3050/5794 [01:09<01:01, 44.59it/s]
 53%|█████▎    | 3055/5794 [01:09<01:01, 44.70it/s]
 53%|█████▎    | 3060/5794 [01:09<01:01, 44.76it/s]
 53%|█████▎    | 3065/5794 [01:09<01:00, 44.76it/s]
 53%|█████▎    | 3070/5794 [01:10<01:00, 44.90it/s]
 53%|█████▎    | 3075/5794 [01:10<01:00, 44.95it/s]
 53%|█████▎    | 3080/5794 [01:10<01:00, 44.84it/s]
 53%|█████▎    | 3085/5794 [01:10<01:00, 44.93it/s]
 53%|█████▎    | 3090/5794 [01:10<01:00, 44.56it/s]
 53%|█████▎    | 3095/5794 [01:10<01:00, 44.72it/s]
 54%|█████▎    | 3100/5794 [01:10<01:00, 44.70it/s]
 54%|█████▎    | 3105/5794 [01:10<00:59, 44.85it/s]
 54%|█████▎    | 3110/5794 [01:10<00:59, 44.89it/s]
 54%|█████▍    | 3115/5794 [01:11<00:59, 44.91it/s]
 54%|█████▍    | 3120/5794 [01:11<00:59, 44.96it/s]
 54%|█████▍    | 3125/5794 [01:11<00:59, 45.01it/s]
 54%|█████▍    | 3130/5794 [01:11<00:59, 44.70it/s]
 54%|█████▍    | 3135/5794 [01:11<00:59, 45.03it/s]
 54%|█████▍    | 3140/5794 [01:11<00:58, 45.11it/s]
 54%|█████▍    | 3145/5794 [01:11<00:58, 45.05it/s]
 54%|█████▍    | 3150/5794 [01:11<00:58, 45.02it/s]
 54%|█████▍    | 3155/5794 [01:11<00:58, 45.02it/s]
 55%|█████▍    | 3160/5794 [01:12<00:58, 45.02it/s]
 55%|█████▍    | 3165/5794 [01:12<00:58, 44.87it/s]
 55%|█████▍    | 3170/5794 [01:12<00:58, 44.77it/s]
 55%|█████▍    | 3175/5794 [01:12<00:58, 45.11it/s]
 55%|█████▍    | 3180/5794 [01:12<00:58, 45.02it/s]
 55%|█████▍    | 3185/5794 [01:12<00:58, 44.97it/s]
 55%|█████▌    | 3190/5794 [01:12<00:57, 44.98it/s]
 55%|█████▌    | 3195/5794 [01:12<00:57, 44.99it/s]
 55%|█████▌    | 3200/5794 [01:12<00:57, 44.95it/s]
 55%|█████▌    | 3205/5794 [01:13<00:57, 45.02it/s]
 55%|█████▌    | 3210/5794 [01:13<00:57, 45.00it/s]
 55%|█████▌    | 3215/5794 [01:13<00:57, 44.82it/s]
 56%|█████▌    | 3220/5794 [01:13<00:57, 44.90it/s]
 56%|█████▌    | 3225/5794 [01:13<00:57, 45.00it/s]
 56%|█████▌    | 3230/5794 [01:13<00:57, 44.95it/s]
 56%|█████▌    | 3235/5794 [01:13<00:56, 44.93it/s]
 56%|█████▌    | 3240/5794 [01:13<00:56, 44.94it/s]
 56%|█████▌    | 3245/5794 [01:13<00:56, 45.03it/s]
 56%|█████▌    | 3250/5794 [01:14<00:56, 44.90it/s]
 56%|█████▌    | 3255/5794 [01:14<00:56, 44.86it/s]
 56%|█████▋    | 3260/5794 [01:14<00:56, 44.81it/s]
 56%|█████▋    | 3265/5794 [01:14<00:56, 44.70it/s]
 56%|█████▋    | 3270/5794 [01:14<00:56, 44.75it/s]
 57%|█████▋    | 3275/5794 [01:14<00:56, 44.70it/s]
 57%|█████▋    | 3280/5794 [01:14<00:56, 44.29it/s]
 57%|█████▋    | 3285/5794 [01:14<00:56, 44.09it/s]
 57%|█████▋    | 3290/5794 [01:14<00:56, 44.64it/s]
 57%|█████▋    | 3295/5794 [01:15<00:55, 44.97it/s]
 57%|█████▋    | 3300/5794 [01:15<00:55, 44.67it/s]
 57%|█████▋    | 3305/5794 [01:15<00:55, 44.64it/s]
 57%|█████▋    | 3310/5794 [01:15<00:56, 44.32it/s]
 57%|█████▋    | 3315/5794 [01:15<00:55, 44.30it/s]
 57%|█████▋    | 3320/5794 [01:15<00:55, 44.45it/s]
 57%|█████▋    | 3325/5794 [01:15<00:55, 44.53it/s]
 57%|█████▋    | 3330/5794 [01:15<00:55, 44.59it/s]
 58%|█████▊    | 3335/5794 [01:15<00:55, 44.47it/s]
 58%|█████▊    | 3340/5794 [01:16<00:55, 44.11it/s]
 58%|█████▊    | 3345/5794 [01:16<00:54, 44.87it/s]
 58%|█████▊    | 3350/5794 [01:16<00:54, 44.67it/s]
 58%|█████▊    | 3355/5794 [01:16<00:54, 44.71it/s]
 58%|█████▊    | 3360/5794 [01:16<00:54, 44.62it/s]
 58%|█████▊    | 3365/5794 [01:16<00:54, 44.46it/s]
 58%|█████▊    | 3370/5794 [01:16<00:54, 44.52it/s]
 58%|█████▊    | 3375/5794 [01:16<00:54, 44.60it/s]
 58%|█████▊    | 3380/5794 [01:16<00:54, 44.37it/s]
 58%|█████▊    | 3385/5794 [01:17<00:53, 44.72it/s]
 59%|█████▊    | 3390/5794 [01:17<00:54, 44.46it/s]
 59%|█████▊    | 3395/5794 [01:17<00:53, 44.69it/s]
 59%|█████▊    | 3400/5794 [01:17<00:53, 44.93it/s]
 59%|█████▉    | 3405/5794 [01:17<00:53, 44.96it/s]
 59%|█████▉    | 3410/5794 [01:17<00:53, 44.97it/s]
 59%|█████▉    | 3415/5794 [01:17<00:52, 45.00it/s]
 59%|█████▉    | 3420/5794 [01:17<00:52, 44.94it/s]
 59%|█████▉    | 3425/5794 [01:17<00:52, 44.98it/s]
 59%|█████▉    | 3430/5794 [01:18<00:52, 44.96it/s]
 59%|█████▉    | 3435/5794 [01:18<00:52, 44.77it/s]
 59%|█████▉    | 3440/5794 [01:18<00:52, 44.85it/s]
 59%|█████▉    | 3445/5794 [01:18<00:52, 44.86it/s]
 60%|█████▉    | 3450/5794 [01:18<00:52, 44.76it/s]
 60%|█████▉    | 3455/5794 [01:18<00:52, 44.77it/s]
 60%|█████▉    | 3460/5794 [01:18<00:52, 44.84it/s]
 60%|█████▉    | 3465/5794 [01:18<00:51, 44.83it/s]
 60%|█████▉    | 3470/5794 [01:18<00:51, 44.80it/s]
 60%|█████▉    | 3475/5794 [01:19<00:52, 44.57it/s]
 60%|██████    | 3480/5794 [01:19<00:51, 44.98it/s]
 60%|██████    | 3485/5794 [01:19<00:51, 44.86it/s]
 60%|██████    | 3490/5794 [01:19<00:51, 44.77it/s]
 60%|██████    | 3495/5794 [01:19<00:51, 44.85it/s]
 60%|██████    | 3500/5794 [01:19<00:51, 44.31it/s]
 60%|██████    | 3505/5794 [01:19<00:50, 44.91it/s]
 61%|██████    | 3510/5794 [01:19<00:51, 44.64it/s]
 61%|██████    | 3515/5794 [01:19<00:50, 45.02it/s]
 61%|██████    | 3520/5794 [01:20<00:50, 44.89it/s]
 61%|██████    | 3525/5794 [01:20<00:50, 45.04it/s]
 61%|██████    | 3530/5794 [01:20<00:50, 44.77it/s]
 61%|██████    | 3535/5794 [01:20<00:50, 44.92it/s]
 61%|██████    | 3540/5794 [01:20<00:50, 44.99it/s]
 61%|██████    | 3545/5794 [01:20<00:50, 44.97it/s]
 61%|██████▏   | 3550/5794 [01:20<00:49, 44.96it/s]
 61%|██████▏   | 3555/5794 [01:20<00:49, 44.85it/s]
 61%|██████▏   | 3560/5794 [01:20<00:50, 44.57it/s]
 62%|██████▏   | 3565/5794 [01:21<00:49, 44.76it/s]
 62%|██████▏   | 3570/5794 [01:21<00:49, 44.74it/s]
 62%|██████▏   | 3575/5794 [01:21<00:49, 44.84it/s]
 62%|██████▏   | 3580/5794 [01:21<00:49, 44.71it/s]
 62%|██████▏   | 3585/5794 [01:21<00:49, 44.52it/s]
 62%|██████▏   | 3590/5794 [01:21<00:49, 44.59it/s]
 62%|██████▏   | 3595/5794 [01:21<00:49, 44.59it/s]
 62%|██████▏   | 3600/5794 [01:21<00:49, 44.58it/s]
 62%|██████▏   | 3605/5794 [01:21<00:49, 44.46it/s]
 62%|██████▏   | 3610/5794 [01:22<00:49, 44.44it/s]
 62%|██████▏   | 3615/5794 [01:22<00:48, 44.50it/s]
 62%|██████▏   | 3620/5794 [01:22<00:49, 44.34it/s]
 63%|██████▎   | 3625/5794 [01:22<00:48, 44.42it/s]
 63%|██████▎   | 3630/5794 [01:22<00:48, 44.25it/s]
 63%|██████▎   | 3635/5794 [01:22<00:48, 44.70it/s]
 63%|██████▎   | 3640/5794 [01:22<00:48, 44.55it/s]
 63%|██████▎   | 3645/5794 [01:22<00:48, 44.68it/s]
 63%|██████▎   | 3650/5794 [01:22<00:48, 44.60it/s]
 63%|██████▎   | 3655/5794 [01:23<00:48, 44.49it/s]
 63%|██████▎   | 3660/5794 [01:23<00:48, 44.43it/s]
 63%|██████▎   | 3665/5794 [01:23<00:47, 44.43it/s]
 63%|██████▎   | 3670/5794 [01:23<00:47, 44.33it/s]
 63%|██████▎   | 3675/5794 [01:23<00:47, 44.44it/s]
 64%|██████▎   | 3680/5794 [01:23<00:47, 44.32it/s]
 64%|██████▎   | 3685/5794 [01:23<00:47, 44.40it/s]
 64%|██████▎   | 3690/5794 [01:23<00:47, 44.39it/s]
 64%|██████▍   | 3695/5794 [01:23<00:47, 44.02it/s]
 64%|██████▍   | 3700/5794 [01:24<00:47, 44.19it/s]
 64%|██████▍   | 3705/5794 [01:24<00:47, 43.72it/s]
 64%|██████▍   | 3710/5794 [01:24<00:47, 44.02it/s]
 64%|██████▍   | 3715/5794 [01:24<00:47, 44.19it/s]
 64%|██████▍   | 3720/5794 [01:24<00:46, 44.33it/s]
 64%|██████▍   | 3725/5794 [01:24<00:46, 44.40it/s]
 64%|██████▍   | 3730/5794 [01:24<00:46, 44.42it/s]
 64%|██████▍   | 3735/5794 [01:24<00:46, 43.87it/s]
 65%|██████▍   | 3740/5794 [01:25<00:46, 44.03it/s]
 65%|██████▍   | 3745/5794 [01:25<00:46, 44.36it/s]
 65%|██████▍   | 3750/5794 [01:25<00:45, 44.54it/s]
 65%|██████▍   | 3755/5794 [01:25<00:45, 44.57it/s]
 65%|██████▍   | 3760/5794 [01:25<00:45, 44.69it/s]
 65%|██████▍   | 3765/5794 [01:25<00:45, 44.82it/s]
 65%|██████▌   | 3770/5794 [01:25<00:45, 44.85it/s]
 65%|██████▌   | 3775/5794 [01:25<00:45, 44.85it/s]
 65%|██████▌   | 3780/5794 [01:25<00:44, 44.84it/s]
 65%|██████▌   | 3785/5794 [01:26<00:44, 44.96it/s]
 65%|██████▌   | 3790/5794 [01:26<00:44, 44.59it/s]
 65%|██████▌   | 3795/5794 [01:26<00:44, 44.78it/s]
 66%|██████▌   | 3800/5794 [01:26<00:44, 45.16it/s]
 66%|██████▌   | 3805/5794 [01:26<00:44, 45.00it/s]
 66%|██████▌   | 3810/5794 [01:26<00:44, 44.78it/s]
 66%|██████▌   | 3815/5794 [01:26<00:44, 44.37it/s]
 66%|██████▌   | 3820/5794 [01:26<00:45, 43.21it/s]
 66%|██████▌   | 3825/5794 [01:26<00:45, 43.39it/s]
 66%|██████▌   | 3830/5794 [01:27<00:44, 43.73it/s]
 66%|██████▌   | 3835/5794 [01:27<00:45, 43.28it/s]
 66%|██████▋   | 3840/5794 [01:27<00:44, 44.17it/s]
 66%|██████▋   | 3845/5794 [01:27<00:44, 44.27it/s]
 66%|██████▋   | 3850/5794 [01:27<00:43, 44.26it/s]
 67%|██████▋   | 3855/5794 [01:27<00:44, 44.02it/s]
 67%|██████▋   | 3860/5794 [01:27<00:43, 44.30it/s]
 67%|██████▋   | 3865/5794 [01:27<00:43, 44.39it/s]
 67%|██████▋   | 3870/5794 [01:27<00:43, 44.22it/s]
 67%|██████▋   | 3875/5794 [01:28<00:43, 44.03it/s]
 67%|██████▋   | 3880/5794 [01:28<00:43, 44.13it/s]
 67%|██████▋   | 3885/5794 [01:28<00:43, 44.28it/s]
 67%|██████▋   | 3890/5794 [01:28<00:43, 43.97it/s]
 67%|██████▋   | 3895/5794 [01:28<00:42, 44.29it/s]
 67%|██████▋   | 3900/5794 [01:28<00:42, 44.62it/s]
 67%|██████▋   | 3905/5794 [01:28<00:42, 44.81it/s]
 67%|██████▋   | 3910/5794 [01:28<00:41, 44.88it/s]
 68%|██████▊   | 3915/5794 [01:28<00:41, 45.06it/s]
 68%|██████▊   | 3920/5794 [01:29<00:41, 45.19it/s]
 68%|██████▊   | 3925/5794 [01:29<00:41, 44.82it/s]
 68%|██████▊   | 3930/5794 [01:29<00:41, 45.00it/s]
 68%|██████▊   | 3935/5794 [01:29<00:41, 45.17it/s]
 68%|██████▊   | 3940/5794 [01:29<00:41, 45.10it/s]
 68%|██████▊   | 3945/5794 [01:29<00:41, 45.04it/s]
 68%|██████▊   | 3950/5794 [01:29<00:40, 45.20it/s]
 68%|██████▊   | 3955/5794 [01:29<00:40, 45.32it/s]
 68%|██████▊   | 3960/5794 [01:29<00:40, 45.21it/s]
 68%|██████▊   | 3965/5794 [01:30<00:40, 45.34it/s]
 69%|██████▊   | 3970/5794 [01:30<00:40, 45.35it/s]
 69%|██████▊   | 3975/5794 [01:30<00:40, 45.39it/s]
 69%|██████▊   | 3980/5794 [01:30<00:40, 45.32it/s]
 69%|██████▉   | 3985/5794 [01:30<00:39, 45.33it/s]
 69%|██████▉   | 3990/5794 [01:30<00:39, 45.32it/s]
 69%|██████▉   | 3995/5794 [01:30<00:39, 45.24it/s]
 69%|██████▉   | 4000/5794 [01:30<00:39, 45.17it/s]
 69%|██████▉   | 4005/5794 [01:30<00:39, 45.53it/s]
 69%|██████▉   | 4010/5794 [01:31<00:39, 45.29it/s]
 69%|██████▉   | 4015/5794 [01:31<00:39, 44.96it/s]
 69%|██████▉   | 4020/5794 [01:31<00:38, 45.55it/s]
 69%|██████▉   | 4025/5794 [01:31<00:38, 45.47it/s]
 70%|██████▉   | 4030/5794 [01:31<00:39, 45.13it/s]
 70%|██████▉   | 4035/5794 [01:31<00:39, 45.06it/s]
 70%|██████▉   | 4040/5794 [01:31<00:38, 45.03it/s]
 70%|██████▉   | 4045/5794 [01:31<00:38, 45.07it/s]
 70%|██████▉   | 4050/5794 [01:31<00:38, 44.93it/s]
 70%|██████▉   | 4055/5794 [01:32<00:38, 45.30it/s]
 70%|███████   | 4060/5794 [01:32<00:38, 45.34it/s]
 70%|███████   | 4065/5794 [01:32<00:38, 44.98it/s]
 70%|███████   | 4070/5794 [01:32<00:38, 45.08it/s]
 70%|███████   | 4075/5794 [01:32<00:38, 45.22it/s]
 70%|███████   | 4080/5794 [01:32<00:37, 45.16it/s]
 71%|███████   | 4085/5794 [01:32<00:37, 45.25it/s]
 71%|███████   | 4090/5794 [01:32<00:37, 44.91it/s]
 71%|███████   | 4095/5794 [01:32<00:38, 44.54it/s]
 71%|███████   | 4100/5794 [01:33<00:38, 44.45it/s]
 71%|███████   | 4105/5794 [01:33<00:38, 44.34it/s]
 71%|███████   | 4110/5794 [01:33<00:38, 44.27it/s]
 71%|███████   | 4115/5794 [01:33<00:38, 44.14it/s]
 71%|███████   | 4120/5794 [01:33<00:37, 44.18it/s]
 71%|███████   | 4125/5794 [01:33<00:37, 44.20it/s]
 71%|███████▏  | 4130/5794 [01:33<00:37, 44.07it/s]
 71%|███████▏  | 4135/5794 [01:33<00:37, 44.15it/s]
 71%|███████▏  | 4140/5794 [01:33<00:37, 44.19it/s]
 72%|███████▏  | 4145/5794 [01:34<00:37, 44.20it/s]
 72%|███████▏  | 4150/5794 [01:34<00:37, 44.12it/s]
 72%|███████▏  | 4155/5794 [01:34<00:37, 44.14it/s]
 72%|███████▏  | 4160/5794 [01:34<00:37, 43.80it/s]
 72%|███████▏  | 4165/5794 [01:34<00:37, 43.33it/s]
 72%|███████▏  | 4170/5794 [01:34<00:37, 43.42it/s]
 72%|███████▏  | 4175/5794 [01:34<00:36, 43.99it/s]
 72%|███████▏  | 4180/5794 [01:34<00:36, 44.01it/s]
 72%|███████▏  | 4185/5794 [01:34<00:36, 44.17it/s]
 72%|███████▏  | 4190/5794 [01:35<00:36, 43.95it/s]
 72%|███████▏  | 4195/5794 [01:35<00:36, 44.34it/s]
 72%|███████▏  | 4200/5794 [01:35<00:35, 44.45it/s]
 73%|███████▎  | 4205/5794 [01:35<00:35, 44.67it/s]
 73%|███████▎  | 4210/5794 [01:35<00:35, 44.61it/s]
 73%|███████▎  | 4215/5794 [01:35<00:35, 44.90it/s]
 73%|███████▎  | 4220/5794 [01:35<00:35, 44.92it/s]
 73%|███████▎  | 4225/5794 [01:35<00:34, 45.02it/s]
 73%|███████▎  | 4230/5794 [01:35<00:35, 44.50it/s]
 73%|███████▎  | 4235/5794 [01:36<00:34, 45.20it/s]
 73%|███████▎  | 4240/5794 [01:36<00:34, 45.17it/s]
 73%|███████▎  | 4245/5794 [01:36<00:34, 45.16it/s]
 73%|███████▎  | 4250/5794 [01:36<00:34, 44.84it/s]
 73%|███████▎  | 4255/5794 [01:36<00:34, 45.07it/s]
 74%|███████▎  | 4260/5794 [01:36<00:33, 45.14it/s]
 74%|███████▎  | 4265/5794 [01:36<00:34, 44.92it/s]
 74%|███████▎  | 4270/5794 [01:36<00:33, 45.04it/s]
 74%|███████▍  | 4275/5794 [01:36<00:33, 45.03it/s]
 74%|███████▍  | 4280/5794 [01:37<00:33, 44.60it/s]
 74%|███████▍  | 4285/5794 [01:37<00:33, 45.29it/s]
 74%|███████▍  | 4290/5794 [01:37<00:33, 45.27it/s]
 74%|███████▍  | 4295/5794 [01:37<00:33, 45.33it/s]
 74%|███████▍  | 4300/5794 [01:37<00:33, 45.14it/s]
 74%|███████▍  | 4305/5794 [01:37<00:33, 44.97it/s]
 74%|███████▍  | 4310/5794 [01:37<00:33, 44.88it/s]
 74%|███████▍  | 4315/5794 [01:37<00:32, 44.84it/s]
 75%|███████▍  | 4320/5794 [01:37<00:32, 44.81it/s]
 75%|███████▍  | 4325/5794 [01:38<00:33, 44.38it/s]
 75%|███████▍  | 4330/5794 [01:38<00:32, 44.40it/s]
 75%|███████▍  | 4335/5794 [01:38<00:32, 44.62it/s]
 75%|███████▍  | 4340/5794 [01:38<00:32, 44.62it/s]
 75%|███████▍  | 4345/5794 [01:38<00:32, 44.88it/s]
 75%|███████▌  | 4350/5794 [01:38<00:44, 32.73it/s]
 75%|███████▌  | 4354/5794 [01:38<00:42, 34.21it/s]
 75%|███████▌  | 4359/5794 [01:39<00:39, 35.99it/s]
 75%|███████▌  | 4363/5794 [01:39<00:38, 36.73it/s]
 75%|███████▌  | 4367/5794 [01:39<00:38, 37.35it/s]
 75%|███████▌  | 4371/5794 [01:39<00:37, 37.90it/s]
 76%|███████▌  | 4376/5794 [01:39<00:36, 38.79it/s]
 76%|███████▌  | 4380/5794 [01:39<00:36, 38.95it/s]
 76%|███████▌  | 4384/5794 [01:39<00:36, 38.81it/s]
 76%|███████▌  | 4389/5794 [01:39<00:35, 39.69it/s]
 76%|███████▌  | 4394/5794 [01:39<00:35, 39.83it/s]
 76%|███████▌  | 4398/5794 [01:40<00:35, 39.83it/s]
 76%|███████▌  | 4402/5794 [01:40<00:35, 39.76it/s]
 76%|███████▌  | 4407/5794 [01:40<00:34, 39.95it/s]
 76%|███████▌  | 4411/5794 [01:40<00:35, 39.45it/s]
 76%|███████▌  | 4415/5794 [01:40<00:34, 39.44it/s]
 76%|███████▋  | 4420/5794 [01:40<00:34, 39.75it/s]
 76%|███████▋  | 4424/5794 [01:40<00:34, 39.65it/s]
 76%|███████▋  | 4429/5794 [01:40<00:34, 39.78it/s]
 77%|███████▋  | 4433/5794 [01:40<00:34, 39.73it/s]
 77%|███████▋  | 4438/5794 [01:41<00:34, 39.72it/s]
 77%|███████▋  | 4443/5794 [01:41<00:33, 40.16it/s]
 77%|███████▋  | 4448/5794 [01:41<00:33, 39.71it/s]
 77%|███████▋  | 4453/5794 [01:41<00:33, 39.92it/s]
 77%|███████▋  | 4458/5794 [01:41<00:33, 40.33it/s]
 77%|███████▋  | 4463/5794 [01:41<00:33, 40.32it/s]
 77%|███████▋  | 4468/5794 [01:41<00:33, 40.16it/s]
 77%|███████▋  | 4473/5794 [01:41<00:32, 40.19it/s]
 77%|███████▋  | 4478/5794 [01:42<00:32, 40.22it/s]
 77%|███████▋  | 4483/5794 [01:42<00:32, 40.09it/s]
 77%|███████▋  | 4488/5794 [01:42<00:32, 40.15it/s]
 78%|███████▊  | 4493/5794 [01:42<00:32, 40.18it/s]
 78%|███████▊  | 4498/5794 [01:42<00:32, 40.15it/s]
 78%|███████▊  | 4503/5794 [01:42<00:32, 40.10it/s]
 78%|███████▊  | 4508/5794 [01:42<00:32, 40.09it/s]
 78%|███████▊  | 4513/5794 [01:42<00:31, 40.13it/s]
 78%|███████▊  | 4518/5794 [01:43<00:31, 40.26it/s]
 78%|███████▊  | 4523/5794 [01:43<00:30, 41.45it/s]
 78%|███████▊  | 4528/5794 [01:43<00:30, 42.07it/s]
 78%|███████▊  | 4533/5794 [01:43<00:29, 42.63it/s]
 78%|███████▊  | 4538/5794 [01:43<00:29, 43.06it/s]
 78%|███████▊  | 4543/5794 [01:43<00:28, 43.78it/s]
 78%|███████▊  | 4548/5794 [01:43<00:28, 44.09it/s]
 79%|███████▊  | 4553/5794 [01:43<00:28, 44.07it/s]
 79%|███████▊  | 4558/5794 [01:43<00:27, 44.30it/s]
 79%|███████▉  | 4563/5794 [01:44<00:27, 44.03it/s]
 79%|███████▉  | 4568/5794 [01:44<00:27, 44.09it/s]
 79%|███████▉  | 4573/5794 [01:44<00:27, 43.98it/s]
 79%|███████▉  | 4578/5794 [01:44<00:27, 44.43it/s]
 79%|███████▉  | 4583/5794 [01:44<00:27, 44.40it/s]
 79%|███████▉  | 4588/5794 [01:44<00:27, 44.28it/s]
 79%|███████▉  | 4593/5794 [01:44<00:27, 44.25it/s]
 79%|███████▉  | 4598/5794 [01:44<00:26, 44.44it/s]
 79%|███████▉  | 4603/5794 [01:44<00:26, 44.72it/s]
 80%|███████▉  | 4608/5794 [01:45<00:26, 44.76it/s]
 80%|███████▉  | 4613/5794 [01:45<00:26, 44.59it/s]
 80%|███████▉  | 4618/5794 [01:45<00:26, 44.86it/s]
 80%|███████▉  | 4623/5794 [01:45<00:26, 44.98it/s]
 80%|███████▉  | 4628/5794 [01:45<00:26, 44.77it/s]
 80%|███████▉  | 4633/5794 [01:45<00:25, 45.10it/s]
 80%|████████  | 4638/5794 [01:45<00:25, 45.02it/s]
 80%|████████  | 4643/5794 [01:45<00:25, 44.93it/s]
 80%|████████  | 4648/5794 [01:45<00:25, 44.99it/s]
 80%|████████  | 4653/5794 [01:46<00:25, 45.00it/s]
 80%|████████  | 4658/5794 [01:46<00:25, 44.40it/s]
 80%|████████  | 4663/5794 [01:46<00:25, 44.10it/s]
 81%|████████  | 4668/5794 [01:46<00:24, 45.18it/s]
 81%|████████  | 4673/5794 [01:46<00:24, 45.77it/s]
 81%|████████  | 4678/5794 [01:46<00:24, 45.53it/s]
 81%|████████  | 4683/5794 [01:46<00:24, 45.19it/s]
 81%|████████  | 4688/5794 [01:46<00:24, 45.22it/s]
 81%|████████  | 4693/5794 [01:46<00:24, 45.16it/s]
 81%|████████  | 4698/5794 [01:47<00:24, 45.08it/s]
 81%|████████  | 4703/5794 [01:47<00:24, 45.11it/s]
 81%|████████▏ | 4708/5794 [01:47<00:24, 45.12it/s]
 81%|████████▏ | 4713/5794 [01:47<00:23, 45.12it/s]
 81%|████████▏ | 4718/5794 [01:47<00:23, 45.03it/s]
 82%|████████▏ | 4723/5794 [01:47<00:23, 45.06it/s]
 82%|████████▏ | 4728/5794 [01:47<00:23, 45.10it/s]
 82%|████████▏ | 4733/5794 [01:47<00:23, 44.99it/s]
 82%|████████▏ | 4738/5794 [01:47<00:23, 45.04it/s]
 82%|████████▏ | 4743/5794 [01:48<00:23, 45.12it/s]
 82%|████████▏ | 4748/5794 [01:48<00:23, 45.01it/s]
 82%|████████▏ | 4753/5794 [01:48<00:23, 45.01it/s]
 82%|████████▏ | 4758/5794 [01:48<00:22, 45.08it/s]
 82%|████████▏ | 4763/5794 [01:48<00:22, 45.00it/s]
 82%|████████▏ | 4768/5794 [01:48<00:22, 44.85it/s]
 82%|████████▏ | 4773/5794 [01:48<00:22, 44.98it/s]
 82%|████████▏ | 4778/5794 [01:48<00:22, 45.02it/s]
 83%|████████▎ | 4783/5794 [01:48<00:22, 44.99it/s]
 83%|████████▎ | 4788/5794 [01:49<00:22, 44.95it/s]
 83%|████████▎ | 4793/5794 [01:49<00:22, 44.83it/s]
 83%|████████▎ | 4798/5794 [01:49<00:22, 44.76it/s]
 83%|████████▎ | 4803/5794 [01:49<00:22, 44.75it/s]
 83%|████████▎ | 4808/5794 [01:49<00:21, 44.84it/s]
 83%|████████▎ | 4813/5794 [01:49<00:21, 44.85it/s]
 83%|████████▎ | 4818/5794 [01:49<00:21, 44.79it/s]
 83%|████████▎ | 4823/5794 [01:49<00:21, 44.36it/s]
 83%|████████▎ | 4828/5794 [01:49<00:21, 45.07it/s]
 83%|████████▎ | 4833/5794 [01:50<00:21, 44.88it/s]
 84%|████████▎ | 4838/5794 [01:50<00:21, 44.86it/s]
 84%|████████▎ | 4843/5794 [01:50<00:21, 44.92it/s]
 84%|████████▎ | 4848/5794 [01:50<00:21, 44.52it/s]
 84%|████████▍ | 4853/5794 [01:50<00:20, 45.03it/s]
 84%|████████▍ | 4858/5794 [01:50<00:20, 44.79it/s]
 84%|████████▍ | 4863/5794 [01:50<00:20, 45.17it/s]
 84%|████████▍ | 4868/5794 [01:50<00:20, 44.49it/s]
 84%|████████▍ | 4873/5794 [01:50<00:20, 44.63it/s]
 84%|████████▍ | 4878/5794 [01:51<00:21, 43.56it/s]
 84%|████████▍ | 4883/5794 [01:51<00:20, 44.43it/s]
 84%|████████▍ | 4888/5794 [01:51<00:20, 44.55it/s]
 84%|████████▍ | 4893/5794 [01:51<00:20, 44.74it/s]
 85%|████████▍ | 4898/5794 [01:51<00:20, 44.53it/s]
 85%|████████▍ | 4903/5794 [01:51<00:19, 44.92it/s]
 85%|████████▍ | 4908/5794 [01:51<00:19, 44.94it/s]
 85%|████████▍ | 4913/5794 [01:51<00:19, 44.95it/s]
 85%|████████▍ | 4918/5794 [01:51<00:19, 44.86it/s]
 85%|████████▍ | 4923/5794 [01:52<00:19, 44.98it/s]
 85%|████████▌ | 4928/5794 [01:52<00:19, 44.87it/s]
 85%|████████▌ | 4933/5794 [01:52<00:19, 45.08it/s]
 85%|████████▌ | 4938/5794 [01:52<00:18, 45.05it/s]
 85%|████████▌ | 4943/5794 [01:52<00:18, 44.83it/s]
 85%|████████▌ | 4948/5794 [01:52<00:18, 44.63it/s]
 85%|████████▌ | 4953/5794 [01:52<00:18, 45.03it/s]
 86%|████████▌ | 4958/5794 [01:52<00:18, 45.01it/s]
 86%|████████▌ | 4963/5794 [01:52<00:18, 44.96it/s]
 86%|████████▌ | 4968/5794 [01:53<00:18, 44.83it/s]
 86%|████████▌ | 4973/5794 [01:53<00:18, 44.92it/s]
 86%|████████▌ | 4978/5794 [01:53<00:18, 44.63it/s]
 86%|████████▌ | 4983/5794 [01:53<00:18, 44.41it/s]
 86%|████████▌ | 4988/5794 [01:53<00:18, 44.65it/s]
 86%|████████▌ | 4993/5794 [01:53<00:17, 44.73it/s]
 86%|████████▋ | 4998/5794 [01:53<00:17, 44.68it/s]
 86%|████████▋ | 5003/5794 [01:53<00:17, 44.76it/s]
 86%|████████▋ | 5008/5794 [01:53<00:17, 44.82it/s]
 87%|████████▋ | 5013/5794 [01:54<00:17, 44.64it/s]
 87%|████████▋ | 5018/5794 [01:54<00:17, 44.70it/s]
 87%|████████▋ | 5023/5794 [01:54<00:17, 44.72it/s]
 87%|████████▋ | 5028/5794 [01:54<00:17, 44.56it/s]
 87%|████████▋ | 5033/5794 [01:54<00:17, 44.49it/s]
 87%|████████▋ | 5038/5794 [01:54<00:16, 44.61it/s]
 87%|████████▋ | 5043/5794 [01:54<00:16, 44.71it/s]
 87%|████████▋ | 5048/5794 [01:54<00:16, 44.62it/s]
 87%|████████▋ | 5053/5794 [01:54<00:16, 44.62it/s]
 87%|████████▋ | 5058/5794 [01:55<00:16, 44.79it/s]
 87%|████████▋ | 5063/5794 [01:55<00:16, 44.84it/s]
 87%|████████▋ | 5068/5794 [01:55<00:16, 45.03it/s]
 88%|████████▊ | 5073/5794 [01:55<00:16, 44.98it/s]
 88%|████████▊ | 5078/5794 [01:55<00:15, 44.92it/s]
 88%|████████▊ | 5083/5794 [01:55<00:15, 44.87it/s]
 88%|████████▊ | 5088/5794 [01:55<00:15, 45.11it/s]
 88%|████████▊ | 5093/5794 [01:55<00:15, 44.89it/s]
 88%|████████▊ | 5098/5794 [01:55<00:15, 45.18it/s]
 88%|████████▊ | 5103/5794 [01:56<00:15, 45.29it/s]
 88%|████████▊ | 5108/5794 [01:56<00:15, 45.29it/s]
 88%|████████▊ | 5113/5794 [01:56<00:15, 45.22it/s]
 88%|████████▊ | 5118/5794 [01:56<00:14, 45.24it/s]
 88%|████████▊ | 5123/5794 [01:56<00:14, 45.30it/s]
 89%|████████▊ | 5128/5794 [01:56<00:14, 45.32it/s]
 89%|████████▊ | 5133/5794 [01:56<00:14, 45.21it/s]
 89%|████████▊ | 5138/5794 [01:56<00:14, 45.24it/s]
 89%|████████▉ | 5143/5794 [01:56<00:14, 45.29it/s]
 89%|████████▉ | 5148/5794 [01:57<00:14, 45.30it/s]
 89%|████████▉ | 5153/5794 [01:57<00:14, 45.23it/s]
 89%|████████▉ | 5158/5794 [01:57<00:14, 45.16it/s]
 89%|████████▉ | 5163/5794 [01:57<00:13, 45.24it/s]
 89%|████████▉ | 5168/5794 [01:57<00:13, 44.97it/s]
 89%|████████▉ | 5173/5794 [01:57<00:13, 45.21it/s]
 89%|████████▉ | 5178/5794 [01:57<00:13, 45.28it/s]
 89%|████████▉ | 5183/5794 [01:57<00:13, 45.23it/s]
 90%|████████▉ | 5188/5794 [01:57<00:13, 45.18it/s]
 90%|████████▉ | 5193/5794 [01:58<00:13, 45.25it/s]
 90%|████████▉ | 5198/5794 [01:58<00:13, 45.25it/s]
 90%|████████▉ | 5203/5794 [01:58<00:13, 45.14it/s]
 90%|████████▉ | 5208/5794 [01:58<00:12, 45.21it/s]
 90%|████████▉ | 5213/5794 [01:58<00:12, 45.24it/s]
 90%|█████████ | 5218/5794 [01:58<00:12, 45.11it/s]
 90%|█████████ | 5223/5794 [01:58<00:12, 45.17it/s]
 90%|█████████ | 5228/5794 [01:58<00:12, 45.09it/s]
 90%|█████████ | 5233/5794 [01:58<00:12, 44.59it/s]
 90%|█████████ | 5238/5794 [01:59<00:12, 44.48it/s]
 90%|█████████ | 5243/5794 [01:59<00:12, 44.48it/s]
 91%|█████████ | 5248/5794 [01:59<00:12, 44.47it/s]
 91%|█████████ | 5253/5794 [01:59<00:12, 44.34it/s]
 91%|█████████ | 5258/5794 [01:59<00:12, 44.42it/s]
 91%|█████████ | 5263/5794 [01:59<00:11, 44.40it/s]
 91%|█████████ | 5268/5794 [01:59<00:11, 44.27it/s]
 91%|█████████ | 5273/5794 [01:59<00:11, 44.25it/s]
 91%|█████████ | 5278/5794 [01:59<00:11, 44.41it/s]
 91%|█████████ | 5283/5794 [02:00<00:11, 44.54it/s]
 91%|█████████▏| 5288/5794 [02:00<00:11, 44.38it/s]
 91%|█████████▏| 5293/5794 [02:00<00:11, 44.52it/s]
 91%|█████████▏| 5298/5794 [02:00<00:11, 44.85it/s]
 92%|█████████▏| 5303/5794 [02:00<00:10, 44.94it/s]
 92%|█████████▏| 5308/5794 [02:00<00:10, 45.16it/s]
 92%|█████████▏| 5313/5794 [02:00<00:10, 45.22it/s]
 92%|█████████▏| 5318/5794 [02:00<00:10, 45.27it/s]
 92%|█████████▏| 5323/5794 [02:00<00:10, 45.45it/s]
 92%|█████████▏| 5328/5794 [02:01<00:10, 43.52it/s]
 92%|█████████▏| 5333/5794 [02:01<00:10, 44.39it/s]
 92%|█████████▏| 5338/5794 [02:01<00:10, 44.29it/s]
 92%|█████████▏| 5343/5794 [02:01<00:10, 44.44it/s]
 92%|█████████▏| 5348/5794 [02:01<00:09, 44.82it/s]
 92%|█████████▏| 5353/5794 [02:01<00:09, 44.88it/s]
 92%|█████████▏| 5358/5794 [02:01<00:09, 45.08it/s]
 93%|█████████▎| 5363/5794 [02:01<00:09, 45.15it/s]
 93%|█████████▎| 5368/5794 [02:01<00:09, 45.19it/s]
 93%|█████████▎| 5373/5794 [02:02<00:09, 45.26it/s]
 93%|█████████▎| 5378/5794 [02:02<00:09, 45.20it/s]
 93%|█████████▎| 5383/5794 [02:02<00:09, 45.32it/s]
 93%|█████████▎| 5388/5794 [02:02<00:09, 45.11it/s]
 93%|█████████▎| 5393/5794 [02:02<00:08, 44.92it/s]
 93%|█████████▎| 5398/5794 [02:02<00:08, 45.26it/s]
 93%|█████████▎| 5403/5794 [02:02<00:08, 45.16it/s]
 93%|█████████▎| 5408/5794 [02:02<00:08, 45.07it/s]
 93%|█████████▎| 5413/5794 [02:04<00:32, 11.68it/s]
 94%|█████████▎| 5418/5794 [02:04<00:25, 14.82it/s]
 94%|█████████▎| 5423/5794 [02:04<00:20, 18.29it/s]
 94%|█████████▎| 5427/5794 [02:04<00:17, 21.18it/s]
 94%|█████████▎| 5431/5794 [02:04<00:14, 24.21it/s]
 94%|█████████▍| 5435/5794 [02:04<00:13, 27.02it/s]
 94%|█████████▍| 5439/5794 [02:04<00:11, 29.67it/s]
 94%|█████████▍| 5443/5794 [02:04<00:10, 31.94it/s]
 94%|█████████▍| 5447/5794 [02:04<00:10, 33.79it/s]
 94%|█████████▍| 5451/5794 [02:04<00:09, 35.26it/s]
 94%|█████████▍| 5455/5794 [02:05<00:09, 36.30it/s]
 94%|█████████▍| 5459/5794 [02:05<00:09, 37.10it/s]
 94%|█████████▍| 5463/5794 [02:05<00:08, 37.67it/s]
 94%|█████████▍| 5467/5794 [02:05<00:08, 37.90it/s]
 94%|█████████▍| 5471/5794 [02:05<00:08, 38.00it/s]
 95%|█████████▍| 5476/5794 [02:05<00:08, 38.71it/s]
 95%|█████████▍| 5481/5794 [02:05<00:07, 40.22it/s]
 95%|█████████▍| 5486/5794 [02:05<00:07, 41.60it/s]
 95%|█████████▍| 5491/5794 [02:05<00:07, 42.77it/s]
 95%|█████████▍| 5496/5794 [02:06<00:06, 43.52it/s]
 95%|█████████▍| 5501/5794 [02:06<00:06, 43.92it/s]
 95%|█████████▌| 5506/5794 [02:06<00:06, 44.44it/s]
 95%|█████████▌| 5511/5794 [02:06<00:06, 44.55it/s]
 95%|█████████▌| 5516/5794 [02:06<00:06, 44.95it/s]
 95%|█████████▌| 5521/5794 [02:06<00:06, 44.90it/s]
 95%|█████████▌| 5526/5794 [02:06<00:05, 44.92it/s]
 95%|█████████▌| 5531/5794 [02:06<00:05, 45.08it/s]
 96%|█████████▌| 5536/5794 [02:06<00:05, 44.96it/s]
 96%|█████████▌| 5541/5794 [02:07<00:05, 44.36it/s]
 96%|█████████▌| 5546/5794 [02:07<00:05, 45.49it/s]
 96%|█████████▌| 5551/5794 [02:07<00:05, 45.47it/s]
 96%|█████████▌| 5556/5794 [02:07<00:05, 45.36it/s]
 96%|█████████▌| 5561/5794 [02:07<00:05, 45.30it/s]
 96%|█████████▌| 5566/5794 [02:07<00:05, 45.33it/s]
 96%|█████████▌| 5571/5794 [02:07<00:04, 44.97it/s]
 96%|█████████▌| 5576/5794 [02:07<00:04, 45.37it/s]
 96%|█████████▋| 5581/5794 [02:07<00:04, 45.34it/s]
 96%|█████████▋| 5586/5794 [02:08<00:04, 45.28it/s]
 96%|█████████▋| 5591/5794 [02:08<00:04, 45.21it/s]
 97%|█████████▋| 5596/5794 [02:08<00:04, 44.78it/s]
 97%|█████████▋| 5601/5794 [02:08<00:04, 45.09it/s]
 97%|█████████▋| 5606/5794 [02:08<00:04, 45.12it/s]
 97%|█████████▋| 5611/5794 [02:08<00:04, 45.01it/s]
 97%|█████████▋| 5616/5794 [02:08<00:03, 45.16it/s]
 97%|█████████▋| 5621/5794 [02:08<00:03, 45.09it/s]
 97%|█████████▋| 5626/5794 [02:08<00:03, 44.32it/s]
 97%|█████████▋| 5631/5794 [02:09<00:03, 44.56it/s]
 97%|█████████▋| 5636/5794 [02:09<00:03, 44.79it/s]
 97%|█████████▋| 5641/5794 [02:09<00:03, 44.60it/s]
 97%|█████████▋| 5646/5794 [02:09<00:03, 44.85it/s]
 98%|█████████▊| 5651/5794 [02:09<00:03, 45.00it/s]
 98%|█████████▊| 5656/5794 [02:09<00:03, 45.01it/s]
 98%|█████████▊| 5661/5794 [02:09<00:02, 44.95it/s]
 98%|█████████▊| 5666/5794 [02:09<00:02, 45.10it/s]
 98%|█████████▊| 5671/5794 [02:09<00:02, 45.37it/s]
 98%|█████████▊| 5676/5794 [02:10<00:02, 45.23it/s]
 98%|█████████▊| 5681/5794 [02:10<00:02, 45.13it/s]
 98%|█████████▊| 5686/5794 [02:10<00:02, 45.14it/s]
 98%|█████████▊| 5691/5794 [02:10<00:02, 45.09it/s]
 98%|█████████▊| 5696/5794 [02:10<00:02, 45.16it/s]
 98%|█████████▊| 5701/5794 [02:10<00:02, 45.24it/s]
 98%|█████████▊| 5706/5794 [02:10<00:01, 45.08it/s]
 99%|█████████▊| 5711/5794 [02:10<00:01, 45.00it/s]
 99%|█████████▊| 5716/5794 [02:10<00:01, 45.36it/s]
 99%|█████████▊| 5721/5794 [02:11<00:01, 45.16it/s]
 99%|█████████▉| 5726/5794 [02:11<00:01, 44.90it/s]
 99%|█████████▉| 5731/5794 [02:11<00:01, 44.76it/s]
 99%|█████████▉| 5736/5794 [02:11<00:01, 44.69it/s]
 99%|█████████▉| 5741/5794 [02:11<00:01, 44.49it/s]
 99%|█████████▉| 5746/5794 [02:11<00:01, 44.47it/s]
 99%|█████████▉| 5751/5794 [02:11<00:00, 44.19it/s]
 99%|█████████▉| 5756/5794 [02:11<00:00, 43.96it/s]
 99%|█████████▉| 5761/5794 [02:11<00:00, 44.03it/s]
100%|█████████▉| 5766/5794 [02:12<00:00, 44.26it/s]
100%|█████████▉| 5771/5794 [02:12<00:00, 44.15it/s]
100%|█████████▉| 5776/5794 [02:12<00:00, 44.44it/s]
100%|█████████▉| 5781/5794 [02:12<00:00, 43.43it/s]
100%|█████████▉| 5786/5794 [02:12<00:00, 44.35it/s]
100%|█████████▉| 5791/5794 [02:12<00:00, 44.44it/s]
100%|██████████| 5794/5794 [02:12<00:00, 43.63it/s]
BALANCED ACCS CHECKED FOR TEST
TEST SET RESULTS FOR CHECKPOINT trained_weights/waterbirds/abn_att_waterbird_complete95_forest2water2_21049292_trial_036/best_balanced_valacc_0.8_epoch_193.ckpt
test_acc: 0.8391439420089748
balanced_test_acc: 0.8103256176996774
Land_on_Land_test_acc: 0.9946784922394678
Land_on_Water_test_acc: 0.729490022172949
Water_on_Land_test_acc: 0.5950155763239875
Water_on_Water_test_acc: 0.9221183800623053
test_acc_Waterbird: 0.7585669781931464
test_acc_Landbird: 0.8620842572062084
